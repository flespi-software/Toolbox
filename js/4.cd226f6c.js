(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"076c":function(e,t,s){},1635:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",[s("entities-toolbar",{attrs:{item:e.selectedItem}},[s("div",{staticClass:"flex",class:{"middle-modificator":!e.active},attrs:{slot:"selects"},slot:"selects"},[s("div",{staticStyle:{display:"inline-flex"},style:{maxWidth:e.needShowBackToChannel&&e.needShowBackToDevice?"calc(100% - 150px)":e.needShowBackToChannel||e.needShowBackToDevice?"calc(100% - 80px)":"100%"}},[s("q-select",{ref:"itemSelect",staticClass:"items__select",class:{"items__select--no-selected":!e.active},attrs:{value:e.active,options:e.filteredItems,filled:"",loading:e.isItemsInitStart&&!e.isItemsInit,label:e.active?"Channel":"SELECT CHANNEL",dark:"","hide-bottom-space":"",dense:"",color:"white",disable:!e.isNeedSelect||"string"===typeof e.isNeedSelect&&e.isNeedSelect.indexOf("channels")>-1,"hide-dropdown-icon":!e.isNeedSelect||"string"===typeof e.isNeedSelect&&e.isNeedSelect.indexOf("channels")>-1,"popup-content-class":"items__popup","popup-content-style":{height:48*(e.filteredItems.length>6?6:e.filteredItems.length)+48+"px"}},on:{filter:function(t,s){return e.filterItems("channels",t,s)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[s("div",[s("q-input",{staticClass:"q-ma-xs",attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"Filter",autofocus:""},on:{input:function(t){return e.$refs.itemSelect.filter(t)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[s("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1),s("div",{staticClass:"text-center"},[e._v("No results")])],1)]},proxy:!0},{key:"selected-item",fn:function(t){return[e.selectedItem?s("q-item",e._g(e._b({staticClass:"q-pa-none",staticStyle:{"min-height":"20px","margin-top":"2px","max-width":"100%"}},"q-item",t.itemProps,!1),t.itemEvents),[s("q-item-section",[s("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-none text-white",attrs:{header:""}},[e._v(e._s(e.selectedItem.name||"<noname>"))]),s("q-item-label",{staticClass:"q-pa-none q-mt-none text-white ellipsis",staticStyle:{"line-height":"0.75rem!important","margin-top":"1px"},attrs:{caption:""}},[s("small",[e._v(e._s(e.selectedItem.uri||"<no uri>"))])])],1),s("q-item-section",{staticClass:"text-white",attrs:{side:""}},[s("q-item-label",{staticClass:"q-pa-none q-mt-none text-right"},[s("small",[e._v("#"+e._s(e.selectedItem.id))])])],1)],1):e._e()]}},e.filteredItems.length?{key:"option",fn:function(t){return[s("q-item",e._g(e._b({staticClass:"q-pa-xs",attrs:{clickable:""},on:{click:function(s){e.active=t.opt.id}}},"q-item",t.itemProps,!1),t.itemEvents),[s("q-item-section",[s("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-xs",attrs:{header:""}},[e._v(e._s(t.opt.name||"<noname>"))]),s("q-item-label",{staticClass:"q-pa-none q-mt-none",staticStyle:{"line-height":"0.75rem!important","margin-top":"1px"},attrs:{caption:""}},[s("small",[e._v(e._s(t.opt.uri||"<no uri>"))])])],1),s("q-item-section",{attrs:{side:""}},[s("q-item-label",{staticClass:"q-pa-none q-mt-none text-right",class:{"q-pr-xs":e.$q.platform.is.mobile}},[s("small",[e._v("#"+e._s(t.opt.id))])])],1)],1)]}}:null],null,!0)},[s("div",{staticClass:"bg-dark q-pa-xs select__filter",attrs:{slot:"before-options"},slot:"before-options"},[s("q-input",{attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"Filter",autofocus:""},on:{input:function(t){return e.$refs.itemSelect.filter(t)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[s("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1)],1)])],1),s("transition-group",{attrs:{appear:"","enter-active-class":"animated bounceInDown","leave-active-class":"animated bounceOutUp"}},[e.needShowBackToChannel?s("q-btn",{key:"channel",staticClass:"on-right pull-right text-center rounded-borders q-px-xs q-py-none text-white",staticStyle:{width:"60px"},attrs:{title:"View channels",flat:"",dense:""},on:{click:e.viewLogsHandler}},[s("q-icon",{attrs:{size:"1.5rem",color:"white",name:"merge_type"}}),s("div",{staticStyle:{"font-size":".7rem","line-height":".7rem"}},[e._v("Channel")])],1):e._e(),e.needShowBackToDevice?s("q-btn",{key:"device",staticClass:"on-right pull-right text-center rounded-borders q-px-xs q-py-none text-white",staticStyle:{width:"60px"},attrs:{title:"View devices",flat:"",dense:""},on:{click:e.goToDevice}},[s("q-icon",{attrs:{size:"1.5rem",color:"white",name:"mdi-developer-board"}}),s("div",{staticStyle:{"font-size":".7rem","line-height":".7rem"}},[e._v("Device")])],1):e._e()],1)],1)]),e.active?s("traffic-viewer",{staticClass:"flex",attrs:{active:e.active,"active-device":e.activeDevice,isVisibleToolbar:e.isVisibleToolbar,"device-closeble":e.needShowBackToChannel,config:e.config},on:{"change-active-device":e.changeActiveDeviceHandler}}):e._e(),!e.items.length&&e.isItemsInit?s("div",{staticClass:"text-center text-grey-3 q-mt-lg",staticStyle:{"font-size":"2rem"}},[e._v(e._s(e.isLoading?"Fetching data..":"Compatible channels not found"))]):e._e()],1)},a=[],o=s("ded3"),n=s.n(o),l=(s("4e82"),s("13d5"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.activeDevice?s("messages",{directives:[{name:"show",rawName:"v-show",value:e.$q.platform.is.desktop||e.$q.platform.is.mobile&&!e.selectedMessages,expression:"$q.platform.is.desktop || ($q.platform.is.mobile && !selectedMessages)"}],ref:"messages",style:{height:"calc(100vh - "+(e.isVisibleToolbar?"100px":"50px")+")",position:"relative",width:e.$q.platform.is.desktop?"25%":"100%",minWidth:"250px"},attrs:{activeId:e.active,limit:e.limit,config:e.config.messages,"device-closeble":e.deviceCloseble,device:e.activeDevice,view:e.typeOfHexView},on:{"view-data":function(t){e.selectedMessages=t},close:function(){e.$emit("change-active-device",null),e.selectedMessages=""}}}):s("devices",{directives:[{name:"show",rawName:"v-show",value:e.$q.platform.is.desktop||e.$q.platform.is.mobile&&!e.selectedMessages,expression:"$q.platform.is.desktop || ($q.platform.is.mobile && !selectedMessages)"}],ref:"devices",style:{height:"calc(100vh - "+(e.isVisibleToolbar?"100px":"50px")+")",position:"relative",width:e.$q.platform.is.desktop?"25%":"100%",minWidth:"250px"},attrs:{activeId:e.active,config:e.config.messages,device:e.activeDevice,view:e.typeOfHexView},on:{"view-data":function(t){e.selectedMessages=t},"change:device":function(t){e.$emit("change-active-device",t)},close:function(){e.$emit("change-active-device",null),e.selectedMessages=""},"device:preview":e.previewShow,"device:preview-hide":e.previewHide}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.$q.platform.is.desktop||e.$q.platform.is.mobile&&e.selectedMessages,expression:"$q.platform.is.desktop || ($q.platform.is.mobile && selectedMessages)"}],style:{width:e.$q.platform.is.desktop?"75%":"100%",maxWidth:e.$q.platform.is.desktop?"calc(100% - 250px)":""}},[e.activeDevice?s("q-toolbar",{staticClass:"bg-grey-9"},[e.$q.platform.is.mobile?s("q-icon",{staticClass:"cursor-pointer",attrs:{color:"white",size:"1.5rem",name:"mdi-close"},nativeOn:{click:function(t){return function(){e.selectedMessages=""}.apply(null,arguments)}}}):e._e(),s("q-toolbar-title",[s("div",{staticClass:"text-white"},[e._v(e._s(e.activeDevice.ident))])]),s("q-btn",{attrs:{color:"white",flat:"",dense:"",label:"hex"===e.typeOfHexView?"text":"hex","icon-right":"hex"===e.typeOfHexView?"mdi-format-text":"mdi-matrix"},on:{click:function(t){e.typeOfHexView="hex"===e.typeOfHexView?"text":"hex"}}},[s("q-tooltip",[e._v("Change view mode to "+e._s("hex"===e.typeOfHexView?"text":"hex"))])],1),e.activeDevice?s("q-btn",{attrs:{color:"white",flat:"",dense:"",icon:"mdi-export-variant"}},[s("q-tooltip",[e._v("Export")]),s("q-menu",[s("q-list",{staticClass:"bg-grey-8 text-white",staticStyle:{"min-width":"150px"}},[s("div",{staticClass:"q-pa-sm"},[s("div",{staticStyle:{"font-size":".8rem"}},[e._v("Copy selected packets as")]),s("div",[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:!e.selectedMessages.length,dense:"",flat:"",label:"shown"},on:{click:function(t){return e.copySelected()}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:!e.selectedMessages.length,dense:"",flat:"",label:"hex"},on:{click:function(t){return e.copySelected("hex")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:!e.selectedMessages.length,dense:"",flat:"",label:"raw"},on:{click:function(t){return e.copySelected("text")}}})],1)]),s("q-separator"),s("div",{staticClass:"q-pa-sm"},[s("div",{staticStyle:{"font-size":".8rem"}},[e._v("Export selected packets as")]),s("div",[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:!e.selectedMessages.length,dense:"",flat:"",label:"shown"},on:{click:function(t){return e.exportSelected()}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:!e.selectedMessages.length,dense:"",flat:"",label:"hex"},on:{click:function(t){return e.exportSelected("hex")}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{disable:!e.selectedMessages.length,dense:"",flat:"",label:"raw"},on:{click:function(t){return e.exportSelected("text")}}})],1)]),s("q-separator"),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.$refs.messages&&e.$refs.messages.exportModalOpen()}}},[s("q-item-section",[e._v("Export by time")])],1)],1)],1)],1):e._e()],1):e._e(),e.activeDevice?s("packet-view",{style:{height:"calc(100vh - "+(e.isVisibleToolbar&&e.activeDevice?"150px":"100px")+")",position:"relative",overflow:"auto"},attrs:{packets:e.selectedMessages,view:e.typeOfHexView}}):e.$q.platform.is.desktop&&e.devicePreview&&e.devicePreviewMessages.length?s("div",{staticClass:"q-pa-md",staticStyle:{overflow:"hidden","max-height":"calc(100vh - 100px)"}},[s("q-timeline",{attrs:{layout:"loose",color:"white",dark:""}},e._l(e.devicePreviewMessages,(function(t,i){return s("message-preview-item",{key:i,attrs:{message:t,view:e.typeOfHexView}})})),1)],1):s("div",{staticStyle:{"text-align":"center",color:"#9e9e9e","font-size":"3rem","padding-top":"40px"}},[s("div",[e._v("Select ident")]),s("q-icon",{attrs:{name:"mdi-arrow-down-bold-outline",size:"3rem"}}),s("div",[e._v("Find message")]),s("q-icon",{attrs:{name:"mdi-arrow-down-bold-outline",size:"3rem"}}),s("div",[e._v("Analyze data")])],1)],1)],1)}),r=[],c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"wrapper"},[s("q-resize-observer",{on:{resize:e.wrapperResizeHandler}}),s("div",[s("q-toolbar",{staticClass:"bg-grey-9"},[e.deviceCloseble?s("q-btn",{staticClass:"text-white",attrs:{flat:"",dense:"",rounded:"",icon:"mdi-arrow-left"},on:{click:e.closeDevice}},[s("q-tooltip",[e._v("Close current device")])],1):e._e(),e.deviceCloseble?s("q-toolbar-title"):e._e(),s("date-range-modal",{staticClass:"flex flex-center",attrs:{date:e.dateRange,theme:e.theme},on:{save:e.dateRangeChangeHandler}})],1),e.loadingFlag&&e.itemsCount>0?s("div",{staticClass:"absolute-bottom-right absolute-top-left",staticStyle:{overflow:"hidden",top:"50px"}},e._l(new Array(e.itemsCount).fill(""),(function(e,t){return s("message-skeleton",{key:t})})),1):!e.loadingFlag&&e.messages.length?[s("VirtualList",{ref:"scroller",class:{"bg-grey-9":!0,"text-white":!0,"cursor-pointer":!0},style:{position:"absolute",top:"50px",bottom:0,right:0,left:0,height:"auto"},attrs:{onscroll:e.listScroll,size:e.itemHeight,remain:e.itemsCount,wclass:"q-w-list"}},e._l(e.messages,(function(t,i){return s("messages-list-item",{key:i,attrs:{item:t,index:i,actions:e.actions,itemHeight:e.itemHeight,selected:e.selected.includes(i),view:e.view},on:{action:e.actionHandler,"item-click":e.messageClickHandler}})})),1)]:s("empty-pane",{attrs:{config:e.config.emptyState}})],2),s("export-modal",{ref:"export",attrs:{format:e.view,dateRange:e.dateRange,config:e.config,ident:e.device.ident,"item-id":e.activeId}})],1)},d=[],m=(s("ddb0"),s("89c1")),h=s.n(m),p=s("9b02"),u=s.n(p),v=s("de45"),g=s("cdde"),f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-item",{class:[e.selected?"bg-grey-8":""],staticStyle:{"user-select":"none"},attrs:{clickable:""},on:{click:function(t){e.itemClickHandler(e.index,e.item,t)}}},[s("q-tooltip",[e._v(e._s(e.eventsDesc[e.item.type]))]),e.actions?s("q-item-section",{staticClass:"q-pr-none",attrs:{side:""}},e._l(e.actions,(function(t,i){return s("q-icon",{key:i,staticClass:"cursor-pointer on-left",class:t.classes,attrs:{name:t.icon,color:e.selected?"grey-5":""},nativeOn:{click:function(s){return s.stopPropagation(),e.clickHandler(e.index,t.type,e.item)}}},[s("q-tooltip",[e._v(e._s(t.label))])],1)})),1):e._e(),s("q-item-section",[s("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-none",class:["text-"+e.eventsColors[e.item.type]+"-"+(e.selected?3:4)],attrs:{header:""}},[e._v(e._s(e.date.formatDate(1e3*e.item.timestamp,"DD/MM/YYYY HH:mm:ss")))]),e.size?s("q-item-label",{staticClass:"ellipsis overflow-hidden text-grey-5",attrs:{caption:""}},[e._v(e._s(e.size+" B : ")),s("small",[e._v(e._s(e.dataPreview))])]):e._e()],1),s("q-item-section",{attrs:{side:""}},[s("small",{class:["text-grey-"+(e.selected?5:7)]},[e._v(e._s(e.eventsDesc[e.item.type]))]),s("div",[s("small",{staticClass:"rounded-borders q-mx-xs q-px-xs text-white",class:{"bg-blue":"tcp"===e.transport,"bg-purple-9":"udp"===e.transport,"bg-green-9":"http"===e.transport}},[e._v(e._s(e.transport))]),s("q-icon",{staticClass:"q-ml-xs",attrs:{size:"1.2rem",color:e.eventsColors[e.item.type],name:e.eventIcons[e.item.type]}})],1)])],1)},b=[],w=s("bd4c"),x=s("c423"),y={props:["item","index","actions","itemHeight","selected","view"],data(){const e={2:"tcp",66:"http",67:"http",130:"udp",3:"tcp",131:"udp"};return{date:w["a"],transport:e[this.item.type],hex:this.base64ToHex(this.item.data),eventsColors:{0:"green",1:"red",2:"purple",66:"purple",67:"yellow",130:"purple",3:"yellow",131:"yellow"},eventsDesc:{0:"Connect",1:"Disconnect",2:"Data received",130:"Data received",66:"Data received",67:"Data sent",3:"Data sent",131:"Data sent"},eventIcons:{0:"mdi-lan-connect",1:"mdi-lan-disconnect",2:"mdi-arrow-right-thick",66:"mdi-arrow-right-thick",67:"mdi-arrow-left-thick",130:"mdi-arrow-right-thick",3:"mdi-arrow-left-thick",131:"mdi-arrow-left-thick"}}},computed:{dataPreview(){if(!this.item.data)return"";let e=this.hex;if("text"===this.view){const t=e.match(/.{1,2}/g);e=t.map((e=>this.replaceByteWithMnemo(e))).join("")}return e},size(){return this.item.data?Math.floor(this.hex.length/2):null}},methods:{clickHandler(e,t,s){const i=n()({},s);i.data=this.dataPreview,this.$emit("action",{index:e,type:t,content:i})},itemClickHandler(e,t,s){this.$emit("item-click",{index:e,content:t,event:s})}},mixins:[x["a"]]},$=y,C=s("2877"),k=s("66e5"),q=s("05c0"),M=s("4074"),D=s("0016"),_=s("0170"),S=s("eebe"),T=s.n(S),I=Object(C["a"])($,f,b,!1,null,null,null),N=I.exports;T()(I,"components",{QItem:k["a"],QTooltip:q["a"],QItemSection:M["a"],QIcon:D["a"],QItemLabel:_["a"]});var H=s("121a"),z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-item",{staticClass:"bg-grey-9"},[s("q-item-section",[s("q-item-label",{staticClass:"q-pa-none bg-white full-width skeleton--modificator",staticStyle:{height:"16px"},attrs:{header:""}}),s("q-item-label",{staticClass:"bg-grey-6  full-width skeleton--modificator",staticStyle:{height:"15px"},attrs:{caption:""}})],1),s("q-item-section",{staticStyle:{width:"30%"},attrs:{side:""}},[s("div",{staticClass:"bg-white full-width skeleton--modificator",staticStyle:{height:"16px"}})])],1)},P=[],O=(s("2724"),{}),Q=Object(C["a"])(O,z,P,!1,null,null,null),E=Q.exports;T()(Q,"components",{QItem:k["a"],QItemSection:M["a"],QItemLabel:_["a"]});var F=s("5a3a"),L=s.n(F),G=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-dialog",{ref:"modal",attrs:{maximized:e.$q.platform.is.mobile,"no-esc-dismiss":e.loadingFlag,"no-backdrop-dismiss":e.loadingFlag}},[s("q-card",{staticClass:"bg-grey-9",style:{minWidth:e.$q.platform.is.mobile?"100%":"310px",height:e.$q.platform.is.mobile?"100%":"auto"}},[s("q-card-section",{staticClass:"q-pa-sm",style:{height:"calc(100% - 54px)"}},[s("date-range-picker",{attrs:{theme:{color:"white",bgColor:"grey-9",contentInverted:!0,controlsInverted:!0}},model:{value:e.currentDateRange,callback:function(t){e.currentDateRange=t},expression:"currentDateRange"}}),s("q-select",{attrs:{options:e.selectOpts,multiple:"",dark:"",outlined:"",label:"Format","hide-bottom-space":"",dense:"",color:"white","bg-color":"grey-9"},model:{value:e.currentFormat,callback:function(t){e.currentFormat=t},expression:"currentFormat"}}),s("q-toggle",{attrs:{dark:""},model:{value:e.needTimeConvert,callback:function(t){e.needTimeConvert=t},expression:"needTimeConvert"}},[s("span",{staticClass:"text-white"},[e._v("Format timestamps")])]),e.needTimeConvert?[s("q-input",{staticClass:"q-mb-sm",attrs:{outlined:"",dense:"",label:"Date format",dark:"",color:"white"},model:{value:e.timeFormat,callback:function(t){e.timeFormat=t},expression:"timeFormat"}}),s("q-select",{attrs:{options:e.timezoneOptions,"emit-value":"","map-options":"",dark:"",outlined:"",label:"Timezone","hide-bottom-space":"",dense:"",color:"white","bg-color":"grey-9"},model:{value:e.timezoneOffset,callback:function(t){e.timezoneOffset=t},expression:"timezoneOffset"}})]:e._e()],2),s("q-separator",{attrs:{color:"grey-8"}}),s("q-card-actions",{staticClass:"bg-grey-9 text-white",attrs:{align:"right"}},[s("q-btn",{attrs:{flat:"",disable:e.loadingFlag},on:{click:e.hide}},[e._v("Close")]),s("q-btn",{attrs:{flat:"",disable:e.loadingFlag||e.currentFormat.length<1,loading:e.loadingFlag},on:{click:e.importHandler}},[e._v("Export")])],1)],1)],1)},A=[],R=(s("2b3d"),s("a99f")),B={props:["format","dateRange","config","ident","itemId"],data(){return{currentFormat:[this.format],currentDateRange:this.dateRange.map((e=>new Date(e))),moduleName:this.config.vuexModuleName,loadingFlag:!1,selectOpts:["hex","text","base64"],needTimeConvert:!1,timeFormat:"YYYY/MM/DD HH:mm:ss.SSS",currentTimezoneOffset:-(new Date).getTimezoneOffset()/60,timezoneOffset:"local",timezoneOptions:[{value:"local",label:"Local time (computer`s timezone)"},{value:-12,label:"(GMT -12:00) Eniwetok, Kwajalein"},{value:-11,label:"(GMT -11:00) Midway Island, Samoa"},{value:-10,label:"(GMT -10:00) Hawaii"},{value:-9,label:"(GMT -9:00) Alaska"},{value:-8,label:"(GMT -8:00) Pacific Time (US &amp; Canada)"},{value:-7,label:"(GMT -7:00) Mountain Time (US &amp; Canada)"},{value:-6,label:"(GMT -6:00) Central Time (US &amp; Canada), Mexico City"},{value:-5,label:"(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima"},{value:-4,label:"(GMT -4:00) Atlantic Time (Canada), Caracas, La Paz"},{value:-3.5,label:"(GMT -3:30) Newfoundland"},{value:-3,label:"(GMT -3:00) Brazil, Buenos Aires, Georgetown"},{value:-2,label:"(GMT -2:00) Mid-Atlantic"},{value:-1,label:"(GMT -1:00 hour) Azores, Cape Verde Islands"},{value:0,label:"(GMT) Western Europe Time, London, Lisbon, Casablanca"},{value:1,label:"(GMT +1:00 hour) Brussels, Copenhagen, Madrid, Paris"},{value:2,label:"(GMT +2:00) Kaliningrad, South Africa"},{value:3,label:"(GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg"},{value:3.5,label:"(GMT +3:30) Tehran"},{value:4,label:"(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi"},{value:4.5,label:"(GMT +4:30) Kabul"},{value:5,label:"(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent"},{value:5.5,label:"(GMT +5:30) Bombay, Calcutta, Madras, New Delhi"},{value:5.75,label:"(GMT +5:45) Kathmandu"},{value:6,label:"(GMT +6:00) Almaty, Dhaka, Colombo"},{value:7,label:"(GMT +7:00) Bangkok, Hanoi, Jakarta"},{value:8,label:"(GMT +8:00) Beijing, Perth, Singapore, Hong Kong"},{value:9,label:"(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk"},{value:9.5,label:"(GMT +9:30) Adelaide, Darwin"},{value:10,label:"(GMT +10:00) Eastern Australia, Guam, Vladivostok"},{value:11,label:"(GMT +11:00) Magadan, Solomon Islands, New Caledonia"},{value:12,label:"(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka"}]}},methods:{show(){this.$refs.modal.show()},hide(){this.$refs.modal.hide()},formatData(e,t){let s=null;return s="hex"===t?this.base64ToHex(e):"text"===t?this.base64ToTextWithMnemoReplacing(e):e,s},dateByTimezone(e,t){const s=new Date(e),i=s.getTime(),a=6e4*s.getTimezoneOffset(),o=i+a,n=36e5*t,l=o+n;return new Date(l)},async importHandler(){this.loadingFlag=!0;const e={from:Math.floor(this.currentDateRange[0].valueOf()/1e3),to:Math.floor(this.currentDateRange[1].valueOf()/1e3)},t=await this.$store.dispatch(`${this.moduleName}/getExportData`,e);t.forEach(((e,s)=>{if(this.needTimeConvert){const e=this.timeFormat||"YYYY/MM/DD HH:mm:ss";"local"===this.timezoneOffset?t[s].timestamp=w["a"].formatDate(1e3*t[s].timestamp,e):t[s].timestamp=w["a"].formatDate(this.dateByTimezone(1e3*t[s].timestamp,this.timezoneOffset),e)}if(!t[s].data)return!1;this.currentFormat.forEach((i=>{t[s][i]=this.formatData(e.data,i)})),t[s].data=void 0}));const s="application/json",i=document.createElement("a"),a=JSON.stringify(t,void 0,2),o=new Blob([a],{type:s}),n=URL.createObjectURL(o),l=`[${w["a"].formatDate(this.currentDateRange[0],"DD.MM.YYYY HH-mm-ss")} - ${w["a"].formatDate(this.currentDateRange[1],"DD.MM.YYYY HH-mm-ss")}]`,r="local"===this.timezoneOffset?this.currentTimezoneOffset:this.timezoneOffset,c=`${this.itemId}_${this.ident}${l}_${r>=0?`GMT+${r}`:`GMT${r}`}.json`;i.setAttribute("href",n),i.setAttribute("download",c),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),this.loadingFlag=!1,this.hide()}},watch:{dateRange(e){this.currentDateRange=e.map((e=>new Date(e)))},format(e){this.currentFormat=[e]}},components:{DateRangePicker:R["a"]},mixins:[x["a"]]},V=B,Y=s("24e8"),j=s("f09f"),K=s("a370"),W=s("ddd8"),U=s("9564"),J=s("27f9"),X=s("eb85"),Z=s("4b7e"),ee=s("9c40"),te=Object(C["a"])(V,G,A,!1,null,null,null),se=te.exports;T()(te,"components",{QDialog:Y["a"],QCard:j["a"],QCardSection:K["a"],QSelect:W["a"],QToggle:U["a"],QInput:J["a"],QSeparator:X["a"],QCardActions:Z["a"],QBtn:ee["a"]});var ie={props:["activeId","device","limit","config","view","deviceCloseble"],data(){return{theme:this.config.theme,viewConfig:this.config.viewConfig,actions:this.config.actions,moduleName:this.config.vuexModuleName,itemHeight:53,itemsCount:0,wrapperHeight:0,needAutoScroll:!0,selected:[],scrollerScrollTop:0}},computed:{messages:{get(){return this.$store.state[this.moduleName].messages},set(e){this.$store.commit(`${this.moduleName}/setMessages`,e)}},currentLimit:{get(){return this.$store.state[this.moduleName].limit},set(e){this.$store.commit(`${this.moduleName}/setLimit`,e)}},dateRange(){return[this.$store.state[this.moduleName].from,this.$store.state[this.moduleName].to]},from:{get(){return this.$store.state[this.moduleName].from},set(e){e=e||0,this.$store.commit(`${this.moduleName}/setFrom`,e)}},to:{get(){return this.$store.state[this.moduleName].to},set(e){e=e||0,this.$store.commit(`${this.moduleName}/setTo`,e)}},realtimeEnabled(){return this.$store.state[this.moduleName].messagePolling},loadingFlag(){const e=this.$store.state;return!(!e[this.config.vuexModuleName]||!e[this.config.vuexModuleName].isLoading)}},methods:{resetParams(){if(!this.$refs.wrapper)return!1;if(this.wrapperHeight=this.$refs.wrapper.offsetHeight-this.itemHeight,this.itemsCount=Math.ceil(this.wrapperHeight/this.itemHeight),this.$refs.scroller&&this.$refs.scroller.forceRender(),this.$refs.scroller&&this.$refs.scroller.$el){const e=this.$refs.scroller.$el;e.scrollTop+=1}},dateRangeChangeHandler(e){const t=e[0],s=e[1];if(this.from===t&&this.to===s)return!1;this.from=t,this.to=s,this.realtimeEnabled&&this.$store.dispatch(`${this.moduleName}/removePollingGetMessages`),this.needAutoScroll&&s<=Date.now()&&(this.needAutoScroll=!1),this.$store.commit(`${this.moduleName}/clearMessages`),this.$store.dispatch(`${this.moduleName}/getMessages`).then((()=>{s>Date.now()&&this.$store.dispatch(`${this.moduleName}/pollingGetMessages`)}))},clearSelected(){this.selected=[]},wrapperResizeHandler(){this.resetParams()},getScrollDirection(e){let t=null;return t=e>this.currentScrollTop?"bottom":e<this.currentScrollTop?"top":"none",t},listScroll:function(e,t){const{offset:s}=t;this.currentScrollTop||(this.currentScrollTop=s);const i=u()(this.$refs,"scroller.$el",void 0),a=i.scrollHeight-i.clientHeight,o=this.getScrollDirection(s),n=.1*a;this.allScrollTop=this.$refs.scroller?this.$refs.scroller.$el.scrollHeight-this.$refs.scroller.$el.clientHeight:0,this.messages.length&&(s<this.currentScrollTop&&this.needAutoScroll?this.needAutoScroll=!1:!this.needAutoScroll&&this.realtimeEnabled&&s>=this.allScrollTop&&(this.needAutoScroll=!0),this.currentScrollTop=s),o&&("top"===o||"none"===o)&&s<n?this.getMessagesPrev():o&&("bottom"===o||"none"===o)&&s+n>=a&&this.getMessagesNext()},getMessagesPrev(){const e=u()(this.$refs,"scroller.$el",void 0),t=e.scrollHeight-e.clientHeight,s=e.scrollTop;this.$store.dispatch(`${this.moduleName}/getMessagesPrev`).then((i=>{if(i&&i.length){const i=e.scrollHeight-e.clientHeight;e.scrollTop=i-t+s}}))},getMessagesNext(){this.$store.dispatch(`${this.moduleName}/getMessagesNext`)},actionHandler({index:e,type:t,content:s}){switch(t){case"view":this.viewMessagesHandler({index:e,content:s});break;case"copy":this.copyMessageHandler({index:e,content:s});break}},viewMessagesHandler({index:e,content:t}){this.selected=[e],this.$root.$emit("view-data",t)},messageClickHandler({index:e,content:t,event:s}){if(s.shiftKey)this.selected[0]?this.selected[0]>e?this.selected=L()(e,this.selected[0]+1):this.selected=L()(this.selected[0],e+1):this.selected=[e];else if(s.ctrlKey||s.metaKey)if(this.selected.includes(e)){const t=this.selected;t.splice(this.selected.indexOf(e),1),this.selected=t}else this.selected=[...this.selected,e];else this.selected=[e];this.needAutoScroll&&(this.needAutoScroll=!1),this.selected.sort(((e,t)=>e-t)),this.$emit("view-data",this.selected.map((e=>n()(n()({},this.messages[e]),{},{index:e}))))},copyMessageHandler({index:e,content:t}){Object(g["a"])(JSON.stringify(t)).then((e=>{this.$q.notify({type:"positive",icon:"content_copy",message:"Message copied",timeout:1e3})}),(e=>{this.$q.notify({type:"negative",icon:"content_copy",message:"Error coping messages",timeout:1e3})}))},unselect(){this.selected.length&&(this.selected=[])},closeDevice(){this.$emit("close")},clear(){this.realtimeEnabled&&this.$store.dispatch(`${this.moduleName}/removePollingGetMessages`),this.$store.commit(`${this.moduleName}/clearMessages`),this.closeDevice()},exportModalOpen(){this.$refs.export.show()},highlightIncoming(e,t){const s=this.messages.findIndex((e=>2===e.type)),i=this.messages.findIndex((e=>2===e.type&&Math.floor(e.timestamp)===Math.floor(this.to/1e3)));i>-1?this.messageClickHandler({index:i,event:{}}):s>-1&&this.messageClickHandler({index:s,event:{}})},async init(){this.currentLimit=this.limit,this.activeId&&!this.$store.state[this.moduleName].active&&this.$store.commit(`${this.moduleName}/setActive`,this.activeId),this.device&&!this.$store.state[this.moduleName].ident&&this.$store.commit(`${this.moduleName}/setIdent`,this.device.ident);const e=1e3*this.$route.query.from,t=1e3*this.$route.query.to;e&&t?(this.from=e,this.to=t,await this.$store.dispatch(`${this.moduleName}/getMessages`),this.$nextTick(this.highlightIncoming)):(await this.$store.dispatch(`${this.moduleName}/initTime`),await this.$store.dispatch(`${this.moduleName}/getMessagesTail`)),this.to>Date.now()&&await this.$store.dispatch(`${this.moduleName}/pollingGetMessages`)}},watch:{activeId(e){this.clear()},limit(e){this.currentLimit=e}},created(){this.init()},mounted(){this.resetParams()},updated(){this.messages.length?this.needAutoScroll&&this.$refs.scroller&&this.$refs.scroller.$el&&(this.$refs.scroller.$el.scrollTop=this.$refs.scroller.$el.scrollHeight):this.currentScrollTop=0},destroyed(){this.$store.dispatch(`${this.moduleName}/removePollingGetMessages`),this.$store.commit(`${this.moduleName}/clearMessages`),this.to=0,this.from=0},components:{MessagesListItem:N,VirtualList:h.a,EmptyPane:H["a"],MessageSkeleton:E,DateRangeModal:v["a"],ExportModal:se}},ae=ie,oe=s("3980"),ne=s("65c6"),le=s("6ac5"),re=Object(C["a"])(ae,c,d,!1,null,null,null),ce=re.exports;T()(re,"components",{QResizeObserver:oe["a"],QToolbar:ne["a"],QBtn:ee["a"],QTooltip:q["a"],QToolbarTitle:le["a"]});var de=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"wrapper"},[s("q-resize-observer",{on:{resize:e.wrapperResizeHandler}}),s("div",[s("q-toolbar",{staticClass:"bg-grey-9"},[s("q-input",{staticClass:"full-width",attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"ident",debounce:500},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[s("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1)],1),e.loadingFlag&&e.itemsCount>0?s("div",{staticClass:"absolute-bottom-right absolute-top-left",staticStyle:{overflow:"hidden",top:"50px"}},e._l(new Array(e.itemsCount).fill(""),(function(e,t){return s("device-skeleton",{key:t})})),1):!e.loadingFlag&&e.devicesByIndex.length?[s("VirtualList",{ref:"scroller",class:{"bg-grey-9":!0,"text-white":!0,"cursor-pointer":!0},style:{position:"absolute",top:"50px",bottom:0,right:0,left:0,height:"auto"},attrs:{size:e.itemHeight,remain:e.itemsCount,wclass:"q-w-list"}},e._l(e.devices,(function(t,i){return s("device-list-item",{key:t.ident,attrs:{item:t,index:i,itemHeight:e.itemHeight},on:{"item-click":e.deviceClickHandler},nativeOn:{mouseenter:function(s){return e.previewDeviceHandler(t)},mouseleave:function(s){return e.previewDeviceCloseHandler(t)}}})})),1)]:s("empty-pane",{attrs:{config:e.config.emptyState}})],2)],1)},me=[],he=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-item",{staticClass:"q-py-none",attrs:{clickable:""},on:{click:function(t){e.itemClickHandler(e.index,e.item,t)}}},[s("q-item-section",[s("q-item-label",{staticClass:"ellipsis text-white q-pa-none",attrs:{header:""}},[e._v(e._s(e.ident))]),s("q-item-label",{staticClass:"ellipsis overflow-hidden text-grey-5",attrs:{caption:""}},[e._v(e._s(e.item.size?e.format.humanStorageSize(e.item.size):"new"))])],1)],1)},pe=[],ue=s("7937"),ve={props:["item","index","itemHeight"],data(){return{date:w["a"],format:ue["c"],ident:this.item.ident}},methods:{itemClickHandler(e,t,s){this.$emit("item-click",{index:e,content:t,event:s})}}},ge=ve,fe=Object(C["a"])(ge,he,pe,!1,null,null,null),be=fe.exports;T()(fe,"components",{QItem:k["a"],QItemSection:M["a"],QItemLabel:_["a"]});var we=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-item",{staticClass:"bg-grey-9"},[s("q-item-section",[s("q-item-label",{staticClass:"q-pa-none bg-white full-width skeleton--modificator",staticStyle:{height:"16px"},attrs:{header:""}}),s("q-item-label",{staticClass:"bg-grey-6  full-width skeleton--modificator",staticStyle:{height:"15px"},attrs:{caption:""}})],1)],1)},xe=[],ye=(s("a24e"),{}),$e=Object(C["a"])(ye,we,xe,!1,null,null,null),Ce=$e.exports;T()($e,"components",{QItem:k["a"],QItemSection:M["a"],QItemLabel:_["a"]});var ke={props:["activeId","device","config","view"],data(){return{theme:this.config.theme,viewConfig:this.config.viewConfig,actions:this.config.actions,moduleName:this.config.vuexModuleName,itemHeight:48,itemsCount:0,wrapperHeight:0}},computed:{selectedChannel(){const e=this.$store.state.channels[this.activeId],t=this.$store.state.channelsProtocols[e.protocol_id].features;return e.features=t,e},devices:{get(){return this.$store.state[this.moduleName].devices},set(e){this.$store.commit(`${this.moduleName}/setDevices`,e)}},devicesByIndex(){return Object.values(this.$store.state[this.moduleName].devices)},filter:{get(){return this.$store.state[this.moduleName].deviceFilter},set(e){this.$store.commit(`${this.moduleName}/setDeviceFilter`,e),this.$store.dispatch(`${this.moduleName}/getDevices`).then((()=>{this.$nextTick((()=>{this.$refs.scroller&&this.$refs.scroller.forceRender()}))}))}},active:{get(){return this.$store.state[this.moduleName].active},async set(e){this.realtimeEnabled&&await this.$store.dispatch(`${this.moduleName}/removePollingGetDevices`),this.$store.commit(`${this.moduleName}/setActive`,e),this.$store.commit(`${this.moduleName}/clearDevices`),await this.$store.dispatch(`${this.moduleName}/getDevices`),this.selectedChannel.features.shared_connection||await this.$store.dispatch(`${this.moduleName}/pollingGetDevices`)}},realtimeEnabled(){return this.$store.state[this.moduleName].realtimeEnabled},loadingFlag(){const e=this.$store.state;return!(!e[this.config.vuexModuleName]||!e[this.config.vuexModuleName].isLoading)}},methods:{resetParams(){if(!this.$refs.wrapper)return!1;this.wrapperHeight=this.$refs.wrapper.offsetHeight-this.itemHeight,this.itemsCount=Math.ceil(this.wrapperHeight/this.itemHeight),this.$refs.scroller&&this.$refs.scroller.forceRender()},wrapperResizeHandler(){this.resetParams()},deviceClickHandler({index:e,content:t,event:s}){this.$store.commit(`${this.moduleName}/setIdent`,t.ident),this.$emit("change:device",t)},previewDeviceHandler(e){this.$emit("device:preview",e)},previewDeviceCloseHandler(e){this.$emit("device:preview-hide",e)},clearDevices(){this.devices={}}},watch:{activeId(e){this.active=e}},created(){const e=this.$route.query.filter;e&&this.$store.commit(`${this.moduleName}/setDeviceFilter`,e),this.activeId&&(this.active=this.activeId)},mounted(){this.resetParams()},components:{VirtualList:h.a,DeviceListItem:be,EmptyPane:H["a"],DeviceSkeleton:Ce}},qe=ke,Me=Object(C["a"])(qe,de,me,!1,null,null,null),De=Me.exports;T()(Me,"components",{QResizeObserver:oe["a"],QToolbar:ne["a"],QInput:J["a"],QIcon:D["a"]});var _e=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-timeline-entry",{staticClass:"hex-viewer__timeline-element",attrs:{side:2===e.message.type||130===e.message.type?"left":"right",color:e.eventsColors[e.message.type]+"-6"}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("div",{staticStyle:{"line-height":"18px"}},[s("span",[e._v(e._s(e.eventsDesc[e.message.type]))])]),s("div",{staticClass:"text-grey-5",staticStyle:{"font-size":".7rem"}},[e._v("\n      "+e._s(e.date.formatDate(1e3*e.message.timestamp,"DD/MM/YYYY HH:mm:ss"))+"\n      "),s("small",{staticClass:"rounded-borders q-mx-xs q-px-xs text-white",class:{"bg-blue":"tcp"===e.transport,"bg-purple-9":"udp"===e.transport}},[e._v(e._s(e.transport))])])]),s("div",{staticClass:"ellipsis",staticStyle:{"word-break":"break-all","font-size":".8rem",height:"1rem"}},[e._v(e._s(e.dataPreview))])])},Se=[],Te={props:["message","view"],data(){return{date:w["a"],eventsColors:{0:"green",1:"red",2:"purple",130:"purple",3:"yellow",131:"yellow"},eventsDesc:{0:"Connect",1:"Disconnect",2:"Data received",130:"Data received",3:"Data sent",131:"Data sent"},eventIcons:{0:"mdi-lan-connect",1:"mdi-lan-disconnect",2:"mdi-arrow-right-thick",130:"mdi-arrow-right-thick",3:"mdi-arrow-left-thick",131:"mdi-arrow-left-thick"}}},computed:{dataPreview(){let e=this.base64ToHex(this.message.data)||"";if("text"===this.view&&e){const t=e.match(/.{1,2}/g);e=t.map((e=>this.replaceByteWithMnemo(e))).join("")}return e},transport(){return 0===this.message.type||1===this.message.type?"":this.message.type>=128?"udp":"tcp"}},mixins:[x["a"]]},Ie=Te,Ne=(s("cb33"),s("74af")),He=s("05eb"),ze=Object(C["a"])(Ie,_e,Se,!1,null,null,null),Pe=ze.exports;T()(ze,"components",{QTimelineEntry:Ne["a"],QTimeline:He["a"]});var Oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.packets&&e.packets.length?s("div",{staticClass:"traffic-viewer__packets q-pa-sm"},e._l(e.batches,(function(t,i){return s("div",{key:i,staticStyle:{"min-width":"820px"}},[e.batches[i-1]?s("div",{staticClass:"packets__separator",style:{backgroundColor:e.bgDataColors[t.type]}}):e._e(),s("div",{staticClass:"packet__header text-center",style:{backgroundColor:e.bgDataColors[t.type]}},[s("span",{staticClass:"rounded-borders text-white full-height"},[s("q-icon",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"1rem",color:e.eventsColors[t.type],name:e.eventIcons[t.type]}}),s("span",{staticClass:"text-uppercase text-white"},[e._v(e._s(e.eventsDesc[t.type]))]),e._v("\n        (\n        "),s("span",{staticClass:"text-white",class:{"q-mr-sm":t.size},staticStyle:{"font-size":".8rem"}},[e._v(e._s(e.date.formatDate(1e3*t.timestamp,"DD/MM/YYYY HH:mm:ss")))]),t.size?s("span",{staticClass:"q-mr-sm text-white",staticStyle:{"font-size":".8rem"}},[e._v("size: "+e._s(t.size)+"B")]):e._e(),t.transport?s("small",{staticClass:"rounded-borders q-px-xs text-white",class:{"bg-blue":"tcp"===t.transport,"bg-purple-9":"udp"===t.transport,"bg-green-9":"http"===t.transport},staticStyle:{"vertical-align":"middle"}},[e._v("\n          "+e._s(t.transport)+"\n        ")]):e._e(),e._v("\n        )\n      ")],1)]),t.data?s("hex-viewer",{style:{backgroundColor:e.bgDataColors[t.type]},attrs:{hex:t.data,view:e.view}}):e._e(),e.batches[i+1]?s("div",{staticClass:"packets__separator",style:{backgroundColor:e.bgDataColors[t.type]}}):e._e(),e.getNeedMissing(i)?s("div",{staticClass:"packets__missing"},[s("div",{staticClass:"missing__up"}),s("div",{staticClass:"missing__down"})]):e._e()],1)})),0):s("div",{staticStyle:{"text-align":"center",color:"#9e9e9e","font-size":"3rem","padding-top":"40px"}},[e._v("Select packets")])},Qe=[],Ee=s("d77f"),Fe={props:["packets","view"],data(){return{date:w["a"],transports:{2:"tcp",66:"http",67:"http",130:"udp",3:"tcp",131:"udp"},eventsColors:{0:"green",1:"red",2:"purple",130:"purple",3:"yellow",66:"purple",67:"yellow",131:"yellow"},eventsDesc:{0:"Connect",1:"Disconnect",2:"Data received",130:"Data received",3:"Data sent",66:"Data received",67:"Data sent",131:"Data sent"},eventIcons:{0:"mdi-lan-connect",1:"mdi-lan-disconnect",2:"mdi-arrow-right-thick",130:"mdi-arrow-right-thick",3:"mdi-arrow-left-thick",66:"mdi-arrow-right-thick",67:"mdi-arrow-left-thick",131:"mdi-arrow-left-thick"},bgDataColors:{0:"rgba(76, 175, 80, 0.4)",1:"rgba(244, 67, 54, 0.4)",2:"rgba(156, 39, 176, 0.4)",130:"rgba(156, 39, 176, 0.4)",3:"rgba(255, 235, 59, 0.4)",66:"rgba(156, 39, 176, 0.4)",67:"rgba(255, 235, 59, 0.4)",131:"rgba(255, 235, 59, 0.4)"}}},computed:{batches(){return this.packets&&this.packets.length?this.packets.reduce(((e,t,s)=>{const i=n()({},t);i.data=this.base64ToHex(t.data),i.index=[i.index],i.transport=this.transports[i.type],i.data&&(i.size=Math.floor(i.data.length/2));const a=e[e.length-1];return a&&a.type===i.type&&2===i.type&&a.conn===i.conn&&a.index[a.index.length-1]+1===i.index[0]?(a.data+=i.data,a.size+=i.size,a.index=[...a.index,...i.index]):e.push(i),e}),[]):[]}},methods:{getNeedMissing(e){const t=this.batches[e],s=this.batches[e+1];return s&&t.index[t.index.length-1]+1<s.index[0]}},mixins:[x["a"]],components:{HexViewer:Ee["a"]}},Le=Fe,Ge=(s("aff9"),Object(C["a"])(Le,Oe,Qe,!1,null,null,null)),Ae=Ge.exports;T()(Ge,"components",{QIcon:D["a"]});s("26e9");var Re=s("2b0e");function Be(e){const t=e||Date.now(),s=new Date(t).setHours(0,0,0,0),i=s+86399999;return{from:s,to:i}}async function Ve({state:e,commit:t}){let s=Date.now();try{const t=await Re["default"].connector.gw.getChannelsIdentsPackets(e.active,e.ident,{data:{count:1,reverse:!0}});s=u()(t,"data.result[0].timestamp",Math.floor(Date.now()/1e3)),s=Math.round(1e3*s)}catch(a){}const i=Be(s);t("setFrom",i.from),t("setTo",i.to)}async function Ye({state:e,commit:t}){"undefined"!==typeof e.isLoading&&Re["default"].set(e,"isLoading",!0);try{const s=await Re["default"].connector.gw.getChannelsIdents(e.active,e.deviceFilter?`*${e.deviceFilter}*`:"*");let i=u()(s,"data.result",[]);i=i.reduce(((e,{ident:t,size:s})=>(e[t]={ident:t,size:s},e)),{}),t("setDevices",i)}catch(s){t("reqFailed",s)}"undefined"!==typeof e.isLoading&&Re["default"].set(e,"isLoading",!1)}async function je({state:e,commit:t}){"undefined"!==typeof e.isLoading&&Re["default"].set(e,"isLoading",!0);try{const s=Date.now(),i=e.to>s?s:e.to,a=await Re["default"].connector.gw.getChannelsIdentsPackets(e.active,e.ident,{data:{from:Math.floor(e.from/1e3),to:Math.floor(i/1e3),count:e.limit}}),o=u()(a,"data.result",[]);t("setMessages",o)}catch(s){t("reqFailed",s)}"undefined"!==typeof e.isLoading&&Re["default"].set(e,"isLoading",!1)}async function Ke({state:e,commit:t}){"undefined"!==typeof e.isLoading&&Re["default"].set(e,"isLoading",!0);try{const s=Date.now(),i=e.to>s?s:e.to,a=await Re["default"].connector.gw.getChannelsIdentsPackets(e.active,e.ident,{data:{count:e.limit,reverse:!0,from:Math.floor(e.from/1e3),to:Math.floor(i/1e3)}}),o=u()(a,"data.result",[]);o.reverse(),t("setMessages",o)}catch(s){t("reqFailed",s)}"undefined"!==typeof e.isLoading&&Re["default"].set(e,"isLoading",!1)}let We=!1;async function Ue({state:e,commit:t}){if(!e.messages.length||We||e.messagePolling)return;We=!0;let s=[];try{const i=Math.ceil(e.messages[e.messages.length-1].timestamp),a=await Re["default"].connector.gw.getChannelsIdentsPackets(e.active,e.ident,{data:{count:e.limit,from:i,to:Math.floor(e.to/1e3)}});s=u()(a,"data.result",[]),t("setMessagesAppend",s)}catch(i){t("reqFailed",i)}return We=!1,s}async function Je({state:e,commit:t}){if(!e.messages.length||We)return;We=!0;let s=[];try{const i=Math.floor(e.messages[0].timestamp)-1,a=await Re["default"].connector.gw.getChannelsIdentsPackets(e.active,e.ident,{data:{count:e.limit,from:Math.floor(e.from/1e3),to:i,reverse:!0}});s=u()(a,"data.result",[]),s.reverse(),t("setMessagesPrepend",s)}catch(i){t("reqFailed",i)}return We=!1,s}async function Xe({state:e,commit:t}){await Re["default"].connector.socket.subscribe({name:`flespi/log/gw/channels/${e.active}/connections/+/identified`,handler:(t,s,i)=>{t=JSON.parse(t.toString());const a=t.ident;e.devices[a]||-1===a.indexOf(e.deviceFilter)||Re["default"].set(e.devices,a,{ident:a})}}),e.realtimeEnabled=!0}async function Ze({state:e,commit:t}){e.realtimeEnabled=!1,await Re["default"].connector.socket.unsubscribe(`flespi/log/gw/channels/${e.active}/connections/+/identified`)}let et=0;function tt({state:e,commit:t}){et=setInterval((async()=>{try{const s=Math.ceil(e.messages[e.messages.length-1].timestamp),i=Math.ceil(Date.now()/1e3),a=await Re["default"].connector.gw.getChannelsIdentsPackets(e.active,e.ident,{data:{from:s,to:i}}),o=u()(a,"data.result",[]);t("setMessagesAppend",o)}catch(s){t("reqFailed",s)}}),1e4),e.messagePolling=!0}function st({state:e,commit:t}){clearInterval(et),et=0,e.messagePolling=!1}async function it({state:e},t){let s=[];try{const i=await Re["default"].connector.gw.getChannelsIdentsPackets(e.active,t.ident,{data:{count:20,reverse:!0}});s=u()(i,"data.result",[])}catch(i){}return s}async function at({state:e},{from:t,to:s}){let i=[];try{const a=await Re["default"].connector.gw.getChannelsIdentsPackets(e.active,e.ident,{data:{from:t,to:s}});i=u()(a,"data.result",[])}catch(a){}return i}var ot={initTime:Ve,getMessages:je,getMessagesTail:Ke,getMessagesNext:Ue,getMessagesPrev:Je,getDevices:Ye,pollingGetDevices:Xe,removePollingGetDevices:Ze,pollingGetMessages:tt,removePollingGetMessages:st,getDevicePreview:it,getExportData:at};function nt(e,t){e.limit=t}function lt(e,t){e.active=t}function rt(e){e.messages=[]}function ct(e){e.devices=[]}function dt(e,t){e.devices=t}function mt(e,t){e.messages=t}function ht(e,t){e.messages.splice(e.messages.length,0,...t)}function pt(e,t){e.messages.splice(0,0,...t)}function ut(e,t){e.to=t}function vt(e,t){e.from=t}function gt(e,t){e.deviceFilter=t}function ft(e,t){e.ident=t}function bt(e){e.devices={},e.messages=[],e.to=0,e.from=0,e.active=null}function wt(e,t){}var xt={setLimit:nt,setActive:lt,clearMessages:rt,clearDevices:ct,setDevices:dt,setMessages:mt,setMessagesAppend:ht,setMessagesPrepend:pt,clean:bt,setTo:ut,setFrom:vt,setDeviceFilter:gt,setIdent:ft,reqFailed:wt};const yt={devices:{},messages:[],active:null,ident:null,limit:0,deviceFilter:"",from:0,to:0,isLoading:!1,realtimeEnabled:!1,messagePolling:!1};var $t={namespaced:!0,state:yt,actions:ot,mutations:xt},Ct=s("798f"),kt={props:["active","activeDevice","isVisibleToolbar","config","deviceCloseble"],data(){return{devicePreview:null,typeOfHexView:"hex",limit:1e3,selectedMessages:"",moduleName:this.config.messages.vuexModuleName,devicePreviewMessages:[]}},computed:{hex(){return!(!this.selectedMessages||!this.activeDevice)&&this.selectedMessages.reduce(((e,t)=>(e+=this.base64ToHex(t.data)||"",e)),"")}},methods:{async previewShow(e){this.devicePreview=e,this.devicePreviewMessages=await this.$store.dispatch(`${this.moduleName}/getDevicePreview`,e)},previewHide(e){this.devicePreview=null},getContentBySelected(e){return this.selectedMessages.reduce(((t,s)=>(t+=this.getHeader(s),t+="\r\n",s.data&&(t+=this.getContent(e,this.base64ToHex(s.data),this.typeOfHexView)),t+="\r\n",t)),"")},copySelected(e="view"){const t=this.getContentBySelected(e);this.copy(t,e)},exportSelected(e="view"){const t=this.getContentBySelected(e);this.exportData(t,e)}},created(){this.$store.state[this.moduleName]||this.$store.registerModule(this.moduleName,$t)},destroyed(){this.$store.commit(`${this.moduleName}/clean`),this.$store.dispatch(`${this.moduleName}/removePollingGetDevices`),this.$store.unregisterModule(this.moduleName)},watch:{active(){this.selectedMessages="",this.devicePreview=null}},mixins:[Ct["a"]],components:{Devices:De,Messages:ce,MessagePreviewItem:Pe,PacketView:Ae}},qt=kt,Mt=s("4e73"),Dt=s("1c1c"),_t=s("7f67"),St=Object(C["a"])(qt,l,r,!1,null,null,null),Tt=St.exports;T()(St,"components",{QToolbar:ne["a"],QIcon:D["a"],QToolbarTitle:le["a"],QBtn:ee["a"],QTooltip:q["a"],QMenu:Mt["a"],QList:Dt["a"],QSeparator:X["a"],QItem:k["a"],QItemSection:M["a"],QTimeline:He["a"]}),T()(St,"directives",{ClosePopup:_t["a"]});var It=s("a99a"),Nt=s("2f62"),Ht=s("286e"),zt={name:"PageTrafficViewer",props:["limit","isLoading","isVisibleToolbar","isNeedSelect","config","settings"],mixins:[Ht["a"]],data(){return{active:null,activeDevice:null,relatedDeviceId:null,isInit:!1,isItemsInit:!1,isItemsInitStart:!1,filter:"",prevEntity:null,isIntegration:this.$q.platform.within.iframe}},computed:n()(n()({},Object(Nt["d"])({tokenType(e){return e.tokenInfo&&e.tokenInfo.access?e.tokenInfo.access.type:-1},items(e){return Object.values(e.channels||{}).filter((t=>e.channelsProtocols[t.protocol_id].features.raw_packets))}})),{},{filteredItems(){const e=this.filter.toLowerCase(),t=this.filter?this.items.filter((t=>t&&"undefined"!==typeof t.name&&null!==t.name&&t.name.toLowerCase().indexOf(e)>=0||t&&"undefined"!==typeof t.id&&null!==t.id&&(t.id+"").indexOf(e)>=0)):this.items;return t.sort(((e,t)=>{if(!e.name)return-1;if(!t.name)return 1;const s=e.name.toLowerCase(),i=t.name.toLowerCase();return s<i?-1:1})),t},selectedItem(){return this.items.filter((e=>e.id===this.active))[0]||null},needShowBackToChannel(){return this.active&&(!this.isIntegration||this.isIntegration&&("channels"===this.prevEntity&&!this.isNeedSelect||this.isNeedSelect&&!("string"===typeof this.isNeedSelect&&this.isNeedSelect.indexOf("channels")>-1)))},needShowBackToDevice(){return this.active&&this.activeDevice&&this.relatedDeviceId&&(!this.isIntegration||this.isIntegration&&("devices"===this.prevEntity&&!this.isNeedSelect||this.isNeedSelect))}}),methods:{changeActiveDeviceHandler(e){this.setActiveDevice(e),this.active?this.activeDevice?this.$router.push(`/tools/traffic/${this.active}/ident/${e.ident}`).catch((e=>e)):this.$router.push(`/tools/traffic/${this.active}`).catch((e=>e)):this.$router.push("/tools/traffic").catch((e=>e))},unselect(){this.$refs.messages.unselect()},viewLogsHandler(){this.$router.push(`/channels/${this.active}`).catch((e=>e))},setActiveDevice(e){this.activeDevice=e,this.getRelatedDeviceId()},getRelatedDeviceId(){this.activeDevice?this.$connector.gw.getChannelProtocolsDeviceTypes(this.selectedItem.protocol_id,"all",{fields:"id"}).then((e=>{const t=u()(e,"data.result",[]);return t.map((e=>e.id))})).then((e=>{this.$connector.gw.getDevices(`configuration.ident=${this.activeDevice.ident}`,{fields:"id,device_type_id"}).then((t=>{const s=u()(t,"data.result",[]),i=s.reduce(((t,s)=>t||(e.includes(s.device_type_id)?s.id:t)),0);this.relatedDeviceId=i}))})):this.relatedDeviceId=null},goToDevice(){this.$router.push(`/devices/${this.relatedDeviceId}`).catch((e=>e))},init(){const e="tools/traffic",t=u()(this.settings,`entities[${e}]`,void 0);this.isInit=!0,this.$route.params&&this.$route.params.id?this.items.filter((e=>e.id===Number(this.$route.params.id))).length?(this.active=Number(this.$route.params.id),this.$route.params.ident&&this.setActiveDevice({ident:this.$route.params.ident})):this.active=null:t&&this.items.filter((e=>e.id===t)).length&&(this.active=t),this.$emit("inited")}},beforeRouteEnter(e,t,s){s((e=>{e.prevEntity=t.meta.moduleName}))},watch:{$route(e){e.params&&e.params.id?this.items.filter((t=>t.id===Number(e.params.id))).length?(this.active=Number(e.params.id),this.$route.params.ident&&this.setActiveDevice({ident:this.$route.params.ident})):this.isInit&&(this.active=null):e.params&&!e.params.id&&(this.active=null)},active(e){const t=this.items.filter((t=>t.id===e))[0]||{};e?(this.$emit("update:settings",{type:"ENTITY_CHANGE",opt:{entity:"tools/traffic"},value:t.id}),this.activeDevice?this.$router.push(`/tools/traffic/${e}/ident/${this.activeDevice.ident}`).catch((e=>e)):this.$router.push(`/tools/traffic/${e}`).catch((e=>e))):this.$router.push("/tools/traffic").catch((e=>e))}},components:{TrafficViewer:Tt,EntitiesToolbar:It["a"]}},Pt=zt,Ot=(s("8b7b"),s("9989")),Qt=s("8572"),Et=Object(C["a"])(Pt,i,a,!1,null,null,null);t["default"]=Et.exports;T()(Et,"components",{QPage:Ot["a"],QSelect:W["a"],QInput:J["a"],QIcon:D["a"],QItem:k["a"],QItemSection:M["a"],QItemLabel:_["a"],QBtn:ee["a"],QField:Qt["a"]})},2510:function(e,t,s){},2724:function(e,t,s){"use strict";s("ce46")},"3b24":function(e,t,s){},"8b7b":function(e,t,s){"use strict";s("2510")},a24e:function(e,t,s){"use strict";s("3b24")},aff9:function(e,t,s){"use strict";s("076c")},cb33:function(e,t,s){"use strict";s("efe3")},ce46:function(e,t,s){},efe3:function(e,t,s){}}]);