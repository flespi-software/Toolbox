(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"33b4":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",[i("q-resize-observer",{on:{resize:e.onResizePage}}),i("q-toolbar",{staticClass:"justify-between q-py-none bg-grey-9"},[i("div",{staticClass:"flex",staticStyle:{width:"75%"}},[i("div",{staticClass:"q-mr-sm",staticStyle:{display:"inline-flex"},style:{maxWidth:e.$q.platform.is.mobile?"48%":"40%"}},[i("q-select",{ref:"itemDeviceSelect",staticClass:"items__select",class:{"items__select--no-selected":!e.active},attrs:{value:e.active,options:e.filteredDevices,clearable:e.$q.platform.is.desktop&&!!e.activeCalcId,filled:"",label:e.active?void 0:"SELECT DEVICE",dark:"","hide-bottom-space":"",dense:"",color:"white",disable:!e.isNeedSelect||"string"===typeof e.isNeedSelect&&e.isNeedSelect.indexOf("devices")>-1||e.deviceBlocked,"hide-dropdown-icon":!e.isNeedSelect||"string"===typeof e.isNeedSelect&&e.isNeedSelect.indexOf("devices")>-1||e.deviceBlocked,"popup-content-class":"items__popup","popup-content-style":{height:48*(e.filteredDevices.length>6?6:e.filteredDevices.length)+48+(e.filteredDevices.length?0:34)+"px"}},on:{clear:e.clearDevice,filter:e.filterDevicesSelectItems},scopedSlots:e._u([{key:"no-option",fn:function(){return[i("div",{staticStyle:{"min-height":"77px"}},[i("q-input",{staticClass:"q-ma-xs",attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"Filter",autofocus:""},on:{input:function(t){return e.$refs.itemDeviceSelect.filter(t)}},model:{value:e.deviceFilter,callback:function(t){e.deviceFilter=t},expression:"deviceFilter"}},[i("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1),i("div",{staticClass:"text-center"},[e._v("No results")])],1)]},proxy:!0},{key:"selected-item",fn:function(t){return[i("q-item",e._g(e._b({staticClass:"q-pa-none",staticStyle:{"margin-top":"2px","max-width":"100%","min-height":"auto"}},"q-item",t.itemProps,!1),t.itemEvents),[i("q-item-section",[i("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-none text-white",attrs:{header:""}},[e._v(e._s(e.selectedDevice.name||"<noname>"))]),i("q-item-label",{staticClass:"q-pa-none q-mt-none text-white ellipsis",staticStyle:{"line-height":"0.75rem!important","margin-top":"1px"},attrs:{caption:""}},[i("small",[e._v(e._s(e.selectedDevice.configuration&&e.selectedDevice.configuration.ident?e.selectedDevice.configuration.ident:"<no ident>"))])])],1),e.$q.platform.is.desktop?i("q-item-section",{staticClass:"text-white",attrs:{side:""}},[i("q-item-label",{staticClass:"q-pa-none q-mt-none text-right"},[i("small",[e._v("#"+e._s(e.selectedDevice.id))])])],1):e._e()],1)]}},{key:"option",fn:function(t){return[i("q-item",e._g(e._b({staticClass:"q-pa-xs",class:{"text-grey-8":t.opt.deleted},attrs:{clickable:""},on:{click:function(i){e.active=t.opt.id}}},"q-item",t.itemProps,!1),t.itemEvents),[i("q-item-section",[i("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-xs",attrs:{header:""}},[e._v(e._s(t.opt.name||"<noname>"))]),i("q-item-label",{staticClass:"q-pa-none q-mt-none",staticStyle:{"line-height":"0.75rem!important","margin-top":"1px"},attrs:{caption:""}},[i("small",[e._v(e._s(t.opt.configuration&&t.opt.configuration.ident?t.opt.configuration.ident:"<no ident>"))])])],1),e.$q.platform.is.desktop?i("q-item-section",{attrs:{side:""}},[i("q-item-label",{staticClass:"q-pa-none q-mt-none text-right",class:{"q-pr-xs":e.$q.platform.is.mobile}},[i("small",[e._v("#"+e._s(t.opt.id))])])],1):e._e()],1)]}}])},[i("div",{staticClass:"bg-dark q-pa-xs select__filter",attrs:{slot:"before-options"},slot:"before-options"},[i("q-input",{attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"Filter",autofocus:""},on:{input:function(t){return e.$refs.itemDeviceSelect.filter(t)}},model:{value:e.deviceFilter,callback:function(t){e.deviceFilter=t},expression:"deviceFilter"}},[i("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1)],1),e.$q.platform.is.desktop?i("q-icon",{attrs:{slot:"prepend",name:"mdi-developer-board",color:"white"},slot:"prepend"}):e._e()],1)],1),i("div",{staticStyle:{display:"inline-flex"},style:{maxWidth:e.$q.platform.is.mobile?"48%":"40%"}},[i("q-select",{ref:"itemCalcSelect",staticClass:"items__select",class:{"items__select--no-selected":!e.activeCalcId},attrs:{value:e.activeCalcId,options:e.filteredCalcs,filled:"",clearable:e.$q.platform.is.desktop&&!!e.active,disable:!e.isNeedSelect||"string"===typeof e.isNeedSelect&&e.isNeedSelect.indexOf("calcs")>-1||e.calcsBlocked,"hide-dropdown-icon":!e.isNeedSelect||"string"===typeof e.isNeedSelect&&e.isNeedSelect.indexOf("calcs")>-1||e.calcsBlocked,label:e.activeCalcId?void 0:"SELECT CALC",dark:"","hide-bottom-space":"",dense:"",color:"white","popup-content-class":"items__popup","popup-content-style":{height:48*(e.filteredCalcs.length>6?6:e.filteredCalcs.length)+48+(e.filteredCalcs.length?0:34)+"px"}},on:{clear:e.clearCalc,filter:e.filterCalcsSelectItems},scopedSlots:e._u([{key:"no-option",fn:function(){return[i("div",{staticStyle:{"min-height":"77px"}},[i("q-input",{staticClass:"q-ma-xs",attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"Filter",autofocus:""},on:{input:function(t){return e.$refs.itemCalcSelect.filter(t)}},model:{value:e.calcFilter,callback:function(t){e.calcFilter=t},expression:"calcFilter"}},[i("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1),i("div",{staticClass:"text-center"},[e._v("No results")])],1)]},proxy:!0},{key:"selected-item",fn:function(t){return[e.selectedCalc?i("q-item",e._g(e._b({staticClass:"q-pa-none",staticStyle:{"min-height":"20px","margin-top":"2px","max-width":"100%"}},"q-item",t.itemProps,!1),t.itemEvents),[i("q-item-section",[i("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-none text-white",attrs:{header:""}},[e._v(e._s(e.selectedCalc.name||"<noname>"))])],1),e.$q.platform.is.desktop?i("q-item-section",{staticClass:"text-white",attrs:{side:""}},[i("q-item-label",{staticClass:"q-pa-none q-mt-none text-right"},[i("small",[e._v("#"+e._s(e.selectedCalc.id))])])],1):e._e()],1):e._e()]}},{key:"option",fn:function(t){return[i("q-item",e._g(e._b({staticClass:"q-pa-xs",class:{"text-grey-8":t.opt.deleted},attrs:{clickable:""},on:{click:function(i){return e.setActiveCalc(t.opt.id)}}},"q-item",t.itemProps,!1),t.itemEvents),[i("q-item-section",[i("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-xs",attrs:{header:""}},[e._v(e._s(t.opt.name||"<noname>"))])],1),e.$q.platform.is.desktop?i("q-item-section",{attrs:{side:""}},[i("q-item-label",{staticClass:"q-pa-none q-mt-none text-right",class:{"q-pr-xs":e.$q.platform.is.mobile}},[i("small",[e._v("#"+e._s(t.opt.id))])])],1):e._e()],1)]}}])},[i("div",{staticClass:"bg-dark q-pa-xs select__filter",attrs:{slot:"before-options"},slot:"before-options"},[i("q-input",{attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"Filter",autofocus:""},on:{input:function(t){return e.$refs.itemCalcSelect.filter(t)}},model:{value:e.calcFilter,callback:function(t){e.calcFilter=t},expression:"calcFilter"}},[i("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1)],1),e.$q.platform.is.desktop?i("q-icon",{attrs:{slot:"prepend",name:"mdi-calculator-variant",color:"white"},slot:"prepend"}):e._e()],1)],1)]),e.$q.platform.is.desktop?i("div",{staticClass:"flex justify-end",style:{width:72*e.actions.length+"px"}},[e._l(e.actions,(function(t,s){return[t.condition?i("transition",{key:s,attrs:{appear:"","enter-active-class":"animated bounceInDown","leave-active-class":"animated bounceOutUp"}},[i("q-btn",{staticClass:"on-left cursor-pointer pull-right text-center rounded-borders q-px-xs q-py-none text-white",staticStyle:{width:"60px"},attrs:{title:t.label,flat:"",dense:""},on:{click:t.handler}},[i("q-icon",{attrs:{size:"1.5rem",name:t.icon}}),i("div",{staticStyle:{"font-size":".7rem","line-height":".7rem"}},[e._v(e._s(t.label))])],1)],1):e._e()]}))],2):i("div",[e.hasActiveActions?i("q-btn",{attrs:{flat:"",icon:"mdi-dots-vertical",color:"white"}},[i("q-menu",[i("q-list",[e._l(e.actions,(function(t,s){return[t.condition?i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:s,attrs:{clickable:""},on:{click:t.handler}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:t.icon}})],1),i("q-item-section",[e._v(e._s(t.label))])],1):e._e()]}))],2)],1)],1):e._e()],1)]),i("div",[e.isInit?i("intervals",{ref:"intervals",style:Object.assign({},{height:"calc(50vh - "+(e.isVisibleToolbar?"50px":"25px")+")",position:"relative"},e.panelsWidgetsStyle),attrs:{activeId:e.activeCalcId,item:e.selectedCalc,activeDeviceId:e.active,limit:0,config:e.config.logs},on:{"action-view-data":function(t){return e.intervalWidgetsActions("object",t)},"action-map":function(t){return e.intervalWidgetsActions("track",t)},"action-show":function(t){return e.intervalWidgetsActions("show",t)},"action-select":function(t){return e.intervalWidgetsActions("select",t)},"in-messages":function(t){return e.viewedInterval=t},"change:date-range":function(t){e.dateRange=t,e.viewedInterval=null}}}):e._e(),e.isInit?i("messages",{ref:"messages",style:[{height:"calc(50vh - "+(e.isVisibleToolbar?"50px":"25px")+")",position:"relative"},e.panelsWidgetsStyle],attrs:{item:e.selectedDevice,interval:e.viewedInterval,dateRange:e.dateRange,activeId:e.active,limit:e.limit,config:e.config.messages},on:{"action-view-data":function(t){return e.messageWidgetsActions("object",t)},"action-map":function(t){return e.messageWidgetsActions("position",t)},"action-show":function(t){return e.messageWidgetsActions("show",t)},"action-image":function(t){return e.messageWidgetsActions("image",t)},"action-select":function(t){return e.messageWidgetsActions("select",t)}}}):e._e()],1),i("widgets",{ref:"messagesView",attrs:{active:"messagesView"===e.activeWidgetWindow,config:e.messageWidgetsViewConfig,actions:e.widgetsHandleActions,controls:e.widgetWindowControls,"view-model":e.widgetsViewModel.data},on:{"change-view-model":function(t){return e.widgetsChangeViewModelHandler(e.entityName,"data",t)},active:function(t){return e.activateWidgetWindow("messagesView")},close:e.unselect,next:e.nextWidgetsMessage,prev:e.prevWidgetsMessage},model:{value:e.isWidgetsMessageActive,callback:function(t){e.isWidgetsMessageActive=t},expression:"isWidgetsMessageActive"}}),i("widgets",{ref:"intervalsView",attrs:{active:"intervalsView"===e.activeWidgetWindow,config:e.intervalsWidgetsViewConfig,actions:e.widgetsHandleActions,controls:e.widgetWindowControls,"view-model":e.widgetsViewModel.data},on:{"change-view-model":function(t){return e.widgetsChangeViewModelHandler(e.entityName,"data",t)},active:function(t){return e.activateWidgetWindow("intervalsView")},close:e.unselect,next:e.nextWidgetsInterval,prev:e.prevWidgetsInterval},model:{value:e.isWidgetsIntervalsActive,callback:function(t){e.isWidgetsIntervalsActive=t},expression:"isWidgetsIntervalsActive"}})],1)},n=[],a=(i("8e6e"),i("8a81"),i("456d"),i("28a5"),i("c5f6"),i("7f7f"),i("6762"),i("2fdb"),i("ac6a"),i("cadf"),i("06db"),i("8615"),i("c47a")),c=i.n(a),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("virtual-scroll-list",{ref:"scrollList",attrs:{cols:e.cols,actions:e.actions,items:e.messages,dateRange:[e.begin,e.end],viewConfig:e.viewConfig,filter:e.filter,theme:e.theme,title:"Intervals",loading:e.loadingFlag,autoscroll:e.needAutoscroll,scrollOffset:"10%",i18n:e.i18n,item:e.listItem,itemprops:e.getItemsProps,toDefaultCols:e.toDefaultColsHandler},on:{action:e.actionHandler,"change-filter":e.filterChangeHandler,"change-date-range":e.dateRangeChangeHandler,"update-cols":e.updateColsHandler,"action-to-bottom":e.actionToBottomHandler}},[i("empty-pane",{attrs:{slot:"empty",config:e.config.emptyState},slot:"empty"})],1)],1)},r=[],l=i("4db1"),d=i.n(l),m=i("967e"),u=i.n(m),h=(i("96cf"),i("fa84")),f=i.n(h),g=i("de45"),v=i("2b0e"),p=i("cdde"),b=i("ef95"),w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:{height:e.itemHeight+"px",width:e.rowWidth+"px"},on:{click:function(t){return e.itemClickHandler(e.index,e.clearItem)}}},[e.item["__connectionStatus"]?i("div",{style:{height:e.itemHeight+"px",width:e.rowWidth+"px",border:"solid 1px #000",color:"#000",fontWeight:"bold",backgroundColor:"offline"===e.item.__connectionStatus?"#ff0":"#0f0",backgroundImage:"url(./statics/police.png)",overflow:"hidden",opacity:".7"},attrs:{title:e.date.formatDate(1e3*e.item.timestamp,"DD/MM/YYYY HH:mm:ss")}},e._l(Array(10),(function(t){return i("span",{key:t,staticClass:"text-uppercase",staticStyle:{padding:"0 5px","margin-left":"150px"},style:{backgroundColor:"offline"===e.item.__connectionStatus?"#ff0":"#0f0"}},[e._v("\n    "+e._s(e.item["__connectionStatus"])+"\n  ")])})),0):i("div",{staticClass:"cursor-pointer",class:[e.item["x-flespi-status"]?"missed-items":"",e.highlighted?"bg-purple-9":""],style:{height:e.itemHeight+"px",width:e.rowWidth+"px",backgroundColor:e.selected?"rgba(255,255,255,0.7)":"",color:e.selected&&!e.highlighted?"#333":""}},[e._l(e.cols,(function(t,s){var n,a;return["etc"===t.__dest?i("span",{key:t.name+s,staticClass:"list__item item_etc",class:(n={},n["item_"+s]=!0,n["item--active"]=e.menuCellActive&&e.menuCellActive.row===e.index&&e.menuCellActive.col===s,n)},[e._v(e._s(e.values.etc.value||"*Empty*"))]):i("span",{key:t.name+s,staticClass:"list__item",class:(a={},a["item_"+s]=!0,a["item--active"]=e.menuCellActive&&e.menuCellActive.row===e.index&&e.menuCellActive.col===s,a),attrs:{title:e.values[t.name].value}},[e._v("\n        "+e._s(e.values[t.name].value)+"\n      ")])]}))],2)])},x=[],y=(i("4917"),i("bd4c")),$={props:["item","index","actions","cols","itemHeight","rowWidth","selected","highlighted","menuCellActive"],data:function(){return{date:y["a"]}},computed:{values:function(){var e=this,t={};return t=this.cols.length?this.cols.reduce((function(t,i,s,n){return t[i.name]={value:e.getValueOfProp(i,e.item)},s===n.length-1&&(t.etc={value:""}),t}),{}):{etc:{value:""}},Object.keys(this.item).forEach((function(i){if(!t[i]){if(-1!==i.indexOf("x-flespi"))return!1;-1!==i.indexOf("image.bin.")?t.etc.value+="".concat(i,": <binary image>"):t.etc.value+="".concat(i,": ").concat(JSON.stringify(e.item[i]),"; ")}})),t},clearItem:function(){var e=this;return Object.keys(this.item).reduce((function(t,i){return t[i]=e.item[i],t}),{})}},methods:{clickHandler:function(e,t,i){this.$emit("action",{index:e,type:t,content:i})},itemClickHandler:function(e,t){this.$emit("item-click",{index:e,content:t})},getValueOfProp:function(e,t){var i=e.name,s=t[i];return i.match(/timestamp$/)||"begin"===i||"end"===i?s=y["a"].formatDate(1e3*s,"DD/MM/YYYY HH:mm:ss"):-1!==i.indexOf("image.bin.")&&(s="<binary image>"),"string"!==typeof s&&(s=JSON.stringify(s)),s}}},C=$,N=(i("e439"),i("2877")),k=Object(N["a"])(C,w,x,!1,null,null,null),_=k.exports,I=i("121a"),S={props:["item","activeId","activeDeviceId","limit","config"],data:function(){return{listItem:_,theme:this.config.theme,viewConfig:this.config.viewConfig,moduleName:this.config.vuexModuleName,autoscroll:!0,viewedInterval:null,actions:this.config.actions,i18n:{"Columns by schema":"Columns by counters"}}},computed:{messages:{get:function(){var e=this.$store.state[this.moduleName].messages;return e=Object.values(e),e.sort((function(e,t){return e.begin-t.begin})),this.normalizeSelected(e),e},set:function(e){this.$store.commit("".concat(this.moduleName,"/setMessages"),e)}},active:{get:function(){return this.$store.state[this.moduleName].active},set:function(e){var t=this;return f()(u.a.mark((function i(){return u.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.$store.dispatch("".concat(t.moduleName,"/unsubscribePooling"));case 2:return t.$store.commit("".concat(t.moduleName,"/setActive"),e),t.$store.commit("".concat(t.moduleName,"/clearMessages")),e&&t.$store.dispatch("".concat(t.moduleName,"/getCols"),t.item.counters),i.next=7,t.$store.dispatch("".concat(t.moduleName,"/initTime"));case 7:return t.$emit("change:date-range",[t.begin,t.end]),i.next=10,t.$store.dispatch("".concat(t.moduleName,"/get"));case 10:t.$store.dispatch("".concat(t.moduleName,"/pollingGet"));case 11:case"end":return i.stop()}}),i)})))()}},activeDevice:{get:function(){return this.$store.state[this.moduleName].activeDevice},set:function(e){var t=this;return f()(u.a.mark((function i(){return u.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.$store.dispatch("".concat(t.moduleName,"/unsubscribePooling"));case 2:return t.$store.commit("".concat(t.moduleName,"/setActiveDevice"),e),t.$store.commit("".concat(t.moduleName,"/clearMessages")),i.next=6,t.$store.dispatch("".concat(t.moduleName,"/initTime"));case 6:return t.$emit("change:date-range",[t.begin,t.end]),i.next=9,t.$store.dispatch("".concat(t.moduleName,"/get"));case 9:t.$store.dispatch("".concat(t.moduleName,"/pollingGet"));case 10:case"end":return i.stop()}}),i)})))()}},cols:{get:function(){return this.$store.state[this.moduleName].cols},set:function(e){this.$store.commit("".concat(this.moduleName,"/updateCols"),e)}},filter:{get:function(){return this.$store.state[this.moduleName].filter},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setFilter"),e):this.$store.commit("".concat(this.moduleName,"/setFilter"),"")}},begin:{get:function(){return this.$store.state[this.moduleName].begin},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setBegin"),e):this.$store.commit("".concat(this.moduleName,"/setBegin"),0)}},end:{get:function(){return this.$store.state[this.moduleName].end},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setEnd"),e):this.$store.commit("".concat(this.moduleName,"/setEnd"),0)}},reverse:{get:function(){return this.$store.state[this.moduleName].reverse||!1},set:function(e){this.$store.commit("".concat(this.moduleName,"/setReverse"),e)}},currentLimit:{get:function(){return this.$store.state[this.moduleName].limit},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setLimit"),e):this.$store.commit("".concat(this.moduleName,"/setLimit"),0)}},selected:{get:function(){var e=this.$store.state[this.moduleName].selected;return e&&!e.length&&this.$emit("view-data",null),e},set:function(e){this.$store.commit("".concat(this.moduleName,"/setSelected"),e)}},loadingFlag:function(){var e=this.$store.state;return!(!e[this.config.vuexModuleName]||!e[this.config.vuexModuleName].isLoading)},needAutoscroll:function(){return!this.selected.length&&this.autoscroll},routesFields:function(){var e=this.item.counters&&this.item.counters.filter((function(e){return"route"===e.type}));return e||[]}},methods:{getItemsProps:function(e,t){var i=this,s=this.messages[e];t.key=s["x-flespi-message-key"],t.props.etcVisible=this.etcVisible,t.props.actionsVisible=this.actionsVisible,t.props.selected=this.selected.includes(e),t.props.highlighted=this.viewedInterval&&s.id===this.viewedInterval.id,this.routesFields.some((function(e){return!!s[e.name]}))&&(t.props.actions=[].concat(d()(t.props.actions),[{icon:"mdi-map",label:"Show on map",classes:"",type:"map"}])),t.on||(t.on={}),t.on.action=this.actionHandler,t.on["item-click"]=this.viewMessagesAndShowInMessagesHandler,t.dataHandler=function(e,t,s){return i.autoscroll=!1,i.listItem.methods.getValueOfProp(e.data,t.data)}},resetParams:function(){this.$refs.scrollList.resetParams()},filterChangeHandler:function(e){this.filter!==e&&(this.filter=e,this.$store.commit("".concat(this.moduleName,"/clearMessages")),this.$store.dispatch("".concat(this.moduleName,"/get")))},updateColsHandler:function(e){this.cols=e},dateRangeChangeHandler:function(e){var t=e[0],i=e[1];if(this.begin===t&&this.end===i)return!1;this.begin=t,this.end=i,this.$emit("change:date-range",e),this.viewedInterval=null,this.$store.commit("".concat(this.moduleName,"/clearMessages")),this.$store.dispatch("".concat(this.moduleName,"/get"))},actionHandler:function(e){var t=e.index,i=e.type,s=e.content;switch(this.selected=[t],i){case"view":this.viewMessagesHandler({index:t,content:s,entity:this.item});break;case"copy":this.copyMessageHandler({index:t,content:s,entity:this.item});break;default:this.$emit("action-".concat(i),{index:t,content:s,entity:this.item});break}},actionToBottomHandler:function(){this.autoscroll=!0,this.$refs.scrollList.scrollTo(this.messages.length-1)},viewMessagesAndShowInMessagesHandler:function(e){var t=e.index,i=e.content;this.viewMessagesHandler({index:t,content:i,entity:this.item}),this.inMessagesHandler({index:t,content:i})},viewMessagesHandler:function(e){var t=e.index,i=e.content;this.selected=[t],this.$emit("action-view-data",{index:t,content:i,entity:this.item})},inMessagesHandler:function(e){e.index;var t=e.content;this.viewedInterval=t,this.$emit("in-messages",this.viewedInterval)},copyMessageHandler:function(e){var t=this,i=(e.index,e.content);Object(p["a"])(JSON.stringify(i)).then((function(e){t.$q.notify({type:"positive",icon:"content_copy",message:"Message copied",timeout:1e3})}),(function(e){t.$q.notify({type:"negative",icon:"content_copy",message:"Error coping messages",timeout:1e3})}))},unselect:function(){this.selected.length&&(this.viewedInterval=null,this.selected=[])},normalizeSelected:function(e){if(this.selected&&this.selected.length&&!this.viewedInterval){var t=this.selected[0],i=e[t];this.viewMessagesHandler({index:t,content:i,entity:this.item})}},toDefaultColsHandler:function(){this.$store.commit("".concat(this.moduleName,"/setDefaultCols"))},scrollTo:function(e){var t=this;this.$nextTick((function(){return t.$refs.scrollList&&t.$refs.scrollList.scrollTo(e)}))},clearMessage:function(e){return Object.keys(e).reduce((function(t,i){return-1!==i.indexOf("x-flespi")||(t[i]=e[i]),t}),{})},nextSelect:function(){if(this.selected.length){var e=this.selected.slice(-1)[0],t=e+1,i=this.messages[t];if(i){this.selected=[t];var s=this.clearMessage(i);this.$emit("action-select",{index:t,content:s,entity:this.item}),this.inMessagesHandler({index:t,content:s}),this.scrollTo(t)}}},prevSelect:function(){if(this.selected.length){var e=this.selected[0],t=e-1,i=this.messages[t];if(i){this.selected=[t];var s=this.clearMessage(i);this.$emit("action-select",{index:t,content:s,entity:this.item}),this.inMessagesHandler({index:t,content:s}),this.scrollTo(t)}}}},watch:{activeId:function(e){this.active=e},activeDeviceId:function(e){this.activeDevice=e},limit:function(e){this.currentLimit=e}},created:function(){var e=this;this.$store.state[this.moduleName]?this.$store.commit("".concat(this.moduleName,"/clear")):this.$store.registerModule(this.moduleName,Object(g["e"])({Vue:v["default"],LocalStorage:this.$q.localStorage,name:{name:this.moduleName,lsNamespace:"flespi-toolbox-settings.cols"},errorHandler:function(t){e.$store.commit("reqFailed",t)},filterHandler:this.filterMessages})),this.currentLimit=this.limit,this.activeId&&(this.$store.commit("".concat(this.moduleName,"/setActive"),this.activeId),this.$store.dispatch("".concat(this.moduleName,"/getCols"),this.item.counters)),this.activeDeviceId&&this.$store.commit("".concat(this.moduleName,"/setActiveDevice"),this.activeDeviceId),this.$store.dispatch("".concat(this.moduleName,"/initTime")).then((function(){e.$emit("change:date-range",[e.begin,e.end]),e.$store.dispatch("".concat(e.moduleName,"/get")),e.$store.dispatch("".concat(e.moduleName,"/pollingGet"))})),this.offlineHandler=v["default"].connector.socket.on("offline",(function(){e.$store.commit("".concat(e.moduleName,"/setOffline"),!0)})),this.connectHandler=v["default"].connector.socket.on("connect",(function(){e.$store.state[e.moduleName].offline&&e.$store.commit("".concat(e.moduleName,"/setReconnected"),!0)}))},beforeDestroy:function(){this.$store.dispatch("".concat(this.moduleName,"/unsubscribePooling")),void 0!==this.offlineHandler&&v["default"].connector.socket.off("offline",this.offlineHandler),void 0!==this.connectHandler&&v["default"].connector.socket.off("connect",this.connectHandler),this.$store.commit("".concat(this.moduleName,"/clear")),this.$store.commit("".concat(this.moduleName,"/setActive"),null),this.$store.commit("".concat(this.moduleName,"/setActiveDevice"),null)},mixins:[b["a"]],components:{VirtualScrollList:g["b"],EmptyPane:I["a"]}},H=S,q=Object(N["a"])(H,o,r,!1,null,null,null),M=q.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("virtual-scroll-list",{ref:"scrollList",attrs:{cols:e.cols,actions:e.actions,items:e.messages,dateRange:e.dateRange,viewConfig:e.viewConfig,filter:e.filter,theme:e.theme,title:"Messages",loading:e.loadingFlag,autoscroll:e.needAutoscroll,i18n:e.i18n,scrollOffset:"10%",item:e.listItem,itemprops:e.getItemsProps,toDefaultCols:e.toDefaultColsHandler},on:{action:e.actionHandler,"change-filter":e.filterChangeHandler,"scroll-top":e.paginationPrevChangeHandler,"scroll-bottom":e.paginationNextChangeHandler,"action-to-bottom":e.actionToBottomHandler,"update-cols":e.updateColsHandler}},[i("empty-pane",{attrs:{slot:"empty",config:e.config.emptyState},slot:"empty"})],1)],1)},W=[],A=(i("551c"),i("5df3"),i("20d6"),i("6b54"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:{height:e.itemHeight+"px",width:e.rowWidth+"px"},on:{click:function(t){return e.itemClickHandler(e.index,e.clearItem)}}},[e.item["__connectionStatus"]?i("div",{style:{height:e.itemHeight+"px",width:e.rowWidth+"px",border:"solid 1px #000",color:"#000",fontWeight:"bold",backgroundColor:"offline"===e.item.__connectionStatus?"#ff0":"#0f0",backgroundImage:"url(./statics/police.png)",overflow:"hidden",opacity:".7"},attrs:{title:e.date.formatDate(1e3*e.item.timestamp,"DD/MM/YYYY HH:mm:ss")}},e._l(Array(10),(function(t){return i("span",{key:t,staticClass:"text-uppercase",staticStyle:{padding:"0 5px","margin-left":"150px"},style:{backgroundColor:"offline"===e.item.__connectionStatus?"#ff0":"#0f0"}},[e._v("\n    "+e._s(e.item["__connectionStatus"])+"\n  ")])})),0):i("div",{staticClass:"cursor-pointer",class:[e.item["x-flespi-status"]?"missed-items":"",e.highlighted?"bg-purple-9":"",e.selected?"bg-white-opasity":e.highlightLevel?"text-"+e.highlightType+"-"+e.highlightLevel:""],style:{height:e.itemHeight+"px",width:e.rowWidth+"px",color:e.selected?"#333":""}},[e._l(e.cols,(function(t,s){var n,a;return["etc"===t.__dest?i("span",{key:t.name+s,staticClass:"list__item item_etc",class:(n={},n["item_"+s]=!0,n["item--active"]=e.menuCellActive&&e.menuCellActive.row===e.index&&e.menuCellActive.col===s,n)},[e._v(e._s(e.values.etc.value||"*Empty*"))]):i("span",{key:t.name+s,staticClass:"list__item",class:(a={},a["item_"+s]=!0,a["item--active"]=e.menuCellActive&&e.menuCellActive.row===e.index&&e.menuCellActive.col===s,a),attrs:{title:e.values[t.name].value}},[e._v("\n        "+e._s(e.values[t.name].value)+"\n      ")])]}))],2)])}),D=[],P={props:["item","index","actions","cols","itemHeight","rowWidth","selected","highlighted","menuCellActive"],data:function(){var e=0,t="";return this.item.timestamp<this.item["server.timestamp"]-1800?(t="orange",e=10):this.item.timestamp<this.item["server.timestamp"]-600?(t="orange",e=7):this.item.timestamp<this.item["server.timestamp"]-120?(t="orange",e=4):this.item.timestamp-1>this.item["server.timestamp"]?(t="grey",e=6):this.item.timestamp-60>this.item["server.timestamp"]?(t="grey",e=8):this.item.timestamp-1800>this.item["server.timestamp"]&&(t="grey",e=10),{highlightType:t,highlightLevel:e,date:y["a"]}},computed:{values:function(){var e=this,t={};return t=this.cols.length?this.cols.reduce((function(t,i,s,n){return t[i.name]={value:e.getValueOfProp(i,e.item)},s===n.length-1&&(t.etc={value:""}),t}),{}):{etc:{value:""}},Object.keys(this.item).forEach((function(i){if(!t[i]){if(-1!==i.indexOf("x-flespi"))return!1;-1!==i.indexOf("image.bin.")?t.etc.value+="".concat(i,": <binary image>"):t.etc.value+="".concat(i,": ").concat(JSON.stringify(e.item[i]),"; ")}})),t},clearItem:function(){var e=this;return Object.keys(this.item).reduce((function(t,i){return-1!==i.indexOf("x-flespi")||(t[i]=e.item[i]),t}),{})}},methods:{clickHandler:function(e,t,i){this.$emit("action",{index:e,type:t,content:i})},itemClickHandler:function(e,t){this.$emit("item-click",{index:e,content:t})},getValueOfProp:function(e,t){var i=e.name,s=t[i];return i.match(/timestamp$/)&&(s=y["a"].formatDate(1e3*s,"DD/MM/YYYY HH:mm:ss")),-1!==i.indexOf("image.bin.")&&(s="<binary image>"),"string"!==typeof s&&(s=JSON.stringify(s)),s}}},j=P,V=(i("a846"),Object(N["a"])(j,A,D,!1,null,null,null)),T=V.exports,L={props:["item","activeId","interval","dateRange","limit","config"],data:function(){return{listItem:T,theme:this.config.theme,viewConfig:this.config.viewConfig,actions:this.config.actions,autoscroll:!0,moduleName:this.config.vuexModuleName,i18n:{"Columns by schema":"Columns by protocol"}}},computed:{messages:{get:function(){var e=this.$store.state[this.moduleName].messages;return this.scrollControlling(e.length),e},set:function(e){this.$store.commit("".concat(this.moduleName,"/setMessages"),e)}},intervals:function(){return this.$store.state[this.moduleName].messages},active:{get:function(){return this.$store.state[this.moduleName].active},set:function(e){var t=this;return f()(u.a.mark((function i(){return u.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.$store.dispatch("".concat(t.moduleName,"/unsubscribePooling"));case 2:return t.$store.commit("".concat(t.moduleName,"/setActive"),e),t.$store.commit("".concat(t.moduleName,"/clearMessages")),i.next=6,t.$store.dispatch("".concat(t.moduleName,"/getCols"),{etc:!0});case 6:return i.next=8,t.getMessages();case 8:case"end":return i.stop()}}),i)})))()}},cols:{get:function(){return this.$store.state[this.moduleName].cols},set:function(e){this.$store.commit("".concat(this.moduleName,"/updateCols"),e)}},filter:{get:function(){return this.$store.state[this.moduleName].filter},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setFilter"),e):this.$store.commit("".concat(this.moduleName,"/setFilter"),"")}},from:{get:function(){return this.$store.state[this.moduleName].from},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setFrom"),e):this.$store.commit("".concat(this.moduleName,"/setFrom"),0)}},to:{get:function(){return this.$store.state[this.moduleName].to},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setTo"),e):this.$store.commit("".concat(this.moduleName,"/setTo"),0)}},realtimeEnabled:function(){return this.$store.state[this.moduleName].realtimeEnabled},reverse:{get:function(){return this.$store.state[this.moduleName].reverse||!1},set:function(e){this.$store.commit("".concat(this.moduleName,"/setReverse"),e)}},currentLimit:{get:function(){return this.$store.state[this.moduleName].limit},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setLimit"),e):this.$store.commit("".concat(this.moduleName,"/setLimit"),1e3)}},selected:{get:function(){return this.$store.state[this.moduleName].selected},set:function(e){e&&e.length&&(this.autoscroll=!1),this.$store.commit("".concat(this.moduleName,"/setSelected"),e)}},loadingFlag:function(){var e=this.$store.state;return!(!e[this.config.vuexModuleName]||!e[this.config.vuexModuleName].isLoading)},needAutoscroll:function(){return this.realtimeEnabled&&!this.selected.length&&this.autoscroll}},methods:{getItemsProps:function(e,t){var i=this,s=this.messages[e];t.key=s["x-flespi-message-key"],t.props.etcVisible=this.etcVisible,t.props.actionsVisible=this.actionsVisible,t.props.selected=this.selected.includes(e);var n=Math.floor(s.timestamp);t.props.highlighted=this.interval&&n>=this.interval.begin&&n<=this.interval.end,s["position.latitude"]&&s["position.longitude"]&&(t.props.actions=[].concat(d()(t.props.actions),[{icon:"mdi-map",label:"Show on map",classes:"",type:"map"}])),Object.keys(s).some((function(e){var i=s[e].toString().match(/^data:image\/(?:gif|png|jpeg|bmp|webp)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/)||0===e.indexOf("image.bin.");return i&&(t.props.actions=[].concat(d()(t.props.actions),[{icon:"mdi-image-outline",label:"Show image",classes:"",type:"image"}])),i})),t.on||(t.on={}),t.on.action=this.actionHandler,t.on["item-click"]=this.viewMessagesHandler,t.dataHandler=function(e,t,s){return i.autoscroll=!1,i.listItem.methods.getValueOfProp(e.data,t.data)}},scrollTo:function(e){var t=this;this.$nextTick((function(){return t.$refs.scrollList&&t.$refs.scrollList.scrollTo(e)}))},scrollToWithSavePadding:function(e){var t=this;this.$nextTick((function(){return t.$refs.scrollList&&t.$refs.scrollList.scrollToWithSavePadding(e)}))},getMessages:function(){var e=this;return f()(u.a.mark((function t(){return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.to<=Date.now())){t.next=5;break}return t.next=3,e.$store.dispatch("".concat(e.moduleName,"/get"));case 3:t.next=8;break;case 5:return t.next=7,e.$store.dispatch("".concat(e.moduleName,"/getHistory"),1e3);case 7:e.scrollTo(e.messages.length-1);case 8:case"end":return t.stop()}}),t)})))()},resetParams:function(){this.$refs.scrollList.resetParams()},filterChangeHandler:function(e){this.filter!==e&&(this.filter=e,this.$store.commit("".concat(this.moduleName,"/clearMessages")),this.getMessages())},updateColsHandler:function(e){this.cols=e},dateRangeChangeHandler:function(e){var t=e[0],i=e[1];if(this.from===t&&this.to===i)return!1;this.from=t,this.to=i,this.$store.commit("".concat(this.moduleName,"/clearMessages")),this.getMessages()},paginationPrevChangeHandler:function(){var e=this;this.$store.dispatch("".concat(this.moduleName,"/getPrevPage")).then((function(t){t&&"number"===typeof t&&e.scrollToWithSavePadding(t)}))},paginationNextChangeHandler:function(){var e=this;this.$store.dispatch("".concat(this.moduleName,"/getNextPage")).then((function(t){e.autoscroll=!0,t&&"number"===typeof t&&e.scrollTo(e.messages.length-t)}))},showMessagesByInterval:function(){var e=this;return f()(u.a.mark((function t(){var i,s,n,a,c,o,r,l;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=e.interval,i){t.next=3;break}return t.abrupt("return");case 3:if(s=e.messages.findIndex((function(e){return e.timestamp===i.begin})),-1===s){t.next=8;break}e.scrollTo(s-1),t.next=31;break;case 8:return e.$store.state[e.moduleName].messages=[],t.next=11,e.$store.dispatch("".concat(e.moduleName,"/getMessages"),{from:i.begin,to:i.end,count:e.limit});case 11:if(n=t.sent,a=Math.ceil((e.limit-n.length)/2),c=0,!(n.length<e.limit)){t.next=26;break}return t.next=17,Promise.all([e.$store.dispatch("".concat(e.moduleName,"/getMessages"),{from:Math.floor(e.from/1e3),to:i.begin-1,count:a,reverse:!0}),e.$store.dispatch("".concat(e.moduleName,"/getMessages"),{from:i.end+1,to:Math.floor(e.to/1e3),count:a})]);case 17:return o=t.sent,r=o[0].reverse(),l=o[1],n.splice.apply(n,[0,0].concat(d()(r))),c=r.length,n.splice.apply(n,[n.length,0].concat(d()(l))),t.next=24,e.$store.dispatch("".concat(e.moduleName,"/unsubscribePooling"));case 24:t.next=28;break;case 26:return t.next=28,e.$store.dispatch("".concat(e.moduleName,"/unsubscribePooling"));case 28:e.$store.state[e.moduleName].pages=[n.length],e.$store.commit("".concat(e.moduleName,"/setHistoryMessages"),n),e.scrollTo(c);case 31:case"end":return t.stop()}}),t)})))()},actionHandler:function(e){var t=e.index,i=e.type,s=e.content;switch(this.selected=[t],i){case"view":this.viewMessagesHandler({index:t,content:s});break;case"copy":this.copyMessageHandler({index:t,content:s});break;default:this.$emit("action-".concat(i),{index:t,content:s});break}},viewMessagesHandler:function(e){var t=e.index,i=e.content;this.selected=[t],this.$emit("action-view-data",{index:t,content:i})},copyMessageHandler:function(e){var t=this,i=(e.index,e.content);Object(p["a"])(JSON.stringify(i)).then((function(e){t.$q.notify({type:"positive",icon:"content_copy",message:"Message copied",timeout:1e3})}),(function(e){t.$q.notify({type:"negative",icon:"content_copy",message:"Error coping messages",timeout:1e3})}))},actionToBottomHandler:function(){var e=this;this.realtimeEnabled?(this.autoscroll=!0,this.scrollTo(this.messages.length-1)):this.$store.dispatch("".concat(this.moduleName,"/getHistory"),1e3).then((function(){e.scrollTo(e.messages.length-1)}))},unselect:function(){this.selected.length&&(this.selected=[])},toDefaultColsHandler:function(){this.$store.commit("".concat(this.moduleName,"/setDefaultCols"))},scrollControlling:function(e){this.selected.length&&this.selected[0]+1e3<=e&&this.$store.dispatch("".concat(this.moduleName,"/unsubscribePooling"))},clearMessage:function(e){return Object.keys(e).reduce((function(t,i){return-1!==i.indexOf("x-flespi")||(t[i]=e[i]),t}),{})},nextSelect:function(){if(this.selected.length){var e=this.selected.slice(-1)[0],t=e+1,i=this.messages[t];i&&(this.selected=[t],this.$emit("action-select",{index:t,content:this.clearMessage(i)}),this.scrollTo(t))}},prevSelect:function(){if(this.selected.length){var e=this.selected[0],t=e-1,i=this.messages[t];i&&(this.selected=[t],this.$emit("action-select",{index:t,content:this.clearMessage(i)}),this.scrollTo(t))}}},watch:{activeId:function(e){this.active=e},limit:function(e){this.currentLimit=e},dateRange:function(e){this.dateRangeChangeHandler(e)},interval:function(){this.showMessagesByInterval()}},created:function(){var e=this;this.$store.state[this.moduleName]?this.$store.commit("".concat(this.moduleName,"/clear")):this.$store.registerModule(this.moduleName,Object(g["d"])({Vue:v["default"],LocalStorage:this.$q.localStorage,name:{name:this.moduleName,lsNamespace:"flespi-toolbox-settings.cols"},errorHandler:function(t){e.$store.commit("reqFailed",t)},filterHandler:this.filterMessages})),this.currentLimit=this.limit,this.activeId&&(this.active=this.activeId),this.offlineHandler=v["default"].connector.socket.on("offline",(function(){e.$store.commit("".concat(e.moduleName,"/setOffline"),e.realtimeEnabled)})),this.connectHandler=v["default"].connector.socket.on("connect",(function(){e.$store.state[e.moduleName].offline&&(e.$store.commit("".concat(e.moduleName,"/setReconnected"),e.realtimeEnabled),e.realtimeEnabled&&e.$store.dispatch("".concat(e.moduleName,"/getMissedMessages")))}))},beforeDestroy:function(){this.$store.dispatch("".concat(this.moduleName,"/unsubscribePooling")),void 0!==this.offlineHandler&&v["default"].connector.socket.off("offline",this.offlineHandler),void 0!==this.connectHandler&&v["default"].connector.socket.off("connect",this.connectHandler),this.$store.commit("".concat(this.moduleName,"/clear"))},mixins:[b["a"]],components:{VirtualScrollList:g["b"],EmptyPane:I["a"]}},E=L,F=Object(N["a"])(E,O,W,!1,null,null,null),B=F.exports,R=i("df1d"),Y=i("6512"),z=i("9b02"),J=i.n(z),G=i("3a57"),U=i("b57c"),Z=i("0860");function K(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Q(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?K(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):K(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var X={data:function(){return{isWidgetsIntervalsActive:!1,widgetsViewedInterval:null}},computed:{filedsMetaData:function(){return this.$store.state[this.config.logs.vuexModuleName].cols.reduce((function(e,t){return t.display&&e.push(t.name),e}),[])},intervalsWidgetsViewConfig:function(){var e={};if(this.widgetsViewedInterval){var t=this.widgetsViewedInterval.content,i=this.widgetsViewedInterval.entity,s=i.counters&&i.counters.filter((function(e){return"route"===e.type&&t[e.name]})).length;s&&(e.track={title:"Track",wrapper:Z["a"]});var n="".concat(t.ident?'<div style="font-size: 1.1rem">'.concat(t.ident,"</div>"):"").concat(t.timestamp?'<div style="font-size: .8rem">'.concat(y["a"].formatDate(1e3*t.timestamp,"DD/MM/YYYY HH:mm:ss"),"</div>"):"");e.message={title:"JSON",description:n,wrapper:G["a"],data:t},e.object={title:"Fields",description:n,wrapper:U["a"],data:t,meta:this.filedsMetaData,action:this.intervalsWidgetActionHandler}}return e}},methods:{setWidgetsIntervalView:function(e){var t=this,i=e.content,s=e.entity;this.widgetsViewedInterval={content:Q({},i),entity:s};var n=s.counters&&s.counters.filter((function(e){return"route"===e.type})),a=Object.keys(i).reduce((function(e,t){return n.filter((function(e){return e.name===t})).length&&e.push(i[t]),e}),[]);this.isWidgetsIntervalsActive||(this.beforeEnableWidgetByPane&&this.beforeEnableWidgetByPane("intervals"),this.isWidgetsIntervalsActive=!0),this.$nextTick((function(){var e=t.$refs.intervalsView.ref("track");e&&e.clear().autobounds(!0).addRoutes(a).send()})),this.activateWidgetWindow("intervalsView")},intervalWidgetsActions:function(e,t){var i=this.isWidgetsMessageActive;this.setWidgetsIntervalView(t);var s=this.$refs.intervalsView;switch(e){case"track":s.setTab(e);break;case"show":s.setTab("message");break;case"object":i||s.setTab("object");break;case"select":break}},closeIntervalsWidgetsHandler:function(){this.$refs.intervals&&this.$refs.intervals.unselect()},nextWidgetsInterval:function(){this.$refs.intervals.nextSelect()},prevWidgetsInterval:function(){this.$refs.intervals.prevSelect()},intervalsWidgetActionHandler:function(e){var t=e.type,i=e.data,s=J()(this.$refs.intervals.$refs,"scrollList",void 0);if(s)switch(t){case"col-add":s.addCustomColumnHandler(i);break;case"col-remove":s.removeCustomColumnHandler(i);break}}}},ee=i("5c16"),te=i("2f62"),ie=i("286e");function se(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function ne(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?se(Object(i),!0).forEach((function(t){c()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):se(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ae={props:["limit","isLoading","isVisibleToolbar","isNeedSelect","config","settings"],mixins:[ie["a"],R["a"],Y["a"],X],data:function(){return{entityName:"intervals",calcFilter:"",deviceFilter:"",active:null,activeCalcId:null,ratio:50,isInit:!1,isItemsInit:!1,isDevicesInit:!1,isCalcsInit:!1,deviceBlocked:!1,calcsBlocked:!1,viewedInterval:null,dateRange:[0,0],blocked:""}},computed:ne(ne({},Object(te["d"])({tokenType:function(e){return e.tokenInfo&&e.tokenInfo.access?e.tokenInfo.access.type:-1},devicesCollection:function(e){return e.devices||{}},tasksCollection:function(e){return e.tasks||{}},calcsCollection:function(e){return e.calcs||{}},sessionSettings:function(e){return e.sessionSettings}})),{},{devices:function(){return Object.values(this.devicesCollection)},tasks:function(){var e=Object.values(this.tasksCollection);return e},calcs:function(){return Object.values(this.calcsCollection)},selectedDevice:function(){return this.devicesCollection[this.active]||{}},selectedCalc:function(){return this.calcsCollection[this.activeCalcId]?this.calcsCollection[this.activeCalcId]:{}},filteredDevices:function(){var e=this.devices,t=this.tasks.map((function(e){return e.device_id}));return e=e.filter((function(e){return t.includes(e.id)})),this.filterItems(e,this.deviceFilter.toLowerCase())},filteredCalcs:function(){var e=this,t=this.calcs;return t=this.active?t.filter((function(t){return e.tasks.some((function(i){return e.active===i.device_id&&t.id===i.calc_id}))})):t,this.isInit&&this.active&&this.activeCalcId&&!this.tasks.filter((function(t){return t.device_id===e.active&&t.calc_id===e.activeCalcId})).length&&this.$nextTick((function(){e.clearActiveCalc()})),this.filterItems(t,this.calcFilter.toLowerCase())},size:function(){return[this.ratio,100-this.ratio]},hasActiveActions:function(){return this.actions.reduce((function(e,t){return e||t&&t.condition}),!1)},actions:function(){return[{label:"Devices",icon:"mdi-developer-board",handler:this.goBackDevice,condition:!!this.active&&(!0===this.isNeedSelect||"string"===typeof this.isNeedSelect&&this.isNeedSelect.indexOf("devices")>-1)},{label:"Calcs",icon:"mdi-calculator-variant",handler:this.goBackCalc,condition:!!this.activeCalcId&&(!0===this.isNeedSelect||"string"===typeof this.isNeedSelect&&this.isNeedSelect.indexOf("calcs")>-1)}]},panelsWidgetsStyle:function(){var e={},t=this.isWidgetsMessageActive||this.isWidgetsIntervalsActive,i=this.widgetStyle.left&&this.widgetStyle.right&&t,s=this.widgetStyle.left&&t,n=this.widgetStyle.right&&t;return i?(e.maxWidth="calc(100% - 600px)",e.left="300px"):(s||n)&&(e.maxWidth="calc(100% - 300px)",n&&(e.left="300px")),e}}),methods:ne(ne(ne({filterItems:function(e,t){var i=t?e.filter((function(e){return e&&"undefined"!==typeof e.name&&null!==e.name&&e.name.toLowerCase().indexOf(t)>=0||e&&"undefined"!==typeof e.id&&null!==e.id&&(e.id+"").indexOf(t)>=0})):e;return i.sort((function(e,t){if(!e.name)return-1;if(!t.name)return 1;var i=e.name.toLowerCase(),s=t.name.toLowerCase();return i<s?-1:1})),i}},Object(te["b"])(["getDeleted"])),Object(te["c"])(["setToolboxSessionSettings"])),{},{filterDevicesSelectItems:function(e,t){var i=this;this.isDevicesInit?t():this.itemsLoad("devices",t,this.active,(function(){i.isDevicesInit=!0}))},filterCalcsSelectItems:function(e,t){var i=this;this.isCalcsInit?t():this.itemsLoad("calcs",t,this.activeCalcId,(function(){i.isCalcsInit=!0}))},onMapHandler:function(e){var t=this;if(!this.isVisibleMap)return this.openMapHandler(),this.$nextTick((function(){t.$refs.map.clear().addRoutes(e).send()})),!1;this.$refs.map&&this.isVisibleMap&&this.$refs.map.clear().addRoutes(e).send()},unselect:function(){this.$refs.intervals.unselect(),this.$refs.messages.unselect(),this.viewedInterval=null},setActive:function(e){this.active=e},setActiveCalc:function(e){this.activeCalcId=e},clearActive:function(){this.setActive(null)},clearDevice:function(){this.clearActive()},clearActiveCalc:function(){this.setActiveCalc(null)},clearCalc:function(){this.clearActiveCalc()},goBackDevice:function(){this.$router.push("/devices/".concat(this.active)).catch((function(e){return e}))},goBackCalc:function(){this.$router.push("/calcs/".concat(this.activeCalcId)).catch((function(e){return e}))},init:function(){this.blocked=this.$route.query.noselect||"";var e=this.$route.params&&this.$route.params.deviceId?Number(this.$route.params.deviceId):null,t=this.$route.params&&this.$route.params.calcId?Number(this.$route.params.calcId):null;e&&this.setActive(e),t&&this.setActiveCalc(t),this.isInit=!0,this.$emit("inited")},clearWidgetsState:function(){this.isWidgetsMessageActive=!1,this.isWidgetsIntervalsActive=!1,this.activeWidgetWindow=void 0,this.widgetsViewedMessage=null,this.widgetsVieweInterval=null},beforeEnableWidgetByPane:function(e){var t=this;switch(this.widgetStyle.left||this.isWidgetsMessageActive||this.isWidgetsIntervalsActive||this.widgetsViewModel.data||this.$nextTick((function(){return t.widgetsChangeViewModelHandler(t.entityName,"data",{type:"minimized",to:"left"})})),e){case"messages":this.isWidgetsIntervalsActive=!1;break;case"intervals":this.isWidgetsMessageActive=!1,this.closeMessageWidgetsHandler();break}},onResizePage:function(e){this.$refs.intervalsView.resize(e),this.$refs.messagesView.resize(e)}}),created:function(){var e=this.$route.params.id;if(e){var t=e.split("-"),i=t[0],s=t[1];return this.$router.push("/device/".concat(i,"/calc/").concat(s,"/intervals")).catch((function(e){return e})),!1}this.sessionSettings&&this.sessionSettings.intervalDevicesBlocked&&(this.deviceBlocked=!0),this.sessionSettings&&this.sessionSettings.intervalCalcsBlocked&&(this.calcsBlocked=!0)},beforeDestroy:function(){this.setToolboxSessionSettings({intervalDevicesBlocked:void 0,intervalCalcsBlocked:void 0})},watch:{$route:function(e){if(e.params&&e.params.deviceId&&Number(e.params.deviceId)===this.active&&e.params.calcId&&this.activeCalcId===Number(e.params.calcId))return!1;if(e.params&&e.params.deviceId){var t=Number(e.params.deviceId);if(this.devicesCollection[t]){t!==this.active&&this.setActive(t);var i=Number(e.params.calcId);e.params&&e.params.calcId&&this.calcsCollection[i]&&(this.activeCalcId=i)}else this.isInit&&this.clearActive()}else e.params&&!e.params.deviceId&&this.clearActive();this.clearWidgetsState()},active:function(e,t){this.$router.push("/device/".concat(e,"/calc/").concat(this.activeCalcId||"null","/intervals")).catch((function(e){return e}))},activeCalcId:function(e){this.$router.push("/device/".concat(this.active,"/calc/").concat(e||"null","/intervals")).catch((function(e){return e}))}},components:{intervals:M,messages:B,Widgets:ee["a"]}},ce=ae,oe=(i("e28f"),Object(N["a"])(ce,s,n,!1,null,null,null));t["default"]=oe.exports},"43c1":function(e,t,i){},"6df1":function(e,t,i){},a846:function(e,t,i){"use strict";var s=i("43c1"),n=i.n(s);n.a},cb1a:function(e,t,i){},e28f:function(e,t,i){"use strict";var s=i("cb1a"),n=i.n(s);n.a},e439:function(e,t,i){"use strict";var s=i("6df1"),n=i.n(s);n.a}}]);