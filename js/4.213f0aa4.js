(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"0813":function(e,t,i){},1635:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",[i("entities-toolbar",{attrs:{item:e.selectedItem}},[i("div",{staticClass:"flex",class:{"middle-modificator":!e.active},attrs:{slot:"selects"},slot:"selects"},[i("div",{staticStyle:{display:"inline-flex"},style:{maxWidth:e.needShowBackToChannel&&e.needShowBackToDevice?"calc(100% - 150px)":e.needShowBackToChannel||e.needShowBackToDevice?"calc(100% - 80px)":"100%"}},[i("q-select",{ref:"itemSelect",staticClass:"items__select",class:{"items__select--no-selected":!e.active},attrs:{value:e.active,options:e.filteredItems,filled:"",loading:e.isItemsInitStart&&!e.isItemsInit,label:e.active?"Channel":"SELECT CHANNEL",dark:"","hide-bottom-space":"",dense:"",color:"white",disable:!e.isNeedSelect,"hide-dropdown-icon":!e.isNeedSelect,"popup-content-class":"items__popup","popup-content-style":{height:48*(e.filteredItems.length>6?6:e.filteredItems.length)+48+"px"}},on:{filter:function(t,i){return e.filterItems("channels",t,i)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[i("div",[i("q-input",{staticClass:"q-ma-xs",attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"Filter",autofocus:""},on:{input:function(t){return e.$refs.itemSelect.filter(t)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[i("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1),i("div",{staticClass:"text-center"},[e._v("No results")])],1)]},proxy:!0},{key:"selected-item",fn:function(t){return[e.selectedItem?i("q-item",e._g(e._b({staticClass:"q-pa-none",staticStyle:{"min-height":"20px","margin-top":"2px","max-width":"100%"}},"q-item",t.itemProps,!1),t.itemEvents),[i("q-item-section",[i("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-none text-white",attrs:{header:""}},[e._v(e._s(e.selectedItem.name||"<noname>"))]),i("q-item-label",{staticClass:"q-pa-none q-mt-none text-white ellipsis",staticStyle:{"line-height":"0.75rem!important","margin-top":"1px"},attrs:{caption:""}},[i("small",[e._v(e._s(e.selectedItem.uri||"<no uri>"))])])],1),i("q-item-section",{staticClass:"text-white",attrs:{side:""}},[i("q-item-label",{staticClass:"q-pa-none q-mt-none text-right"},[i("small",[e._v("#"+e._s(e.selectedItem.id))])])],1)],1):e._e()]}},e.filteredItems.length?{key:"option",fn:function(t){return[i("q-item",e._g(e._b({staticClass:"q-pa-xs",attrs:{clickable:""},on:{click:function(i){e.active=t.opt.id}}},"q-item",t.itemProps,!1),t.itemEvents),[i("q-item-section",[i("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-xs",attrs:{header:""}},[e._v(e._s(t.opt.name||"<noname>"))]),i("q-item-label",{staticClass:"q-pa-none q-mt-none",staticStyle:{"line-height":"0.75rem!important","margin-top":"1px"},attrs:{caption:""}},[i("small",[e._v(e._s(t.opt.uri||"<no uri>"))])])],1),i("q-item-section",{attrs:{side:""}},[i("q-item-label",{staticClass:"q-pa-none q-mt-none text-right",class:{"q-pr-xs":e.$q.platform.is.mobile}},[i("small",[e._v("#"+e._s(t.opt.id))])])],1)],1)]}}:null],null,!0)},[i("div",{staticClass:"bg-dark q-pa-xs select__filter",attrs:{slot:"before-options"},slot:"before-options"},[i("q-input",{attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"Filter",autofocus:""},on:{input:function(t){return e.$refs.itemSelect.filter(t)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[i("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1)],1)])],1),i("transition-group",{attrs:{appear:"","enter-active-class":"animated bounceInDown","leave-active-class":"animated bounceOutUp"}},[e.needShowBackToChannel?i("q-btn",{key:"channel",staticClass:"on-right pull-right text-center rounded-borders q-px-xs q-py-none text-white",staticStyle:{width:"60px"},attrs:{title:"View channels",flat:"",dense:""},on:{click:e.viewLogsHandler}},[i("q-icon",{attrs:{size:"1.5rem",color:"white",name:"merge_type"}}),i("div",{staticStyle:{"font-size":".7rem","line-height":".7rem"}},[e._v("Channel")])],1):e._e(),e.needShowBackToDevice?i("q-btn",{key:"device",staticClass:"on-right pull-right text-center rounded-borders q-px-xs q-py-none text-white",staticStyle:{width:"60px"},attrs:{title:"View devices",flat:"",dense:""},on:{click:e.goToDevice}},[i("q-icon",{attrs:{size:"1.5rem",color:"white",name:"mdi-developer-board"}}),i("div",{staticStyle:{"font-size":".7rem","line-height":".7rem"}},[e._v("Device")])],1):e._e()],1)],1)]),e.active?i("traffic-viewer",{staticClass:"flex",attrs:{active:e.active,"active-device":e.activeDevice,isVisibleToolbar:e.isVisibleToolbar,"device-closeble":e.needShowBackToChannel,config:e.config},on:{"change-active-device":e.changeActiveDeviceHandler}}):e._e(),!e.items.length&&e.isItemsInit?i("div",{staticClass:"text-center text-grey-3 q-mt-lg",staticStyle:{"font-size":"2rem"}},[e._v(e._s(e.isLoading?"Fetching data..":"Compatible channels not found"))]):e._e()],1)},a=[],n=(i("8e6e"),i("8a81"),i("456d"),i("c5f6"),i("6762"),i("2fdb"),i("7f7f"),i("ac6a"),i("cadf"),i("06db"),i("8615"),i("c47a")),r=i.n(n),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.activeDevice?i("messages",{directives:[{name:"show",rawName:"v-show",value:e.$q.platform.is.desktop||e.$q.platform.is.mobile&&!e.selectedMessages,expression:"$q.platform.is.desktop || ($q.platform.is.mobile && !selectedMessages)"}],ref:"messages",style:{height:"calc(100vh - "+(e.isVisibleToolbar?"100px":"50px")+")",position:"relative",width:e.$q.platform.is.desktop?"25%":"100%",minWidth:"250px"},attrs:{activeId:e.active,limit:e.limit,config:e.config.messages,"device-closeble":e.deviceCloseble,device:e.activeDevice,view:e.typeOfHexView},on:{"view-data":function(t){e.selectedMessages=t},close:function(){e.$emit("change-active-device",null),e.selectedMessages=""}}}):i("devices",{directives:[{name:"show",rawName:"v-show",value:e.$q.platform.is.desktop||e.$q.platform.is.mobile&&!e.selectedMessages,expression:"$q.platform.is.desktop || ($q.platform.is.mobile && !selectedMessages)"}],ref:"devices",style:{height:"calc(100vh - "+(e.isVisibleToolbar?"100px":"50px")+")",position:"relative",width:e.$q.platform.is.desktop?"25%":"100%",minWidth:"250px"},attrs:{activeId:e.active,config:e.config.messages,device:e.activeDevice,view:e.typeOfHexView},on:{"view-data":function(t){e.selectedMessages=t},"change:device":function(t){e.$emit("change-active-device",t)},close:function(){e.$emit("change-active-device",null),e.selectedMessages=""},"device:preview":e.previewShow,"device:preview-hide":e.previewHide}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.$q.platform.is.desktop||e.$q.platform.is.mobile&&e.selectedMessages,expression:"$q.platform.is.desktop || ($q.platform.is.mobile && selectedMessages)"}],style:{width:e.$q.platform.is.desktop?"75%":"100%",maxWidth:e.$q.platform.is.desktop?"calc(100% - 250px)":""}},[e.activeDevice?i("q-toolbar",{staticClass:"bg-grey-9"},[e.$q.platform.is.mobile?i("q-icon",{staticClass:"cursor-pointer",attrs:{color:"white",size:"1.5rem",name:"mdi-close"},nativeOn:{click:function(t){return function(){e.selectedMessages=""}()}}}):e._e(),i("q-toolbar-title",[i("div",{staticClass:"text-white"},[e._v(e._s(e.activeDevice.ident))])]),i("q-btn",{attrs:{color:"white",flat:"",dense:"",icon:"hex"===e.typeOfHexView?"mdi-matrix":"mdi-format-text"},on:{click:function(t){e.typeOfHexView="hex"===e.typeOfHexView?"text":"hex"}}},[i("q-tooltip",[e._v("Change view mode (hex/text)")])],1),e.activeDevice?i("q-btn",{attrs:{color:"white",flat:"",dense:"",icon:"mdi-export-variant"},on:{click:function(t){e.$refs.messages&&e.$refs.messages.exportModalOpen()}}},[i("q-tooltip",[e._v("Export")])],1):e._e()],1):e._e(),e.activeDevice?i("packet-view",{style:{height:"calc(100vh - "+(e.isVisibleToolbar&&e.activeDevice?"150px":"100px")+")",position:"relative",overflow:"auto"},attrs:{packets:e.selectedMessages,view:e.typeOfHexView}}):e.$q.platform.is.desktop&&e.devicePreview&&e.devicePreviewMessages.length?i("div",{staticClass:"q-pa-md",staticStyle:{overflow:"hidden","max-height":"calc(100vh - 100px)"}},[i("q-timeline",{attrs:{layout:"loose",color:"white",dark:""}},e._l(e.devicePreviewMessages,(function(t,s){return i("message-preview-item",{key:s,attrs:{message:t,view:e.typeOfHexView}})})),1)],1):i("div",{staticStyle:{"text-align":"center",color:"#9e9e9e","font-size":"3rem","padding-top":"40px"}},[i("div",[e._v("Select ident")]),i("q-icon",{attrs:{name:"mdi-arrow-down-bold-outline",size:"3rem"}}),i("div",[e._v("Find message")]),i("q-icon",{attrs:{name:"mdi-arrow-down-bold-outline",size:"3rem"}}),i("div",[e._v("Analyze data")])],1)],1)],1)},c=[],l=i("967e"),d=i.n(l),u=(i("96cf"),i("fa84")),m=i.n(u),h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"wrapper"},[i("q-resize-observer",{on:{resize:e.wrapperResizeHandler}}),i("div",[i("q-toolbar",{staticClass:"bg-grey-9"},[e.deviceCloseble?i("q-btn",{staticClass:"text-white",attrs:{flat:"",dense:"",rounded:"",icon:"mdi-arrow-left"},on:{click:e.closeDevice}},[i("q-tooltip",[e._v("Close current device")])],1):e._e(),e.deviceCloseble?i("q-toolbar-title"):e._e(),i("date-range-modal",{staticClass:"flex flex-center",attrs:{date:e.dateRange,theme:e.theme},on:{save:e.dateRangeChangeHandler}})],1),e.loadingFlag&&e.itemsCount>0?i("div",{staticClass:"absolute-bottom-right absolute-top-left",staticStyle:{overflow:"hidden",top:"50px"}},e._l(new Array(e.itemsCount).fill(""),(function(e,t){return i("message-skeleton",{key:t})})),1):!e.loadingFlag&&e.messages.length?[i("VirtualList",{ref:"scroller",class:{"bg-grey-9":!0,"text-white":!0,"cursor-pointer":!0},style:{position:"absolute",top:"50px",bottom:0,right:0,left:0,height:"auto"},attrs:{onscroll:e.listScroll,size:e.itemHeight,remain:e.itemsCount,wclass:"q-w-list"}},e._l(e.messages,(function(t,s){return i("messages-list-item",{key:s,attrs:{item:t,index:s,actions:e.actions,itemHeight:e.itemHeight,selected:e.selected.includes(s),view:e.view},on:{action:e.actionHandler,"item-click":e.messageClickHandler}})})),1)]:i("empty-pane",{attrs:{config:e.config.emptyState}})],2),i("export-modal",{ref:"export",attrs:{format:e.view,dateRange:e.dateRange,config:e.config,ident:e.device.ident,"item-id":e.activeId}})],1)},p=[],f=i("4db1"),v=i.n(f),g=i("89c1"),b=i.n(g),w=i("9b02"),x=i.n(w),y=i("de45"),k=i("cdde"),D=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-item",{class:[e.selected?"bg-grey-8":""],staticStyle:{"user-select":"none"},attrs:{clickable:""},on:{click:function(t){e.itemClickHandler(e.index,e.item,t)}}},[i("q-tooltip",[e._v(e._s(e.eventsDesc[e.item.type]))]),e.actions?i("q-item-section",{staticClass:"q-pr-none",attrs:{side:""}},e._l(e.actions,(function(t,s){return i("q-icon",{key:s,staticClass:"cursor-pointer on-left",class:t.classes,attrs:{name:t.icon,color:e.selected?"grey-5":""},nativeOn:{click:function(i){return i.stopPropagation(),e.clickHandler(e.index,t.type,e.item)}}},[i("q-tooltip",[e._v(e._s(t.label))])],1)})),1):e._e(),i("q-item-section",[i("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-none",class:["text-"+e.eventsColors[e.item.type]+"-"+(e.selected?3:4)],attrs:{header:""}},[e._v(e._s(e.date.formatDate(1e3*e.item.timestamp,"DD/MM/YYYY HH:mm:ss")))]),e.size?i("q-item-label",{staticClass:"ellipsis overflow-hidden text-grey-5",attrs:{caption:""}},[e._v(e._s(e.size+" B : ")),i("small",[e._v(e._s(e.dataPreview))])]):e._e()],1),i("q-item-section",{attrs:{side:""}},[i("small",{class:["text-grey-"+(e.selected?5:7)]},[e._v(e._s(e.eventsDesc[e.item.type]))]),i("div",[i("small",{staticClass:"rounded-borders q-mx-xs q-px-xs text-white",class:{"bg-blue":"tcp"===e.transport,"bg-purple-9":"udp"===e.transport}},[e._v(e._s(e.transport))]),i("q-icon",{staticClass:"q-ml-xs",attrs:{size:"1.2rem",color:e.eventsColors[e.item.type],name:e.eventIcons[e.item.type]}})],1)])],1)},$=[],C=(i("4917"),i("bd4c")),_=i("c423");function M(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function q(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?M(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):M(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var O={props:["item","index","actions","itemHeight","selected","view"],data:function(){return{date:C["a"],transport:0===this.item.type||1===this.item.type?"":this.item.type>=128?"udp":"tcp",hex:this.base64ToHex(this.item.data),eventsColors:{0:"green",1:"red",2:"purple",130:"purple",3:"yellow",131:"yellow"},eventsDesc:{0:"Connect",1:"Disconnect",2:"Data recieved",130:"Data recieved",3:"Data sent",131:"Data sent"},eventIcons:{0:"mdi-lan-connect",1:"mdi-lan-disconnect",2:"mdi-arrow-right-thick",130:"mdi-arrow-right-thick",3:"mdi-arrow-left-thick",131:"mdi-arrow-left-thick"}}},computed:{dataPreview:function(){var e=this;if(!this.item.data)return"";var t=this.hex;if("text"===this.view){var i=t.match(/.{1,2}/g);t=i.map((function(t){return e.replaceByteWithMnemo(t)})).join("")}return t},size:function(){return this.item.data?Math.floor(this.hex.length/2):null}},methods:{clickHandler:function(e,t,i){var s=q({},i);s.data=this.dataPreview,this.$emit("action",{index:e,type:t,content:s})},itemClickHandler:function(e,t,i){this.$emit("item-click",{index:e,content:t,event:i})}},mixins:[_["a"]]},S=O,T=i("2877"),H=Object(T["a"])(S,D,$,!1,null,null,null),N=H.exports,P=i("121a"),I=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-item",{staticClass:"bg-grey-9"},[i("q-item-section",[i("q-item-label",{staticClass:"q-pa-none bg-white full-width skeleton--modificator",staticStyle:{height:"16px"},attrs:{header:""}}),i("q-item-label",{staticClass:"bg-grey-6  full-width skeleton--modificator",staticStyle:{height:"15px"},attrs:{caption:""}})],1),i("q-item-section",{staticStyle:{width:"30%"},attrs:{side:""}},[i("div",{staticClass:"bg-white full-width skeleton--modificator",staticStyle:{height:"16px"}})])],1)},j=[],z=(i("2724"),{}),E=Object(T["a"])(z,I,j,!1,null,null,null),F=E.exports,G=i("5a3a"),L=i.n(G),A=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-dialog",{ref:"modal",attrs:{maximized:e.$q.platform.is.mobile,"no-esc-dismiss":e.loadingFlag,"no-backdrop-dismiss":e.loadingFlag}},[i("q-card",{style:{minWidth:e.$q.platform.is.mobile?"100%":"310px",height:e.$q.platform.is.mobile?"100%":"auto"}},[i("q-card-section",{staticClass:"q-pa-sm",style:{height:"calc(100% - 54px)"}},[i("date-range-picker",{model:{value:e.currentDateRange,callback:function(t){e.currentDateRange=t},expression:"currentDateRange"}}),i("q-select",{attrs:{options:e.selectOpts,multiple:"",filled:"",label:"Format","hide-bottom-space":"",dense:"","bg-color":"grey-3"},model:{value:e.currentFormat,callback:function(t){e.currentFormat=t},expression:"currentFormat"}}),i("q-toggle",{attrs:{label:"Format timestamps"},model:{value:e.needTimeConvert,callback:function(t){e.needTimeConvert=t},expression:"needTimeConvert"}}),e.needTimeConvert?[i("q-input",{staticClass:"q-mb-sm",attrs:{outlined:"",dense:"",label:"Date format"},model:{value:e.timeFormat,callback:function(t){e.timeFormat=t},expression:"timeFormat"}}),i("q-select",{attrs:{options:e.timezoneOptions,"emit-value":"","map-options":"",filled:"",label:"Timezone","hide-bottom-space":"",dense:"","bg-color":"grey-3"},model:{value:e.timezoneOffset,callback:function(t){e.timezoneOffset=t},expression:"timezoneOffset"}})]:e._e()],2),i("q-separator",{attrs:{color:"white"}}),i("q-card-actions",{staticClass:"bg-grey-9 text-white",attrs:{align:"right"}},[i("q-btn",{attrs:{flat:"",disable:e.loadingFlag},on:{click:e.hide}},[e._v("Close")]),i("q-btn",{attrs:{flat:"",disable:e.loadingFlag||e.currentFormat.length<1,loading:e.loadingFlag},on:{click:e.importHandler}},[e._v("Export")])],1)],1)],1)},R=[],Y=i("a99f"),B={props:["format","dateRange","config","ident","itemId"],data:function(){return{currentFormat:[this.format],currentDateRange:this.dateRange.map((function(e){return new Date(e)})),moduleName:this.config.vuexModuleName,loadingFlag:!1,selectOpts:["hex","text","base64"],needTimeConvert:!1,timeFormat:"YYYY/MM/DD HH:mm:ss.SSS",currentTimezoneOffset:-(new Date).getTimezoneOffset()/60,timezoneOffset:"local",timezoneOptions:[{value:"local",label:"Local time (computer`s timezone)"},{value:-12,label:"(GMT -12:00) Eniwetok, Kwajalein"},{value:-11,label:"(GMT -11:00) Midway Island, Samoa"},{value:-10,label:"(GMT -10:00) Hawaii"},{value:-9,label:"(GMT -9:00) Alaska"},{value:-8,label:"(GMT -8:00) Pacific Time (US &amp; Canada)"},{value:-7,label:"(GMT -7:00) Mountain Time (US &amp; Canada)"},{value:-6,label:"(GMT -6:00) Central Time (US &amp; Canada), Mexico City"},{value:-5,label:"(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima"},{value:-4,label:"(GMT -4:00) Atlantic Time (Canada), Caracas, La Paz"},{value:-3.5,label:"(GMT -3:30) Newfoundland"},{value:-3,label:"(GMT -3:00) Brazil, Buenos Aires, Georgetown"},{value:-2,label:"(GMT -2:00) Mid-Atlantic"},{value:-1,label:"(GMT -1:00 hour) Azores, Cape Verde Islands"},{value:0,label:"(GMT) Western Europe Time, London, Lisbon, Casablanca"},{value:1,label:"(GMT +1:00 hour) Brussels, Copenhagen, Madrid, Paris"},{value:2,label:"(GMT +2:00) Kaliningrad, South Africa"},{value:3,label:"(GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg"},{value:3.5,label:"(GMT +3:30) Tehran"},{value:4,label:"(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi"},{value:4.5,label:"(GMT +4:30) Kabul"},{value:5,label:"(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent"},{value:5.5,label:"(GMT +5:30) Bombay, Calcutta, Madras, New Delhi"},{value:5.75,label:"(GMT +5:45) Kathmandu"},{value:6,label:"(GMT +6:00) Almaty, Dhaka, Colombo"},{value:7,label:"(GMT +7:00) Bangkok, Hanoi, Jakarta"},{value:8,label:"(GMT +8:00) Beijing, Perth, Singapore, Hong Kong"},{value:9,label:"(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk"},{value:9.5,label:"(GMT +9:30) Adelaide, Darwin"},{value:10,label:"(GMT +10:00) Eastern Australia, Guam, Vladivostok"},{value:11,label:"(GMT +11:00) Magadan, Solomon Islands, New Caledonia"},{value:12,label:"(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka"}]}},methods:{show:function(){this.$refs.modal.show()},hide:function(){this.$refs.modal.hide()},formatData:function(e,t){var i=null;return i="hex"===t?this.base64ToHex(e):"text"===t?this.base64ToTextWithMnemoReplacing(e):e,i},dateByTimezone:function(e,t){var i=new Date(e),s=i.getTime(),a=6e4*i.getTimezoneOffset(),n=s+a,r=36e5*t,o=n+r;return new Date(o)},importHandler:function(){var e=this;return m()(d.a.mark((function t(){var i,s,a,n,r,o,c,l,u,m;return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loadingFlag=!0,i={from:Math.floor(e.currentDateRange[0].valueOf()/1e3),to:Math.floor(e.currentDateRange[1].valueOf()/1e3)},t.next=4,e.$store.dispatch("".concat(e.moduleName,"/getExportData"),i);case 4:s=t.sent,s.forEach((function(t,i){if(e.needTimeConvert){var a=e.timeFormat||"YYYY/MM/DD HH:mm:ss";"local"===e.timezoneOffset?s[i].timestamp=C["a"].formatDate(1e3*s[i].timestamp,a):s[i].timestamp=C["a"].formatDate(e.dateByTimezone(1e3*s[i].timestamp,e.timezoneOffset),a)}if(!s[i].data)return!1;e.currentFormat.forEach((function(a){s[i][a]=e.formatData(t.data,a)})),s[i].data=void 0})),a="application/json",n=document.createElement("a"),r=JSON.stringify(s,void 0,2),o=new Blob([r],{type:a}),c=URL.createObjectURL(o),l="[".concat(C["a"].formatDate(e.currentDateRange[0],"DD.MM.YYYY HH-mm-ss")," - ").concat(C["a"].formatDate(e.currentDateRange[1],"DD.MM.YYYY HH-mm-ss"),"]"),u="local"===e.timezoneOffset?e.currentTimezoneOffset:e.timezoneOffset,m="".concat(e.itemId,"_").concat(e.ident).concat(l,"_").concat(u>=0?"GMT+".concat(u):"GMT".concat(u),".json"),n.setAttribute("href",c),n.setAttribute("download",m),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),e.loadingFlag=!1,e.hide();case 15:case"end":return t.stop()}}),t)})))()}},watch:{dateRange:function(e){this.currentDateRange=e.map((function(e){return new Date(e)}))},format:function(e){this.currentFormat=[e]}},components:{DateRangePicker:Y["a"]},mixins:[_["a"]]},V=B,W=Object(T["a"])(V,A,R,!1,null,null,null),K=W.exports;function U(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function J(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?U(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):U(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Q={props:["activeId","device","limit","config","view","deviceCloseble"],data:function(){return{theme:this.config.theme,viewConfig:this.config.viewConfig,actions:this.config.actions,moduleName:this.config.vuexModuleName,itemHeight:53,itemsCount:0,wrapperHeight:0,needAutoScroll:!0,selected:[],scrollerScrollTop:0}},computed:{messages:{get:function(){return this.$store.state[this.moduleName].messages},set:function(e){this.$store.commit("".concat(this.moduleName,"/setMessages"),e)}},currentLimit:{get:function(){return this.$store.state[this.moduleName].limit},set:function(e){this.$store.commit("".concat(this.moduleName,"/setLimit"),e)}},dateRange:function(){return[this.$store.state[this.moduleName].from,this.$store.state[this.moduleName].to]},from:{get:function(){return this.$store.state[this.moduleName].from},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setFrom"),e):this.$store.commit("".concat(this.moduleName,"/setFrom"),0)}},to:{get:function(){return this.$store.state[this.moduleName].to},set:function(e){e?this.$store.commit("".concat(this.moduleName,"/setTo"),e):this.$store.commit("".concat(this.moduleName,"/setTo"),0)}},realtimeEnabled:function(){return this.$store.state[this.moduleName].messagePolling},loadingFlag:function(){var e=this.$store.state;return!(!e[this.config.vuexModuleName]||!e[this.config.vuexModuleName].isLoading)}},methods:{resetParams:function(){if(!this.$refs.wrapper)return!1;if(this.wrapperHeight=this.$refs.wrapper.offsetHeight-this.itemHeight,this.itemsCount=Math.ceil(this.wrapperHeight/this.itemHeight),this.$refs.scroller&&this.$refs.scroller.forceRender(),this.$refs.scroller&&this.$refs.scroller.$el){var e=this.$refs.scroller.$el;e.scrollTop+=1}},dateRangeChangeHandler:function(e){var t=this,i=e[0],s=e[1];if(this.from===i&&this.to===s)return!1;this.from=i,this.to=s,this.realtimeEnabled&&this.$store.dispatch("".concat(this.moduleName,"/removePollingGetMessages")),this.needAutoScroll&&s<=Date.now()&&(this.needAutoScroll=!1),this.$store.commit("".concat(this.moduleName,"/clearMessages")),this.$store.dispatch("".concat(this.moduleName,"/getMessages")).then((function(){s>Date.now()&&t.$store.dispatch("".concat(t.moduleName,"/pollingGetMessages"))}))},clearSelected:function(){this.selected=[]},wrapperResizeHandler:function(){this.resetParams()},getScrollDirection:function(e){var t=null;return t=e>this.currentScrollTop?"bottom":e<this.currentScrollTop?"top":"none",t},listScroll:function(e,t){var i=t.offset;this.currentScrollTop||(this.currentScrollTop=i);var s=x()(this.$refs,"scroller.$el",void 0),a=s.scrollHeight-s.clientHeight,n=this.getScrollDirection(i),r=.1*a;this.allScrollTop=this.$refs.scroller?this.$refs.scroller.$el.scrollHeight-this.$refs.scroller.$el.clientHeight:0,this.messages.length&&(i<this.currentScrollTop&&this.needAutoScroll?this.needAutoScroll=!1:!this.needAutoScroll&&this.realtimeEnabled&&i>=this.allScrollTop&&(this.needAutoScroll=!0),this.currentScrollTop=i),n&&("top"===n||"none"===n)&&i<r?this.getMessagesPrev():n&&("bottom"===n||"none"===n)&&i+r>=a&&this.getMessagesNext()},getMessagesPrev:function(){var e=x()(this.$refs,"scroller.$el",void 0),t=e.scrollHeight-e.clientHeight,i=e.scrollTop;this.$store.dispatch("".concat(this.moduleName,"/getMessagesPrev")).then((function(s){if(s&&s.length){var a=e.scrollHeight-e.clientHeight;e.scrollTop=a-t+i}}))},getMessagesNext:function(){this.$store.dispatch("".concat(this.moduleName,"/getMessagesNext"))},actionHandler:function(e){var t=e.index,i=e.type,s=e.content;switch(i){case"view":this.viewMessagesHandler({index:t,content:s});break;case"copy":this.copyMessageHandler({index:t,content:s});break}},viewMessagesHandler:function(e){var t=e.index,i=e.content;this.selected=[t],this.$root.$emit("view-data",i)},messageClickHandler:function(e){var t=this,i=e.index,s=(e.content,e.event);if(s.shiftKey)this.selected[0]?this.selected[0]>i?this.selected=L()(i,this.selected[0]+1):this.selected=L()(this.selected[0],i+1):this.selected=[i];else if(s.ctrlKey)if(this.selected.includes(i)){var a=this.selected;a.splice(this.selected.indexOf(i),1),this.selected=a}else this.selected=[].concat(v()(this.selected),[i]);else this.selected=[i];this.needAutoScroll&&(this.needAutoScroll=!1),this.selected.sort((function(e,t){return e-t})),this.$emit("view-data",this.selected.map((function(e){return J(J({},t.messages[e]),{},{index:e})})))},copyMessageHandler:function(e){var t=this,i=(e.index,e.content);Object(k["a"])(JSON.stringify(i)).then((function(e){t.$q.notify({type:"positive",icon:"content_copy",message:"Message copied",timeout:1e3})}),(function(e){t.$q.notify({type:"negative",icon:"content_copy",message:"Error coping messages",timeout:1e3})}))},unselect:function(){this.selected.length&&(this.selected=[])},closeDevice:function(){this.$emit("close")},clear:function(){this.realtimeEnabled&&this.$store.dispatch("".concat(this.moduleName,"/removePollingGetMessages")),this.$store.commit("".concat(this.moduleName,"/clearMessages")),this.closeDevice()},exportModalOpen:function(){this.$refs.export.show()}},watch:{activeId:function(e){this.clear()},limit:function(e){this.currentLimit=e}},created:function(){var e=this;this.currentLimit=this.limit,this.activeId&&!this.$store.state[this.moduleName].active&&this.$store.commit("".concat(this.moduleName,"/setActive"),this.activeId),this.device&&!this.$store.state[this.moduleName].ident&&this.$store.commit("".concat(this.moduleName,"/setIdent"),this.device.ident);var t=this.$route.query.from,i=this.$route.query.to;t&&i?(this.from=t,this.to=i,this.$store.dispatch("".concat(this.moduleName,"/getMessages")),this.to>Date.now()&&this.$store.dispatch("".concat(this.moduleName,"/pollingGetMessages"))):this.$store.dispatch("".concat(this.moduleName,"/initTime")).then((function(){e.$store.dispatch("".concat(e.moduleName,"/getMessages")),e.to>Date.now()&&e.$store.dispatch("".concat(e.moduleName,"/pollingGetMessages"))}))},mounted:function(){this.resetParams()},updated:function(){this.messages.length?this.needAutoScroll&&this.$refs.scroller&&this.$refs.scroller.$el&&(this.$refs.scroller.$el.scrollTop=this.$refs.scroller.$el.scrollHeight):this.currentScrollTop=0},destroyed:function(){this.$store.dispatch("".concat(this.moduleName,"/removePollingGetMessages")),this.$store.commit("".concat(this.moduleName,"/clearMessages")),this.to=0,this.from=0},components:{MessagesListItem:N,VirtualList:b.a,EmptyPane:P["a"],MessageSkeleton:F,DateRangeModal:y["a"],ExportModal:K}},X=Q,Z=Object(T["a"])(X,h,p,!1,null,null,null),ee=Z.exports,te=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"wrapper"},[i("q-resize-observer",{on:{resize:e.wrapperResizeHandler}}),i("div",[i("q-toolbar",{staticClass:"bg-grey-9"},[i("q-input",{attrs:{outlined:"","hide-bottom-space":"",rounded:"",dense:"",color:"white",dark:"",placeholder:"ident",debounce:500},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[i("q-icon",{attrs:{slot:"prepend",name:"mdi-magnify",color:"white"},slot:"prepend"})],1)],1),e.loadingFlag&&e.itemsCount>0?i("div",{staticClass:"absolute-bottom-right absolute-top-left",staticStyle:{overflow:"hidden",top:"50px"}},e._l(new Array(e.itemsCount).fill(""),(function(e,t){return i("device-skeleton",{key:t})})),1):!e.loadingFlag&&e.devicesByIndex.length?[i("VirtualList",{ref:"scroller",class:{"bg-grey-9":!0,"text-white":!0,"cursor-pointer":!0},style:{position:"absolute",top:"50px",bottom:0,right:0,left:0,height:"auto"},attrs:{size:e.itemHeight,remain:e.itemsCount,wclass:"q-w-list"}},e._l(e.devices,(function(t,s){return i("device-list-item",{key:t.ident,attrs:{item:t,index:s,itemHeight:e.itemHeight},on:{"item-click":e.deviceClickHandler},nativeOn:{mouseenter:function(i){return e.previewDeviceHandler(t)},mouseleave:function(i){return e.previewDeviceCloseHandler(t)}}})})),1)]:i("empty-pane",{attrs:{config:e.config.emptyState}})],2)],1)},ie=[],se=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-item",{staticClass:"q-py-none",attrs:{clickable:""},on:{click:function(t){e.itemClickHandler(e.index,e.item,t)}}},[i("q-item-section",[i("q-item-label",{staticClass:"ellipsis text-white q-pa-none",attrs:{header:""}},[e._v(e._s(e.ident))]),i("q-item-label",{staticClass:"ellipsis overflow-hidden text-grey-5",attrs:{caption:""}},[e._v(e._s(e.item.size?e.format.humanStorageSize(e.item.size):"new"))])],1)],1)},ae=[],ne=i("7937"),re={props:["item","index","itemHeight"],data:function(){return{date:C["a"],format:ne["c"],ident:this.item.ident}},methods:{itemClickHandler:function(e,t,i){this.$emit("item-click",{index:e,content:t,event:i})}}},oe=re,ce=Object(T["a"])(oe,se,ae,!1,null,null,null),le=ce.exports,de=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-item",{staticClass:"bg-grey-9"},[i("q-item-section",[i("q-item-label",{staticClass:"q-pa-none bg-white full-width skeleton--modificator",staticStyle:{height:"16px"},attrs:{header:""}}),i("q-item-label",{staticClass:"bg-grey-6  full-width skeleton--modificator",staticStyle:{height:"15px"},attrs:{caption:""}})],1)],1)},ue=[],me=(i("a24e"),{}),he=Object(T["a"])(me,de,ue,!1,null,null,null),pe=he.exports,fe={props:["activeId","device","config","view"],data:function(){return{theme:this.config.theme,viewConfig:this.config.viewConfig,actions:this.config.actions,moduleName:this.config.vuexModuleName,itemHeight:48,itemsCount:0,wrapperHeight:0}},computed:{selectedChannel:function(){var e=this.$store.state.channels[this.activeId],t=this.$store.state.channelsProtocols[e.protocol_id].features;return e.features=t,e},devices:{get:function(){return this.$store.state[this.moduleName].devices},set:function(e){this.$store.commit("".concat(this.moduleName,"/setDevices"),e)}},devicesByIndex:function(){return Object.values(this.$store.state[this.moduleName].devices)},filter:{get:function(){return this.$store.state[this.moduleName].deviceFilter},set:function(e){var t=this;this.$store.commit("".concat(this.moduleName,"/setDeviceFilter"),e),this.$store.dispatch("".concat(this.moduleName,"/getDevices")),this.$nextTick((function(){t.$refs.scroller&&t.$refs.scroller.forceRender()}))}},active:{get:function(){return this.$store.state[this.moduleName].active},set:function(e){var t=this;return m()(d.a.mark((function i(){return d.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!t.realtimeEnabled){i.next=3;break}return i.next=3,t.$store.dispatch("".concat(t.moduleName,"/removePollingGetDevices"));case 3:return t.$store.commit("".concat(t.moduleName,"/setActive"),e),t.$store.commit("".concat(t.moduleName,"/clearDevices")),i.next=7,t.$store.dispatch("".concat(t.moduleName,"/getDevices"));case 7:if(t.selectedChannel.features.shared_connection){i.next=10;break}return i.next=10,t.$store.dispatch("".concat(t.moduleName,"/pollingGetDevices"));case 10:case"end":return i.stop()}}),i)})))()}},realtimeEnabled:function(){return this.$store.state[this.moduleName].realtimeEnabled},loadingFlag:function(){var e=this.$store.state;return!(!e[this.config.vuexModuleName]||!e[this.config.vuexModuleName].isLoading)}},methods:{resetParams:function(){if(!this.$refs.wrapper)return!1;this.wrapperHeight=this.$refs.wrapper.offsetHeight-this.itemHeight,this.itemsCount=Math.ceil(this.wrapperHeight/this.itemHeight),this.$refs.scroller&&this.$refs.scroller.forceRender()},wrapperResizeHandler:function(){this.resetParams()},deviceClickHandler:function(e){e.index;var t=e.content;e.event;this.$store.commit("".concat(this.moduleName,"/setIdent"),t.ident),this.$emit("change:device",t)},previewDeviceHandler:function(e){this.$emit("device:preview",e)},previewDeviceCloseHandler:function(e){this.$emit("device:preview-hide",e)},clearDevices:function(){this.devices={}}},watch:{activeId:function(e){this.active=e}},created:function(){this.activeId&&(this.active=this.activeId)},mounted:function(){this.resetParams()},components:{VirtualList:b.a,DeviceListItem:le,EmptyPane:P["a"],DeviceSkeleton:pe}},ve=fe,ge=Object(T["a"])(ve,te,ie,!1,null,null,null),be=ge.exports,we=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-timeline-entry",{staticClass:"hex-viewer__timeline-element",attrs:{side:2===e.message.type||130===e.message.type?"left":"right",color:e.eventsColors[e.message.type]+"-6"}},[i("div",{attrs:{slot:"title"},slot:"title"},[i("div",{staticStyle:{"line-height":"18px"}},[i("span",[e._v(e._s(e.eventsDesc[e.message.type]))])]),i("div",{staticClass:"text-grey-5",staticStyle:{"font-size":".7rem"}},[e._v("\n      "+e._s(e.date.formatDate(1e3*e.message.timestamp,"DD/MM/YYYY HH:mm:ss"))+"\n      "),i("small",{staticClass:"rounded-borders q-mx-xs q-px-xs text-white",class:{"bg-blue":"tcp"===e.transport,"bg-purple-9":"udp"===e.transport}},[e._v(e._s(e.transport))])])]),i("div",{staticClass:"ellipsis",staticStyle:{"word-break":"break-all","font-size":".8rem",height:"1rem"}},[e._v(e._s(e.dataPreview))])])},xe=[],ye={props:["message","view"],data:function(){return{date:C["a"],transport:0===this.message.type||1===this.message.type?"":this.message.type>=128?"udp":"tcp",eventsColors:{0:"green",1:"red",2:"purple",130:"purple",3:"yellow",131:"yellow"},eventsDesc:{0:"Connect",1:"Disconnect",2:"Data recieved",130:"Data recieved",3:"Data sent",131:"Data sent"},eventIcons:{0:"mdi-lan-connect",1:"mdi-lan-disconnect",2:"mdi-arrow-right-thick",130:"mdi-arrow-right-thick",3:"mdi-arrow-left-thick",131:"mdi-arrow-left-thick"}}},computed:{dataPreview:function(){var e=this,t=this.base64ToHex(this.message.data)||"";if("text"===this.view&&t){var i=t.match(/.{1,2}/g);t=i.map((function(t){return e.replaceByteWithMnemo(t)})).join("")}return t}},mixins:[_["a"]]},ke=ye,De=(i("cb33"),Object(T["a"])(ke,we,xe,!1,null,null,null)),$e=De.exports,Ce=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.packets&&e.packets.length?i("div",{staticClass:"traffic-viewer__packets q-pa-sm"},e._l(e.batches,(function(t,s){return i("div",{key:s,staticStyle:{"min-width":"820px"}},[e.batches[s-1]?i("div",{staticClass:"packets__separator",style:{backgroundColor:e.bgDataColors[t.type]}}):e._e(),i("div",{staticClass:"packet__header text-center",style:{backgroundColor:e.bgDataColors[t.type]}},[i("span",{staticClass:"rounded-borders text-white full-height"},[i("q-icon",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"1rem",color:e.eventsColors[t.type],name:e.eventIcons[t.type]}}),i("span",{staticClass:"text-uppercase text-white"},[e._v(e._s(e.eventsDesc[t.type]))]),e._v("\n        (\n        "),i("span",{staticClass:"text-white",class:{"q-mr-sm":t.size},staticStyle:{"font-size":".8rem"}},[e._v(e._s(e.date.formatDate(1e3*t.timestamp,"DD/MM/YYYY HH:mm:ss")))]),t.size?i("span",{staticClass:"q-mr-sm text-white",staticStyle:{"font-size":".8rem"}},[e._v("size: "+e._s(t.size)+"B")]):e._e(),t.transport?i("small",{staticClass:"rounded-borders q-px-xs text-white",class:{"bg-blue":"tcp"===t.transport,"bg-purple-9":"udp"===t.transport},staticStyle:{"vertical-align":"middle"}},[e._v("\n          "+e._s(t.transport)+"\n        ")]):e._e(),e._v("\n        )\n      ")],1)]),t.data?i("hex-viewer",{style:{backgroundColor:e.bgDataColors[t.type]},attrs:{hex:t.data,view:e.view}}):e._e(),e.batches[s+1]?i("div",{staticClass:"packets__separator",style:{backgroundColor:e.bgDataColors[t.type]}}):e._e(),e.getNeedMissing(s)?i("div",{staticClass:"packets__missing"},[i("div",{staticClass:"missing__up"}),i("div",{staticClass:"missing__down"})]):e._e()],1)})),0):i("div",{staticStyle:{"text-align":"center",color:"#9e9e9e","font-size":"3rem","padding-top":"40px"}},[e._v("Select packets")])},_e=[],Me=i("d77f");function qe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Oe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):qe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Se={props:["packets","view"],data:function(){return{date:C["a"],eventsColors:{0:"green",1:"red",2:"purple",130:"purple",3:"yellow",131:"yellow"},eventsDesc:{0:"Connect",1:"Disconnect",2:"Data recieved",130:"Data recieved",3:"Data sent",131:"Data sent"},eventIcons:{0:"mdi-lan-connect",1:"mdi-lan-disconnect",2:"mdi-arrow-right-thick",130:"mdi-arrow-right-thick",3:"mdi-arrow-left-thick",131:"mdi-arrow-left-thick"},bgDataColors:{0:"rgba(76, 175, 80, 0.4)",1:"rgba(244, 67, 54, 0.4)",2:"rgba(156, 39, 176, 0.4)",130:"rgba(156, 39, 176, 0.4)",3:"rgba(255, 235, 59, 0.4)",131:"rgba(255, 235, 59, 0.4)"}}},computed:{batches:function(){var e=this;return this.packets&&this.packets.length?this.packets.reduce((function(t,i,s){var a=Oe({},i);a.data=e.base64ToHex(i.data),a.index=[a.index],a.transport=0===a.type||1===a.type?"":a.type>=128?"udp":"tcp",a.data&&(a.size=Math.floor(a.data.length/2));var n=t[t.length-1];return n&&n.type===a.type&&2===a.type&&n.conn===a.conn&&n.index[n.index.length-1]+1===a.index[0]?(n.data+=a.data,n.size+=a.size,n.index=[].concat(v()(n.index),v()(a.index))):t.push(a),t}),[]):[]}},methods:{getNeedMissing:function(e){var t=this.batches[e],i=this.batches[e+1];return i&&t.index[t.index.length-1]+1<i.index[0]}},mixins:[_["a"]],components:{HexViewer:Me["a"]}},Te=Se,He=(i("aff9"),Object(T["a"])(Te,Ce,_e,!1,null,null,null)),Ne=He.exports,Pe=(i("6b54"),i("2b0e"));function Ie(e){var t=e||Date.now(),i=new Date(t).setHours(0,0,0,0),s=i+86399999;return{from:i,to:s}}function je(e){return ze.apply(this,arguments)}function ze(){return ze=m()(d.a.mark((function e(t){var i,s,a,n,r;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.state,s=t.commit,a=Date.now(),e.prev=2,e.next=5,Pe["default"].connector.gw.getChannelsIdentsPackets(i.active,i.ident,{data:{count:1,reverse:!0}});case 5:n=e.sent,a=x()(n,"data.result[0].timestamp",Math.floor(Date.now()/1e3)),a=Math.round(1e3*a),e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](2);case 12:r=Ie(a),s("setFrom",r.from),s("setTo",r.to);case 15:case"end":return e.stop()}}),e,null,[[2,10]])}))),ze.apply(this,arguments)}function Ee(e){return Fe.apply(this,arguments)}function Fe(){return Fe=m()(d.a.mark((function e(t){var i,s,a,n;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.state,s=t.commit,"undefined"!==typeof i.isLoading&&Pe["default"].set(i,"isLoading",!0),e.prev=2,e.next=5,Pe["default"].connector.gw.getChannelsIdents(i.active,i.deviceFilter?"*".concat(i.deviceFilter,"*"):"*");case 5:a=e.sent,n=x()(a,"data.result",[]),n=n.reduce((function(e,t){var i=t.ident,s=t.size;return e[i]={ident:i,size:s},e}),{}),s("setDevices",n),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2),s("reqFailed",e.t0);case 14:"undefined"!==typeof i.isLoading&&Pe["default"].set(i,"isLoading",!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])}))),Fe.apply(this,arguments)}function Ge(e){return Le.apply(this,arguments)}function Le(){return Le=m()(d.a.mark((function e(t){var i,s,a,n,r;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.state,s=t.commit,"undefined"!==typeof i.isLoading&&Pe["default"].set(i,"isLoading",!0),e.prev=2,a=i.to>Date.now()?Date.now():i.to,e.next=6,Pe["default"].connector.gw.getChannelsIdentsPackets(i.active,i.ident,{data:{from:Math.floor(i.from/1e3),to:Math.floor(a/1e3),count:i.limit}});case 6:n=e.sent,r=x()(n,"data.result",[]),s("setMessages",r),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2),s("reqFailed",e.t0);case 14:"undefined"!==typeof i.isLoading&&Pe["default"].set(i,"isLoading",!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])}))),Le.apply(this,arguments)}function Ae(e){return Re.apply(this,arguments)}function Re(){return Re=m()(d.a.mark((function e(t){var i,s,a,n;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.state,s=t.commit,"undefined"!==typeof i.isLoading&&Pe["default"].set(i,"isLoading",!0),e.prev=2,e.next=5,Pe["default"].connector.gw.getChannelsIdentsPackets(i.active,i.ident,{data:{count:i.limit,reverse:!0}});case 5:a=e.sent,n=x()(a,"data.result",[]),n.reverse(),s("setMessages",n),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2),s("reqFailed",e.t0);case 14:"undefined"!==typeof i.isLoading&&Pe["default"].set(i,"isLoading",!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])}))),Re.apply(this,arguments)}var Ye=!1;function Be(e){return Ve.apply(this,arguments)}function Ve(){return Ve=m()(d.a.mark((function e(t){var i,s,a,n,r;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=t.state,s=t.commit,i.messages.length&&!Ye&&!i.messagePolling){e.next=3;break}return e.abrupt("return");case 3:return Ye=!0,e.prev=4,a=Math.ceil(i.messages[i.messages.length-1].timestamp),e.next=8,Pe["default"].connector.gw.getChannelsIdentsPackets(i.active,i.ident,{data:{count:i.limit,from:a,to:Math.floor(i.to/1e3)}});case 8:return n=e.sent,r=x()(n,"data.result",[]),s("setMessagesAppend",r),e.abrupt("return",r);case 14:e.prev=14,e.t0=e["catch"](4),s("reqFailed",e.t0);case 17:Ye=!1;case 18:case"end":return e.stop()}}),e,null,[[4,14]])}))),Ve.apply(this,arguments)}function We(e){return Ke.apply(this,arguments)}function Ke(){return Ke=m()(d.a.mark((function e(t){var i,s,a,n,r;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=t.state,s=t.commit,i.messages.length&&!Ye){e.next=3;break}return e.abrupt("return");case 3:return Ye=!0,e.prev=4,a=Math.floor(i.messages[0].timestamp)-1,e.next=8,Pe["default"].connector.gw.getChannelsIdentsPackets(i.active,i.ident,{data:{count:i.limit,from:Math.floor(i.from/1e3),to:a,reverse:!0}});case 8:return n=e.sent,r=x()(n,"data.result",[]),r.reverse(),s("setMessagesPrepend",r),e.abrupt("return",r);case 15:e.prev=15,e.t0=e["catch"](4),s("reqFailed",e.t0);case 18:Ye=!1;case 19:case"end":return e.stop()}}),e,null,[[4,15]])}))),Ke.apply(this,arguments)}function Ue(e){return Je.apply(this,arguments)}function Je(){return Je=m()(d.a.mark((function e(t){var i;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.state,t.commit,e.next=3,Pe["default"].connector.socket.subscribe({name:"flespi/log/gw/channels/".concat(i.active,"/connections/+/identified"),handler:function(e,t,s){e=JSON.parse(e.toString());var a=e.ident;i.devices[a]||-1===a.indexOf(i.deviceFilter)||Pe["default"].set(i.devices,a,{ident:a})}});case 3:i.realtimeEnabled=!0;case 4:case"end":return e.stop()}}),e)}))),Je.apply(this,arguments)}function Qe(e){return Xe.apply(this,arguments)}function Xe(){return Xe=m()(d.a.mark((function e(t){var i;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.state,t.commit,i.realtimeEnabled=!1,e.next=4,Pe["default"].connector.socket.unsubscribe("flespi/log/gw/channels/".concat(i.active,"/connections/+/identified"));case 4:case"end":return e.stop()}}),e)}))),Xe.apply(this,arguments)}var Ze=0;function et(e){var t=e.state,i=e.commit;Ze=setInterval(m()(d.a.mark((function e(){var s,a,n,r;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,s=Math.ceil(t.messages[t.messages.length-1].timestamp),a=Math.ceil(Date.now()/1e3),e.next=5,Pe["default"].connector.gw.getChannelsIdentsPackets(t.active,t.ident,{data:{from:s,to:a}});case 5:n=e.sent,r=x()(n,"data.result",[]),i("setMessagesAppend",r),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),i("reqFailed",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),1e4),t.messagePolling=!0}function tt(e){var t=e.state;e.commit;clearInterval(Ze),Ze=0,t.messagePolling=!1}function it(e,t){return st.apply(this,arguments)}function st(){return st=m()(d.a.mark((function e(t,i){var s,a,n;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.state,a=[],e.prev=2,e.next=5,Pe["default"].connector.gw.getChannelsIdentsPackets(s.active,i.ident,{data:{count:20,reverse:!0}});case 5:n=e.sent,a=x()(n,"data.result",[]),e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](2);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))),st.apply(this,arguments)}function at(e,t){return nt.apply(this,arguments)}function nt(){return nt=m()(d.a.mark((function e(t,i){var s,a,n,r,o;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.state,a=i.from,n=i.to,r=[],e.prev=3,e.next=6,Pe["default"].connector.gw.getChannelsIdentsPackets(s.active,s.ident,{data:{from:a,to:n}});case 6:o=e.sent,r=x()(o,"data.result",[]),e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](3);case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,null,[[3,10]])}))),nt.apply(this,arguments)}var rt={initTime:je,getMessages:Ge,getMessagesTail:Ae,getMessagesNext:Be,getMessagesPrev:We,getDevices:Ee,pollingGetDevices:Ue,removePollingGetDevices:Qe,pollingGetMessages:et,removePollingGetMessages:tt,getDevicePreview:it,getExportData:at};function ot(e,t){e.limit=t}function ct(e,t){e.active=t}function lt(e){e.messages=[]}function dt(e){e.devices=[]}function ut(e,t){e.devices=t}function mt(e,t){e.messages=t}function ht(e,t){var i;(i=e.messages).splice.apply(i,[e.messages.length,0].concat(v()(t)))}function pt(e,t){var i;(i=e.messages).splice.apply(i,[0,0].concat(v()(t)))}function ft(e,t){e.to=t}function vt(e,t){e.from=t}function gt(e,t){e.deviceFilter=t}function bt(e,t){e.ident=t}function wt(e){e.devices={},e.messages=[],e.to=0,e.from=0,e.active=null}function xt(e,t){}var yt={setLimit:ot,setActive:ct,clearMessages:lt,clearDevices:dt,setDevices:ut,setMessages:mt,setMessagesAppend:ht,setMessagesPrepend:pt,clean:wt,setTo:ft,setFrom:vt,setDeviceFilter:gt,setIdent:bt,reqFailed:xt},kt={devices:{},messages:[],active:null,ident:null,limit:0,deviceFilter:"",from:0,to:0,isLoading:!1,realtimeEnabled:!1,messagePolling:!1},Dt={namespaced:!0,state:kt,actions:rt,mutations:yt},$t={props:["active","activeDevice","isVisibleToolbar","config","deviceCloseble"],data:function(){return{devicePreview:null,typeOfHexView:"hex",limit:1e3,selectedMessages:"",moduleName:this.config.messages.vuexModuleName,devicePreviewMessages:[]}},computed:{hex:function(){var e=this;return!(!this.selectedMessages||!this.activeDevice)&&this.selectedMessages.reduce((function(t,i){return t+=e.base64ToHex(i.data)||"",t}),"")}},methods:{previewShow:function(e){var t=this;return m()(d.a.mark((function i(){return d.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.devicePreview=e,i.next=3,t.$store.dispatch("".concat(t.moduleName,"/getDevicePreview"),e);case 3:t.devicePreviewMessages=i.sent;case 4:case"end":return i.stop()}}),i)})))()},previewHide:function(e){this.devicePreview=null}},created:function(){this.$store.state[this.moduleName]||this.$store.registerModule(this.moduleName,Dt)},destroyed:function(){this.$store.commit("".concat(this.moduleName,"/clean")),this.$store.dispatch("".concat(this.moduleName,"/removePollingGetDevices")),this.$store.unregisterModule(this.moduleName)},watch:{active:function(){this.selectedMessages="",this.devicePreview=null}},mixins:[_["a"]],components:{Devices:be,Messages:ee,MessagePreviewItem:$e,PacketView:Ne}},Ct=$t,_t=Object(T["a"])(Ct,o,c,!1,null,null,null),Mt=_t.exports,qt=i("a99a"),Ot=i("2f62"),St=i("286e");function Tt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Ht(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Tt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Nt={name:"PageTrafficViewer",props:["limit","isLoading","isVisibleToolbar","isNeedSelect","config","settings"],mixins:[St["a"]],data:function(){return{active:null,activeDevice:null,relatedDeviceId:null,isInit:!1,isItemsInit:!1,isItemsInitStart:!1,filter:"",prevEntity:null,isIntegration:this.$q.platform.within.iframe}},computed:Ht(Ht({},Object(Ot["d"])({tokenType:function(e){return e.tokenInfo&&e.tokenInfo.access?e.tokenInfo.access.type:-1},items:function(e){return Object.values(e.channels||{}).filter((function(t){return e.channelsProtocols[t.protocol_id].features.raw_packets}))}})),{},{filteredItems:function(){var e=this.filter.toLowerCase(),t=this.filter?this.items.filter((function(t){return t&&"undefined"!==typeof t.name&&null!==t.name&&t.name.toLowerCase().indexOf(e)>=0||t&&"undefined"!==typeof t.id&&null!==t.id&&(t.id+"").indexOf(e)>=0})):this.items;return t.sort((function(e,t){if(!e.name)return-1;if(!t.name)return 1;var i=e.name.toLowerCase(),s=t.name.toLowerCase();return i<s?-1:1})),t},selectedItem:function(){var e=this;return this.items.filter((function(t){return t.id===e.active}))[0]||null},needShowBackToChannel:function(){return this.active&&(!this.isIntegration||this.isIntegration&&("channels"===this.prevEntity&&!this.isNeedSelect||this.isNeedSelect))},needShowBackToDevice:function(){return this.active&&this.activeDevice&&this.relatedDeviceId&&(!this.isIntegration||this.isIntegration&&("devices"===this.prevEntity&&!this.isNeedSelect||this.isNeedSelect))}}),methods:{changeActiveDeviceHandler:function(e){this.setActiveDevice(e),this.active?this.activeDevice?this.$router.push("/tools/traffic/".concat(this.active,"/ident/").concat(e.ident)).catch((function(e){return e})):this.$router.push("/tools/traffic/".concat(this.active)).catch((function(e){return e})):this.$router.push("/tools/traffic").catch((function(e){return e}))},unselect:function(){this.$refs.messages.unselect()},viewLogsHandler:function(){this.$router.push("/channels/".concat(this.active)).catch((function(e){return e}))},setActiveDevice:function(e){this.activeDevice=e,this.getRelatedDeviceId()},getRelatedDeviceId:function(){var e=this;this.activeDevice?this.$connector.gw.getChannelProtocolsDeviceTypes(this.selectedItem.protocol_id,"all",{fields:"id"}).then((function(e){var t=x()(e,"data.result",[]);return t.map((function(e){return e.id}))})).then((function(t){e.$connector.gw.getDevices("configuration.ident=".concat(e.activeDevice.ident),{fields:"id,device_type_id"}).then((function(i){var s=x()(i,"data.result",[]),a=s.reduce((function(e,i){return e||(t.includes(i.device_type_id)?i.id:e)}),0);e.relatedDeviceId=a}))})):this.relatedDeviceId=null},goToDevice:function(){this.$router.push("/devices/".concat(this.relatedDeviceId)).catch((function(e){return e}))},init:function(){var e=this,t="tools/traffic",i=x()(this.settings,"entities[".concat(t,"]"),void 0);this.isInit=!0,this.$route.params&&this.$route.params.id?this.items.filter((function(t){return t.id===Number(e.$route.params.id)})).length?(this.active=Number(this.$route.params.id),this.$route.params.ident&&this.setActiveDevice({ident:this.$route.params.ident})):this.active=null:i&&this.items.filter((function(e){return e.id===i})).length&&(this.active=i),this.$emit("inited")}},beforeRouteEnter:function(e,t,i){i((function(e){e.prevEntity=t.meta.moduleName}))},watch:{$route:function(e){e.params&&e.params.id?this.items.filter((function(t){return t.id===Number(e.params.id)})).length?(this.active=Number(e.params.id),this.$route.params.ident&&this.setActiveDevice({ident:this.$route.params.ident})):this.isInit&&(this.active=null):e.params&&!e.params.id&&(this.active=null)},active:function(e){var t=this.items.filter((function(t){return t.id===e}))[0]||{};e?(this.$emit("update:settings",{type:"ENTITY_CHANGE",opt:{entity:"tools/traffic"},value:t.id}),this.activeDevice?this.$router.push("/tools/traffic/".concat(e,"/ident/").concat(this.activeDevice.ident)).catch((function(e){return e})):this.$router.push("/tools/traffic/".concat(e)).catch((function(e){return e}))):this.$router.push("/tools/traffic").catch((function(e){return e}))}},components:{TrafficViewer:Mt,EntitiesToolbar:qt["a"]}},Pt=Nt,It=(i("8b7b"),Object(T["a"])(Pt,s,a,!1,null,null,null));t["default"]=It.exports},2724:function(e,t,i){"use strict";var s=i("2f99"),a=i.n(s);a.a},"2f99":function(e,t,i){},"3e79":function(e,t,i){},"875b":function(e,t,i){},8955:function(e,t,i){},"8b7b":function(e,t,i){"use strict";var s=i("3e79"),a=i.n(s);a.a},a24e:function(e,t,i){"use strict";var s=i("8955"),a=i.n(s);a.a},aff9:function(e,t,i){"use strict";var s=i("875b"),a=i.n(s);a.a},cb33:function(e,t,i){"use strict";var s=i("0813"),a=i.n(s);a.a}}]);