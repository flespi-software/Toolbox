(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"0463":function(e,t,i){"use strict";i("ddb0"),i("2b3d"),i("9861");var s=i("f59f"),a=i("bd4c");t["a"]={data(){return{isFileCsvLoading:!1}},methods:{async exportCsv(e,{from:t,to:i},o){this.$q.dialog({title:"Export CSV",cancel:{color:"white",flat:!0},ok:{color:"white",flat:!0},persistent:!0,dark:!0,options:{type:"toggle",model:[],items:[{label:"Format timestamps",value:"needFormat",color:"primary"}]},noRouteDismiss:!0}).onOk((n=>{const r=this.$store.state[this.moduleName],l=r.cols,c=l.schemas[l.activeSchema].cols.filter((e=>!e.__dest)).map((e=>e.name));this.isFileCsvLoading=!0,"devices"!==o&&"intervals"!==o||(e.fields=c.join(",")),this.$store.dispatch(`${this.moduleName}/getMessages`,e).then((e=>{if(!e||!e.length)return this.$q.notify({type:"negative",message:"Messages are empty or file is too big.",position:"bottom-right"}),!1;n.includes("needFormat")&&e.forEach((e=>{Object.keys(e).forEach((t=>{if(t.match(/timestamp$/)||"begin"===t||"end"===t){const i=Math.floor(1e3*e[t]);e[t]=a["a"].formatDate(i,"DD/MM/YYYY HH:mm:ss")}}))}));let o="";try{o=Object(s["parse"])(e,{fields:c})}catch(r){console.log(r)}if(o){const e="text/csv",s=document.createElement("a"),n=o,r=new Blob([n],{type:e}),l=URL.createObjectURL(r),c=`${this.item.name||"*NoName*"}[${a["a"].formatDate(t,"DD.MM.YYYY HH-mm-ss")}-${a["a"].formatDate(i,"DD.MM.YYYY HH-mm-ss")}].csv`;s.setAttribute("href",l),s.setAttribute("download",c),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}this.isFileCsvLoading=!1})).catch((e=>{console.log(e),this.isFileCsvLoading=!1}))}))}}}},"076c":function(e,t,i){},"0860":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("iframe",{ref:"frame",staticClass:"absolute-top-left absolute-bottom-right",staticStyle:{width:"100%",height:"100%"},attrs:{src:e.link,frameborder:"0"}})},a=[],o=(i("e9c4"),i("42454")),n=i.n(o),r={name:"map-frame",data(){return{link:"https://flespi.io/mapview",lastCommand:{},mapInited:!1}},methods:{centerMap(e){return this.lastCommand.centermap=e,this},autobounds(e){return this.lastCommand.autobounds=e,this},addConfig(e){this.lastCommand=n()({},this.lastCommand,e)},addMarkers(e){return this.lastCommand.addmarkers=e,this},addNamedMarkers(e){return this.lastCommand.namedmarkers=e,this},addNamedMarker(e){return this.lastCommand.namedmarkers={...this.lastCommand.namedmarkers,...e},this},addPoints(e){return this.lastCommand.appendpoints=e,this},addRoutes(e){return this.lastCommand.addgroutes=e,this},clear(e="all"){return this.lastCommand.clear=e,this},send(){return this.$refs.frame&&this.mapInited&&(this.$refs.frame.contentWindow.postMessage(`MapView|cmd:${JSON.stringify(this.lastCommand)}`,"*"),this.lastCommand={}),this}},created(){const e=t=>{'MapView|state:{"ready": true}'===t.data&&(this.mapInited=!0,this.$refs.frame.contentWindow.postMessage('MapView|cmd:{"ruler": true, "zoomcontrol": true}',"*"),this.send(),window.removeEventListener("message",e))};window.addEventListener("message",e)}},l=r,c=i("2877"),d=Object(c["a"])(l,s,a,!1,null,null,null);t["a"]=d.exports},"121a":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"empty-state__back"},[i("div",{staticClass:"text-center text-grey-4",class:["q-pb-"+(e.$q.platform.is.mobile?"sm":"lg"),e.$q.platform.is.mobile?"":"q-pt-lg"],staticStyle:{"font-size":"1.5rem"}},[e._v(e._s(e.config.label))]),e.$q.platform.is.desktop?i("div",{staticClass:"row text-white q-px-md q-mb-md justify-center"},[i("div",{staticClass:"text-grey-4 col-12 q-px-sm",staticStyle:{"font-size":".9rem"}},[e._v(e._s(e.config.sublabel))]),e._l(e.config.hints,(function(t,s){return i("div",{key:s,staticClass:"q-pa-sm",class:t.wclass||["col-6","col-sm-3"]},[i("div",{staticClass:"empty-state__card full-height",domProps:{innerHTML:e._s(t.html)}})])}))],2):[i("q-dialog",{attrs:{"no-route-dismiss":""},model:{value:e.dialogModel,callback:function(t){e.dialogModel=t},expression:"dialogModel"}},[i("div",{staticClass:"row text-white q-pa-md bg-grey-9"},[i("div",{staticClass:"text-grey-4 col-12 q-px-sm",staticStyle:{"font-size":".9rem"}},[e._v(e._s(e.config.sublabel))]),e._l(e.config.hints,(function(t,s){return i("div",{key:s,staticClass:"q-pa-sm",class:t.wclass||["col-6","col-sm-3"]},[i("div",{staticClass:"empty-state__card full-height",domProps:{innerHTML:e._s(t.html)}})])}))],2)]),i("div",{staticClass:"text-center q-mb-sm"},[i("q-btn",{attrs:{label:"Details",dense:"",color:"white",flat:""},on:{click:function(t){e.dialogModel=!0}}})],1)],i("div",{staticClass:"text-center"},[i("q-btn",{attrs:{type:"a",label:"More about Toolbox",href:"https://flespi.com/blog/drive-telematics-diagnostics-beyond-ordinary-with-flespi-toolbox",target:"_blank",dense:"",flat:e.$q.platform.is.mobile,color:"red",size:".8rem"}})],1),e._t("after")],2)},a=[],o={name:"EmptyPane",props:["config"],data(){return{dialogModel:!1}}},n=o,r=(i("cc73"),i("2877")),l=i("24e8"),c=i("9c40"),d=i("eebe"),h=i.n(d),m=Object(r["a"])(n,s,a,!1,null,null,null);t["a"]=m.exports;h()(m,"components",{QDialog:l["a"],QBtn:c["a"]})},2724:function(e,t,i){"use strict";i("ce46")},"286e":function(e,t,i){"use strict";var s=i("2f62"),a=i("9b02"),o=i.n(a),n=i("63ea"),r=i.n(n);const l={};function c(e,t,i,s,a){let o;return s?t?o={entity:e,id:t,mode:1}:i&&(o={entity:e,id:i,mode:1}):o={entity:e,id:t,mode:1},!!o&&a.push(o)}t["a"]={beforeRouteEnter(e,t,i){const s=e.meta.moduleName;let a=t.meta.moduleName;i((i=>{if(s!==a||!a){let n=s;const r=[];if(n){const s=e.params&&e.params.id?JSON.parse(e.params.id):null,d=o()(i.settings,`entities[${n}]`,void 0);switch(n){case"devices":"intervals"!==a&&"deviceTraffic"!==a||(a="devices"),s&&r.push({entity:"tasks",id:{device:s},mode:1}),n!==a&&c(n,s,d,i.isNeedSelect,r);break;case"deviceTraffic":n="devices",n!==a&&c(n,s,d,i.isNeedSelect,r);break;case"calcs":"intervals"===a&&(a="calcs"),s&&r.push({entity:"tasks",id:{calc:s},mode:1}),n!==a&&c(n,s,d,i.isNeedSelect,r);break;case"intervals":{const s=e.params&&e.params.deviceId?JSON.parse(e.params.deviceId):null,o=e.params&&e.params.calcId?JSON.parse(e.params.calcId):null,d=t.params&&t.params.id?JSON.parse(t.params.id):null;"devices"===a?(i.isCalcsInit=c("calcs",o,void 0,i.isNeedSelect||"string"===typeof i.isNeedSelect&&!i.isNeedSelect.indexOf("calcs"),r),i.isDevicesInit=l.devices&&!l.devices.id,i.deviceBlocked=!0,i.setToolboxSessionSettings({intervalDevicesBlocked:!0}),n="devices",d!==s&&r.push({entity:"tasks",id:{device:s,calc:o},mode:1})):"calcs"===a?(i.isDevicesInit=c("devices",s,void 0,i.isNeedSelect||"string"===typeof i.isNeedSelect&&!i.isNeedSelect.indexOf("devices"),r),i.isCalcsInit=l.calcs&&!l.calcs.id,i.calcsBlocked=!0,i.setToolboxSessionSettings({intervalCalcsBlocked:!0}),n="calcs",d!==o&&r.push({entity:"tasks",id:{device:s,calc:o},mode:1})):(i.deviceBlocked=!0,i.calcsBlocked=!0,i.setToolboxSessionSettings({intervalDevicesBlocked:!0,intervalCalcsBlocked:!0}),r.push({entity:"tasks",id:{device:s,calc:o},mode:1}),i.isCalcsInit=c("calcs",o,void 0,i.isNeedSelect||"string"===typeof i.isNeedSelect&&!i.isNeedSelect.indexOf("calcs"),r),i.isDevicesInit=c("devices",s,void 0,i.isNeedSelect||"string"===typeof i.isNeedSelect&&!i.isNeedSelect.indexOf("devices"),r));break}case"trafficViewer":case"hexViewer":n="channels",n!==a&&c(n,s,d,i.isNeedSelect,r);break;case"channels":a="hexViewer"===a||"trafficViewer"===a?"channels":a,n!==a&&c(n,s,d,i.isNeedSelect,r);break;case"platform":if(n="subaccounts","mqtt"===a)break;c(n,s,d,i.isNeedSelect,r);break;case"mqtt":if(n="subaccounts","platform"===a)break;c(n,s,d,i.isNeedSelect,r);break;default:c(n,s,d,i.isNeedSelect,r)}}r.forEach((e=>{l[e.entity]=e})),l[n]&&!l[n].id&&(i.isItemsInit=!0),i.getEntities(r).then((()=>{i.init&&i.init()}))}}))},beforeRouteUpdate(e,t,i){const s=e.meta.moduleName,a=t.meta.moduleName,o=e.params&&e.params.id?JSON.parse(e.params.id):null,n=t.params&&t.params.id?JSON.parse(t.params.id):null,c=[],d=[];if(s===a&&r()(e.params,t.params))return i();if(s===a){if(o)switch(s){case"devices":d.push({entity:"tasks",id:{device:o},mode:1});break;case"calcs":d.push({entity:"tasks",id:{calc:o},mode:1});break}if(n)switch(s){case"devices":c.push({entity:"tasks",id:{device:n},mode:1});break;case"calcs":c.push({entity:"tasks",id:{calc:n},mode:1});break}}c.forEach((e=>{delete l[e.entity]})),d.forEach((e=>{l[e.entity]=e})),this.removeEntities(c).then((()=>{this.getEntities(d)})).then(i)},beforeRouteLeave(e,t,i){let s=t.meta.moduleName,a=e.meta.moduleName;const o=[];if(s&&a!==s){const e=t.params&&t.params.id?JSON.parse(t.params.id):null;switch(s){case"devices":"intervals"===a&&(a="devices"),a!==s&&(o.push({entity:"tasks",id:{device:e},mode:1}),o.push(this.isNeedSelect&&this.isItemsInit?{entity:s,mode:1}:{entity:s,id:e,mode:1}));break;case"deviceTraffic":s="devices",s!==a&&o.push(this.isNeedSelect&&this.isItemsInit?{entity:s,mode:1}:{entity:s,id:e,mode:1});break;case"calcs":"intervals"===a&&(a="calcs"),a!==s&&o.push(this.isNeedSelect&&this.isItemsInit?{entity:s,mode:1}:{entity:s,id:e,mode:1});break;case"intervals":{const e=t.params&&t.params.deviceId?JSON.parse(t.params.deviceId):null,i=t.params&&t.params.calcId?JSON.parse(t.params.calcId):null;"devices"===a?o.push((this.isNeedSelect||"string"===typeof this.isNeedSelect&&!this.isNeedSelect.indexOf("calcs"))&&this.isCalcsInit?{entity:"calcs",mode:1}:{entity:"calcs",id:i,mode:1}):("calcs"===a||o.push((this.isNeedSelect||"string"===typeof this.isNeedSelect&&!this.isNeedSelect.indexOf("calcs"))&&this.isCalcsInit?{entity:"calcs",mode:1}:{entity:"calcs",id:i,mode:1}),o.push((this.isNeedSelect||"string"===typeof this.isNeedSelect&&!this.isNeedSelect.indexOf("devices"))&&this.isDevicesInit?{entity:"devices",mode:1}:{entity:"devices",id:e,mode:1})),o.push(l.tasks);break}case"trafficViewer":case"hexViewer":s="channels",s!==a&&o.push(this.isNeedSelect&&this.isItemsInit?{entity:s,mode:1}:{entity:s,id:e,mode:1});break;case"platform":if(s="subaccounts","mqtt"===a)break;o.push(this.isNeedSelect&&this.isItemsInit?{entity:s,mode:1}:{entity:s,id:e,mode:1});break;case"mqtt":if(s="subaccounts","platform"===a)break;o.push(this.isNeedSelect&&this.isItemsInit?{entity:s,mode:1}:{entity:s,id:e,mode:1});break;default:o.push(this.isNeedSelect&&this.isItemsInit?{entity:s,mode:1}:{entity:s,id:e,mode:1})}}return o.forEach((e=>{delete l[e.entity]})),this.removeEntities(o).then((()=>{i()}))},methods:{...Object(s["b"])(["getEntities","removeEntities","unsubscribeItems"]),itemsLoad(e,t,i,s){return this.getEntities([{entity:e,mode:1}]).then((a=>{i&&this.unsubscribeItems({entity:e,id:i,mode:1}),t&&t(),l[e]={entity:e,mode:1},s&&s()}))},filterItems(e,t,i){this.isItemsInitStart&&!this.isItemsInit||(this.isItemsInit?i():(this.isItemsInitStart=!0,this.itemsLoad(e,i,this.active,(()=>{this.isItemsInit=!0}))))}}}},"2ce0":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("virtual-scroll-list",{ref:"scrollList",class:{"non-selectable":e.selectionMode},attrs:{name:"LogsVirtualScroll",cols:e.cols,actions:e.actions,items:e.messages,dateRange:e.dateRange,viewConfig:e.viewConfig,i18n:e.i18n,filter:e.filter,theme:e.theme,title:"Logs",loading:e.loadingFlag,autoscroll:e.needAutoscroll,scrollOffset:"10%",item:e.listItem,itemprops:e.getItemsProps,"has-new-messages":e.hasNewMessages},on:{scroll:e.scrollHandler,action:e.actionHandler,"change-filter":e.filterChangeHandler,"scroll-top":e.paginationPrevChangeHandler,"scroll-bottom":e.paginationNextChangeHandler,"change-date-range":e.dateRangeChangeHandler,"action-to-bottom":e.actionToBottomHandler,"action-to-new-messages":e.actionToNewMessages,"action-to-new-messages-hide":e.actionToNewMessagesHide,"update-cols":e.updateColsHandler},nativeOn:{click:function(t){return e.tableClickHandler.apply(null,arguments)}}},[i("empty-pane",{attrs:{slot:"empty",config:e.config.emptyState},slot:"empty"}),e.isInit?i("logs-filter-menu",{attrs:{slot:"filter-append",filter:e.filter,entity:e.entityName},on:{update:e.filterChangeHandler},slot:"filter-append"}):e._e()],1)],1)},a=[],o=(i("26e9"),i("5319"),i("ddb0"),i("e9c4"),i("bd4c")),n=i("cdde"),r=i("b047c"),l=i.n(r),c=i("de45");i("e01a");const d={alert:"red",info:"grey-6",notice:"green",warning:"yellow"};var h={computed:{logsObject(){return this.$store.state.logsObject}},methods:{getLogItemColorByCodes(e,t){const i=this.logsObject.codes[e];let s=d[i.severity];return t&&(s=d[i.extra_codes[t].severity]||s),s},getLogItemColorByLogEntry(e){const t=this.logsObject.codes[e.event_code];let i=d[t.severity];const s=t.extra_name;return s&&e[s]&&(i=d[t.extra_codes[e[s]].severity]||i),i},getLogDescriptionByItem(e){const t=this.getLogMeta(e);let i=t.description;return e[t.extraName]&&(i+=t.extraData&&t.extraData.description?` (${t.extraData.description})`:` (${t.extraName}: ${e[t.extraName]})`),i},getLogMeta(e){const t=this.logsObject.codes[e.event_code],i=t.extra_name;let s;if(t.extra_name&&e[i]){const a=t.extra_codes[e[i]];s={...a,color:d[a.severity]}}return{code:t.code,description:t.description,doc:t.doc,entity:t.entity,color:d[t.severity],extraName:i,extraData:s}},getLogValueOfProp(e,t){let i=e.custom?JSON.stringify(t[e.name]):t[e.name];return"event_code"===e.name?i=this.getLogDescriptionByItem(t):"timestamp"===e.name||"interval_begin"===e.name||"interval_end"===e.name?i=o["a"].formatDate(1e3*t[e.name],"DD/MM/YYYY HH:mm:ss"):"host"===e.name&&(i=t.host||t.source||""),i}}},m=i("2b0e"),p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:{height:e.itemHeight+"px",width:e.rowWidth+"px"},on:{click:function(t){return e.itemClickHandler(e.index,e.item,t)}}},[i("div",{staticClass:"cursor-pointer",class:[e.color,e.item["x-flespi-status"]?"missed-items":"",e.selected?"bg-white-opasity-3":""],style:{height:e.itemHeight+"px",width:e.rowWidth+"px",boxSizing:"border-box"}},[e._l(e.cols,(function(t,s){var a,o;return["etc"===t.__dest?i("span",{key:t.name+s,staticClass:"list__item item_etc",class:(a={},a["item_"+s]=!0,a["item--active"]=e.menuCellActive&&e.menuCellActive.row===e.index&&e.menuCellActive.col===s,a)},[e._v(e._s(e.etc))]):i("span",{key:t.name+s,staticClass:"list__item",class:(o={},o["item_"+s]=!0,o["item--active"]=e.menuCellActive&&e.menuCellActive.row===e.index&&e.menuCellActive.col===s,o)},["event_code"===t.name&&e.item.address?["connection"===e.item.address?i("q-icon",{attrs:{name:"mdi-ethernet",title:"address: connection"}}):e._e(),"sms"===e.item.address?i("q-icon",{attrs:{name:"mdi-email-outline",title:"address: sms"}}):e._e(),"local"===e.item.address?i("q-icon",{attrs:{name:"mdi-content-save-outline",title:"address: local"}}):e._e()]:e._e(),"event_code"===t.name&&e.item["error_text"]?i("q-icon",{attrs:{name:"mdi-alert-outline"},nativeOn:{click:function(t){return t.stopPropagation(),e.clickHandler(e.index,"to-error-traffic",e.item)}}},[i("q-tooltip",[i("pre",{staticClass:"q-ma-none"},[e._v(e._s(e.item["error_text"]))])])],1):e._e(),"event_code"===t.name&&e.isErrorType&&e.isIntegration?i("q-icon",{attrs:{name:"mdi-bug"},nativeOn:{click:function(t){return t.stopPropagation(),e.clickHandler(e.index,"error-report",e.item)}}},[i("q-tooltip",[e._v("Report error to chat")])],1):e._e(),901===e.item.event_code&&"name"===t.name?i("a",{staticClass:"text-green",attrs:{target:"_blank",href:e.$flespiCDN+"/file/"+e.item.uuid},on:{click:function(e){e.stopPropagation()}}},[e._v("\n          "+e._s(e.getLogValueOfProp(t,e.item))+"\n        ")]):i("span",{attrs:{title:JSON.stringify(e.getLogValueOfProp(t,e.item))}},[e._v("\n          "+e._s(e.getLogValueOfProp(t,e.item))+"\n        ")])],2)]}))],2)])},u=[],g=i("b06b"),f={props:["item","index","actions","cols","itemHeight","selected","rowWidth","itemSettings","menuCellActive"],mixins:[h],data(){return{date:o["a"],isIntegration:this.$q.platform.within.iframe}},computed:{etc(){const e=Object.keys(this.item).filter((e=>!this.hasInCols(e)));return e.reduce(((e,t)=>("event_origin"===t||"event_text"===t||"item_data"===t||"source"===t||"error_text"===t||"close_code"===t||"code"===t||"http_data"===t||"current"===t||"updated"===t||"error_code"===t||"send_code"===t||"address"===t||"uuid"===t||(e+=`${t}: ${JSON.stringify(this.item[t])}; `),e)),"")||"*Empty*"},color(){return`text-${this.getLogItemColorByLogEntry(this.item)}`},isErrorType(){return"text-red"===this.color},eventLinkMore(){const e=this.$flespiServer;return`${e}/${this.getLogMeta(this.item).doc}`},description(){return this.getLogDescriptionByItem(this.item)}},methods:{hasInCols(e){return!!this.cols.filter((t=>e===t.name)).length},clickHandler(e,t,i){this.$emit("action",{index:e,type:t,content:i})},linkMoreClickHandler(){Object(g["a"])(this.eventLinkMore)},itemClickHandler(e,t,i){Object.defineProperty(t,"x-flespi-description",{value:`<div style="font-size: 1.1rem">${t.event_code}: ${this.getLogDescriptionByItem(t)}</div><div style="font-size: .9rem">${o["a"].formatDate(1e3*t.timestamp,"DD/MM/YYYY HH:mm:ss")}</div>`,enumerable:!1}),Object.defineProperty(t,"x-flespi-color",{value:`text-${this.getLogItemColorByLogEntry(t)}`,enumerable:!1}),this.$emit("item-click",{index:e,content:t,event:i})}}},v=f,b=(i("ee59"),i("2877")),y=i("05c0"),w=i("0016"),x=i("eebe"),_=i.n(x),$=Object(b["a"])(v,p,u,!1,null,"4fc2f3e0",null),k=$.exports;_()($,"components",{QTooltip:y["a"],QIcon:w["a"]});var C=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-btn",{attrs:{color:"white",icon:"mdi-filter-variant",flat:"",dense:"",rounded:""}},[i("q-tooltip",[e._v("Filter by event type")]),i("q-menu",{attrs:{anchor:"top right",self:"top right","content-class":"bg-grey-9","no-route-dismiss":""}},[i("div",{staticClass:"q-py-sm",staticStyle:{"max-width":"400px","max-height":"calc(50vh - 50px)"}},[i("div",{staticClass:"text-white text-weight-bold q-ml-sm"},[e._v("Basic")]),e._l(e.baseOptions,(function(t){return i("div",{key:t.value,staticClass:"filter-menu__item q-pl-sm cursor-pointer",on:{click:function(i){return e.add("event_code",t.value)}}},[i("span",{class:["text-"+e.getLogItemColorByCodes(t.value)]},[e._v(e._s(t.label))])])})),e.entityOptions.length?i("div",[i("div",{staticClass:"text-white text-weight-bold q-mt-xs q-ml-sm"},[e._v("Specific for "+e._s(e.entity))]),e._l(e.entityOptions,(function(t){return[i("div",{key:t.value,staticClass:"filter-menu__item q-pl-sm cursor-pointer",on:{click:function(i){return e.add("event_code",t.value)}}},[i("span",{class:["text-"+e.getLogItemColorByCodes(t.value)]},[e._v(e._s(t.label))])]),102===t.value||301===t.value?i("div",{key:t.value+"close"},e._l(e.closeCodes,(function(s,a){return i("div",{key:a,staticClass:"filter-menu__item q-pl-lg cursor-pointer",on:{click:function(i){return e.addComplex("event_code",t.value,"close_code",s.code)}}},[i("span",{class:["text-"+e.getLogItemColorByCodes(t.value,s.code)]},[e._v(e._s(s.description))])])})),0):e._e()]}))],2):e._e()],2)])],1)},M=[];const S={2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,14:!0,15:!0,16:!0,17:!0,18:!0,19:!0};var q={props:["filter","entity"],mixins:[h],data(){return{baseEvents:[],entityEvents:[],baseOptions:[],entityOptions:[],closeCodes:[]}},methods:{add(e,t){const i=`${e}==${t}`;this.$emit("update",i)},addComplex(e,t,i,s){const a=`${e}==${t}&&${i}==${s}`,o=a;this.$emit("update",o)}},created(){const e=this.$store.state.logsObject;this.baseEvents=e.entities.base,this.entityEvents=e.entities[this.entity],this.baseOptions=this.baseEvents.map((t=>({label:e.codes[t].description,value:t}))),this.entityOptions=this.entityEvents.map((t=>({label:e.codes[t].description,value:t})));const t=102;this.closeCodes=Object.values(e.codes[t].extra_codes).filter((e=>S[e.code]))}},H=q,N=(i("70a8"),i("9c40")),T=i("4e73"),z=Object(b["a"])(H,C,M,!1,null,"31b4d1bc",null),O=z.exports;_()(z,"components",{QBtn:N["a"],QTooltip:y["a"],QMenu:T["a"]});var D=i("121a"),I=i("6126"),E=i("db49"),L=i("b609"),A=i("c9ad"),j={props:["item","cid","limit","originPattern","config","entityName"],data(){return{listItem:k,theme:this.config.theme,itemSettings:this.config.itemSettings,i18n:{"Messages not found":"Log entries not found"},scrollTimestamp:void 0,viewConfig:this.config.viewConfig,actions:this.config.actions,moduleName:this.config.vuexModuleName,autoscroll:!0,isInit:!1}},computed:{messages:{get(){return this.$store.state[this.moduleName].messages},set(e){this.$store.commit(`${this.moduleName}/setMessages`,e)}},origin:{async set(e){await this.$store.dispatch(`${this.moduleName}/unsubscribePooling`),this.$store.commit(`${this.moduleName}/setOrigin`,e),this.$store.commit(`${this.moduleName}/setItemDeletedStatus`,this.item&&this.item.deleted),this.$store.commit(`${this.moduleName}/clearMessages`),this.$store.dispatch(`${this.moduleName}/getCols`,this.config.cols),await this.$store.dispatch(`${this.moduleName}/initTime`),await this.getMessages()},get(){return this.$store.state[this.moduleName].origin}},cols:{get(){return this.$store.state[this.moduleName].cols},set(e){this.$store.commit(`${this.moduleName}/updateCols`,e)}},filter:{get(){return this.$store.state[this.moduleName].filter},set(e){e=e||"",this.$store.commit(`${this.moduleName}/setFilter`,e)}},dateRange(){return[this.$store.state[this.moduleName].from,this.$store.state[this.moduleName].to]},from:{get(){return this.$store.state[this.moduleName].from},set(e){e=e||0,this.$store.commit(`${this.moduleName}/setFrom`,e)}},to:{get(){return this.$store.state[this.moduleName].to},set(e){e=e||0,this.$store.commit(`${this.moduleName}/setTo`,e)}},reverse:{get(){return this.$store.state[this.moduleName].reverse||!1},set(e){this.$store.commit(`${this.moduleName}/setReverse`,e)}},selected:{get(){return this.$store.state[this.moduleName].selected},set(e){e&&e.length&&(this.autoscroll=!1),this.$store.commit(`${this.moduleName}/setSelected`,e),this.updateSelectedRoute(this.selectedMessagesTimestamps)}},selectedMessagesTimestamps(){let e;return this.selected.length&&(e=this.selected.map((e=>this.messages[e].timestamp))),e},realtimeEnabled(){return this.$store.state[this.moduleName].realtimeEnabled},currentLimit:{get(){return this.$store.state[this.moduleName].limit},set(e){e=e||1e3,this.$store.commit(`${this.moduleName}/setLimit`,e)}},hasNewMessages:{get(){return this.$store.state[this.moduleName].hasNewMessages},set(e){this.$store.state[this.moduleName].hasNewMessages=e}},originByPattern(){return this.item?this.originPattern.replace(/\/:(\w*)(\/)?/g,((e,t,i)=>`/${this.item[t]}${i||""}`)):""},loadingFlag(){const e=this.$store.state;return!(!e[this.config.vuexModuleName]||!e[this.config.vuexModuleName].isLoading)},needAutoscroll(){return this.realtimeEnabled&&!this.selected.length&&this.autoscroll}},methods:{tableClickHandler(e){e.target.closest(".list-item--click-control")||(this.selected=[],this.$emit("view-log-message",[]))},getItemsProps(e,t){const i=this.messages[e];t.key=i["x-flespi-message-key"],t.class="list-item list-item--click-control",t.props.etcVisible=this.etcVisible,t.props.actionsVisible=this.actionsVisible,t.props.itemSettings=this.itemSettings,t.props.selected=this.selected.includes(e),t.props.actions=()=>this.getItemPropsActions(i,t),t.on||(t.on={}),t.on.action=this.actionHandler,t.on["item-click"]=this.itemClickHandler,t.dataHandler=(e,t,i)=>(this.autoscroll=!1,this.getLogValueOfProp(e.data,t.data))},getItemPropsActions(e,t){const i=this.selected.length>1?E["a"]:E["b"],s=[...this.config.actions.filter((e=>e.mode===i))];return e.error_text&&e.traffic&&s.push({icon:"mdi-alert-outline",label:"View error traffic",classes:"",type:"to-error-traffic"}),s.push({icon:"mdi-function",label:"Test expression",classes:"",type:"expression"}),s},async getMessages(){this.to<=Date.now()?await this.$store.dispatch(`${this.moduleName}/get`):(await this.$store.dispatch(`${this.moduleName}/getHistory`,1e3),this.scrollTo(this.messages.length-1))},scrollTo(e){this.$nextTick((()=>this.$refs.scrollList&&this.$refs.scrollList.scrollTo(e)))},scrollToWithSavePadding(e){this.$nextTick((()=>this.$refs.scrollList&&this.$refs.scrollList.scrollToWithSavePadding(e)))},scrollHandler({event:e,data:t}){const i=Math.floor(t.start+(t.end-t.start)/4),s=this.messages[i],a=s.timestamp;this.scrollTimestamp=a,this.debouncedUpdateMessagesRoute({},!0)},updateSelectedRoute(e){this.updateMessagesRoute({selected:e})},resetParams(){this.$refs.scrollList&&this.$refs.scrollList.resetParams()},processQuery(e){if(!this.isInit)return!1;if(e)try{e=JSON.parse(e);let t=!1;(!this.filter&&e.filter||this.filter&&!e.filter||this.filter&&e.filter&&this.filter!==e.filter)&&(this.realtimeEnabled&&this.$store.dispatch(`${this.moduleName}/unsubscribePooling`),this.filter=e.filter||null,t=!0),this.from===1e3*e.from&&this.to===1e3*e.to||(this.from=1e3*e.from,this.to=1e3*e.to,t=!0),t&&(this.$store.commit(`${this.moduleName}/clearMessages`),this.$store.dispatch(`${this.moduleName}/get`).then((()=>this.scrollTo(0))))}catch(t){}},filterChangeHandler(e){this.filter!==e&&this.updateMessagesRoute({filter:e||void 0})},updateColsHandler(e){this.cols=e},dateRangeChangeHandler(e){const t=e[0],i=e[1];if(this.from===t&&this.to===i)return!1;this.updateMessagesRoute({from:t/1e3,to:i/1e3})},paginationPrevChangeHandler(){this.$store.dispatch(`${this.moduleName}/getPrevPage`).then((e=>{e&&"number"===typeof e&&this.scrollToWithSavePadding(e)}))},paginationNextChangeHandler(){this.$store.dispatch(`${this.moduleName}/getNextPage`).then((e=>{this.autoscroll=!0,e&&"number"===typeof e&&this.scrollTo(this.messages.length-e)}))},actionHandler({index:e,type:t,content:i}){switch(this.selected.length>1&&(i=this.selected.map((e=>this.messages[e]))),t){case"view":this.itemClickHandler({index:e,content:i});break;case"copy":this.copyMessageHandler({index:e,content:i});break;case"traffic":this.$emit("to-traffic",{index:e,content:i});break;case"to-error-traffic":this.$emit("to-error-traffic",{index:e,content:i});break;case"expression":this.showExprTest(this.$store.state.token,this.cols.schemas[this.cols.activeSchema].cols,this.selected.map((e=>this.messages[e])));break;case"error-report":{const e=Math.floor(i.timestamp);let t=e-10,s=e+2,a=`${window.location.href.split("?")[0]}`;t=e-120,s=e+2,a+=`?from=${t}&to=${s}&logs=${encodeURI(JSON.stringify({scroll:i.timestamp,selected:[i.timestamp]}))}`,"channels"===this.entityName&&i.ident&&(a+=`&messages=${encodeURI(JSON.stringify({filter:`ident="${i.ident}"`}))}`),this.$integrationBus.send("errorReport",{data:i,description:this.getLogDescriptionByItem(i),type:"log",entity:{type:this.entityName,id:this.item.id},url:a});break}}},copyMessageHandler({index:e,content:t}){Object(n["a"])(JSON.stringify(t)).then((e=>{this.$q.notify({type:"positive",icon:"content_copy",message:"Log object copied",timeout:1e3})}),(e=>{this.$q.notify({type:"negative",icon:"content_copy",message:"Error coping log",timeout:1e3})}))},actionToBottomHandler(){this.realtimeEnabled?(this.autoscroll=!0,this.scrollTo(this.messages.length-1)):this.$store.dispatch(`${this.moduleName}/getHistory`,1e3).then((()=>{this.scrollTo(this.messages.length-1)}))},async actionToNewMessages(){this.hasNewMessages=null;const e=Date.now(),t=new Date(e).setHours(0,0,0,0),i=t+86399999.999;this.from=t,this.to=i,this.$store.commit(`${this.moduleName}/clearMessages`),this.getMessages()},actionToNewMessagesHide(){this.hasNewMessages=null},itemClickHandler({index:e,content:t,event:i}){this.selected=this.multiselectProcess({index:e,event:i,selected:this.selected});const s=this.selected.map((e=>this.messages[e]));this.$emit("view-log-message",s)},async changeCid(){await this.$store.dispatch(`${this.moduleName}/unsubscribePooling`),this.$store.commit(`${this.moduleName}/setCid`,this.cid),this.$store.commit(`${this.moduleName}/setItemDeletedStatus`,this.item.deleted),this.$store.commit(`${this.moduleName}/clearMessages`),this.$store.dispatch(`${this.moduleName}/getCols`,this.config.cols),await this.$store.dispatch(`${this.moduleName}/initTime`),await this.$store.dispatch(`${this.moduleName}/get`)},unselect(){this.selected.length&&(this.selected=[])},nextSelect(){if(this.selected.length){const e=this.selected.slice(-1)[0],t=e+1;this.processSelected(t)}},prevSelect(){if(this.selected.length){const e=this.selected[0],t=e-1;this.processSelected(t)}},processSelected(e){const t=this.messages[e];if(t){this.selected=[e];const i=t;Object.defineProperty(i,"x-flespi-description",{value:`<div style="font-size: 1.1rem">${i.event_code}: ${this.getLogDescriptionByItem(i)}</div><div style="font-size: .9rem">${o["a"].formatDate(1e3*i.timestamp,"DD/MM/YYYY HH:mm:ss")}</div>`,enumerable:!1}),Object.defineProperty(i,"x-flespi-color",{value:`text-${this.getLogItemColorByLogEntry(i)}`,enumerable:!1}),this.$emit("action-select",{index:e,content:i}),this.scrollTo(e)}},async getMessagesStartedBy(e){e*=1e3;const t={from:e/1e3,to:e/1e3,filter:this.filter||void 0,count:this.currentLimit},i=await this.$store.dispatch(`${this.moduleName}/getLogs`,t),s={from:this.from/1e3,to:(e-.001)/1e3,reverse:!0,filter:this.filter||void 0,count:this.currentLimit/2-i.length},a={from:(e+.001)/1e3,to:this.to/1e3,filter:this.filter||void 0,count:this.currentLimit/2-i.length},o=await this.$store.dispatch(`${this.moduleName}/getLogs`,s),n=await this.$store.dispatch(`${this.moduleName}/getLogs`,a),r=[...o.reverse(),...i,...n];this.$store.commit(`${this.moduleName}/limiting`,{type:"init",count:r.length}),this.$store.commit(`${this.moduleName}/setHistoryMessages`,r);const l=o.length;this.scrollTo(l)},routeConfigProcess(e={}){const t={};try{e=JSON.parse(e)}catch(i){}return e.filter&&(t.filter=e.filter),e.from&&e.to?(t.from=1e3*e.from,t.to=1e3*e.to):this.$route.query.from&&this.$route.query.to&&(t.from=1e3*this.$route.query.from,t.to=1e3*this.$route.query.to),e.scroll&&(this.scrollTimestamp=e.scroll,t.initTimestamp=e.scroll),e.selected&&(t.selected=e.selected,t.initTimestamp=e.selected[0]),t},async init(){if(this.$store.state[this.moduleName]?this.$store.commit(`${this.moduleName}/clear`):this.$store.registerModule(this.moduleName,Object(c["f"])({Vue:m["default"],LocalStorage:this.$q.localStorage,name:{name:this.moduleName,lsNamespace:"flespi-toolbox-settings.cols"},errorHandler:e=>{this.$store.commit("reqFailed",e)}})),this.$store.state.logsObject||await this.$store.dispatch("initLogsObject"),this.currentLimit=this.limit,this.cid&&this.$store.commit(`${this.moduleName}/setCid`,this.cid),this.item){let{from:e,to:t,filter:i,initTimestamp:s,selected:a}=this.routeConfigProcess(this.$route.query.logs);this.filter=i,this.$store.commit(`${this.moduleName}/setOrigin`,this.originByPattern),this.$store.commit(`${this.moduleName}/setItemDeletedStatus`,this.item&&this.item.deleted),await this.$store.dispatch(`${this.moduleName}/getCols`,this.config.cols),e&&t?(this.from=e,this.to=t,s?await this.getMessagesStartedBy(s):await this.getMessages()):(await this.$store.dispatch(`${this.moduleName}/initTime`),await this.getMessages()),this.initSelectedByTimestamps(a)}this.updateMessagesRoute({},!0),this.isInit=!0},initSelectedByTimestamps(e){if(e){const{indexes:t,messages:i}=this.messages.reduce(((t,i,s)=>(e.includes(i.timestamp)&&(t.messages.push(i),t.indexes.push(s)),t)),{indexes:[],messages:[]});this.selected=t,this.$emit("view-log-message",i)}},updateMessagesRoute(e={},t=!1){const i={filter:this.filter||void 0,from:this.from/1e3,to:this.to/1e3,scroll:this.scrollTimestamp,selected:this.selectedMessagesTimestamps,...e};this.updateRoute({query:{logs:JSON.stringify(i)}},t)}},watch:{item(e,t){(!t||t&&e.id!==t.id)&&(this.origin=this.originByPattern)},limit(e){this.currentLimit=e},cid(){this.changeCid()},$route(e){this.processRoute({logs:this.processQuery},e)}},created(){this.debouncedUpdateMessagesRoute=l()(this.updateMessagesRoute,500,{trailing:!0,maxWait:1e3}),this.init(),this.offlineHandler=m["default"].connector.socket.on("offline",(()=>{this.$store.commit(`${this.moduleName}/setOffline`)})),this.connectHandler=m["default"].connector.socket.on("connect",(()=>{this.$store.state[this.moduleName].offline&&(this.$store.commit(`${this.moduleName}/setReconnected`),this.realtimeEnabled&&this.$store.dispatch(`${this.moduleName}/getMissedMessages`),this.$store.commit(`${this.moduleName}/clearOfflineState`))}))},beforeDestroy(){this.$store.dispatch(`${this.moduleName}/unsubscribePooling`),void 0!==this.offlineHandler&&m["default"].connector.socket.off("offline",this.offlineHandler),void 0!==this.connectHandler&&m["default"].connector.socket.off("connect",this.connectHandler),this.$store.commit(`${this.moduleName}/clear`)},mixins:[h,I["a"],L["a"],A["a"]],components:{VirtualScrollList:c["b"],EmptyPane:D["a"],LogsFilterMenu:O}},B=j,W=Object(b["a"])(B,s,a,!1,null,null,null);t["a"]=W.exports},"39af":function(e,t,i){},"3a57":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("span",{class:{"text-white":void 0!==e.inverted}},[e._v(e._s(Array.isArray(e.data)?"[":"{"))]),e._l(e.data,(function(t,s,a){var o;return i("div",{key:s+"-"+a,staticClass:"margin-left"},[t&&"object"===typeof t?i("div",[i("div",{staticClass:"cursor-pointer",on:{click:function(t){e.toggle(Array.isArray(e.data)?s:a)}}},[i("span",{class:[e.theme.label]},[e._v(e._s(s))]),i("span",{class:{"text-white":void 0!==e.inverted}},[e._v(" : "+e._s(Array.isArray(t)?"Array ["+t.length+"]":"Object"))]),e.showObj[Array.isArray(e.data)?s:a]?i("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:void 0!==e.inverted?"white":"grey-9",name:"mdi-menu-down"}}):i("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{color:void 0!==e.inverted?"white":"grey-9",name:"mdi-menu-right"}})],1),e.showObj[Array.isArray(e.data)?s:a]?i("json-tree",{staticClass:"margin-left",attrs:{data:t,inverted:e.inverted}}):e._e()],1):i("div",[i("span",{class:[e.theme.label]},[e._v(e._s(s))]),i("span",{class:{"text-white":void 0!==e.inverted}},[e._v(" : ")]),i("pre",{staticClass:"json-tree__field-value",class:(o={},o[e.theme.typeNumberOrBool]="number"===typeof t||"boolean"===typeof t,o[e.theme.typeString]="string"===typeof t,o[e.theme.typeEmpty]="undefined"===typeof t||null===t,o)},[e._v(e._s(JSON.stringify(t)))])])])})),i("span",{class:{"text-white":void 0!==e.inverted}},[e._v(e._s(Array.isArray(e.data)?"]":"}"))])],2)},a=[],o=i("2b0e"),n={name:"json-tree",props:{data:[Object,Array],inverted:{type:Boolean,default(){return!0}}},data(){const e=[],t=Object.keys(this.data).length;for(let i=0,s=t;i<s;i++)e.push(!0);return{showObj:e}},computed:{theme(){return void 0!==this.inverted?{label:"text-pink-4",typeString:"text-red-3",typeNumberOrBool:"text-blue-3",typeEmpty:"text-grey-5"}:{label:"text-pink-8",typeString:"text-red-6",typeNumberOrBool:"text-blue-6",typeEmpty:"text-grey-6"}}},methods:{toggle(e){o["default"].set(this.showObj,e,!this.showObj[e])}}},r=n,l=(i("739a"),i("2877")),c=i("0016"),d=i("eebe"),h=i.n(d),m=Object(l["a"])(r,s,a,!1,null,null,null);t["a"]=m.exports;h()(m,"components",{QIcon:c["a"]})},"3ba5":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-item",{staticClass:"bg-grey-9"},[i("q-item-section",[i("q-item-label",{staticClass:"q-pa-none bg-white full-width skeleton--modificator",staticStyle:{height:"16px"},attrs:{header:""}}),i("q-item-label",{staticClass:"bg-grey-6  full-width skeleton--modificator",staticStyle:{height:"15px"},attrs:{caption:""}})],1),i("q-item-section",{staticStyle:{width:"30%"},attrs:{side:""}},[i("div",{staticClass:"bg-white full-width skeleton--modificator",staticStyle:{height:"16px"}})])],1)},a=[],o=(i("2724"),i("2877")),n=i("66e5"),r=i("4074"),l=i("0170"),c=i("eebe"),d=i.n(c),h={},m=Object(o["a"])(h,s,a,!1,null,null,null);t["a"]=m.exports;d()(m,"components",{QItem:n["a"],QItemSection:r["a"],QItemLabel:l["a"]})},4596:function(e,t,i){"use strict";var s=i("bd4c"),a=i("9b02"),o=i.n(a),n=i("3a57"),r=i("b57c");t["a"]={data(){return{isWidgetsLogsActive:!1,widgetsViewedLog:null}},computed:{fieldsLogsMetaData(){const e=o()(this.$refs,"logs.cols",void 0);let t={};if(e){const i=Object.values(e.enum),s=o()(this.$refs,"logs.$refs.scrollList.activeCols",[]).reduce(((e,t)=>(e[t.name]={...t,display:!0},e)),{});i&&(t=i.reduce(((e,t)=>(e[t.name]={...t,display:!!s[t.name]},e)),{}),t={...s,...t})}return t},logsWidgetsViewConfig(){const e=this.widgetsViewedLog;let t={};return e&&(t={"log object":{title:"log object",description:e["x-flespi-description"],wrapper:n["a"],data:e,descriptionAction:e.traffic?{handler:this.logsWidgetDescriptionActionHandler,type:"to-error-traffic",title:"View error traffic",icon:"mdi-alert-outline",color:"red"}:void 0},object:{title:"Fields",description:e["x-flespi-description"],wrapper:r["a"],meta:this.fieldsLogsMetaData,action:this.logsWidgetActionHandler,data:e}},e.item_data&&(t.item_data={title:"item data",wrapper:n["a"],data:e.item_data}),e.http_data&&(t.http_data={title:"http data",wrapper:n["a"],data:e.http_data}),e.properties&&(t.properties={title:"properties",wrapper:n["a"],data:e.properties}),e.pending&&(t.pending={title:"pending",wrapper:n["a"],data:e.pending}),e.current&&(t.current={title:`${e.name} [${s["a"].formatDate(1e3*e.timestamp,"HH:mm:ss")}]`,wrapper:n["a"],data:e.current})),t}},methods:{viewWidgetsLogHandler(e){if(Array.isArray(e)&&1!==e.length)return this.isWidgetsLogsActive=!1,!1;e=e[0],this.widgetsViewedLog=e,this.beforeEnableWidgetByPane&&this.beforeEnableWidgetByPane("logs"),this.isWidgetsLogsActive=!0,this.activateWidgetWindow("logsView")},closeLogsWidgetsHandler(){this.$refs.logs&&this.$refs.logs.unselect()},nextWidgetLog(){this.$refs.logs.nextSelect()},prevWidgetLog(){this.$refs.logs.prevSelect()},logsWidgetActionHandler({type:e,data:t}){const i=o()(this.$refs.logs.$refs,"scrollList",void 0);if(i)switch(e){case"col-add":i.addCustomColumnHandler(t);break;case"col-remove":i.removeCustomColumnHandler(t);break}},logsWidgetDescriptionActionHandler({type:e,data:t}){switch(e){case"to-error-traffic":this.toErrorTrafficHandler({content:t})}}}}},5110:function(e,t,i){},"5c16":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.visible?i("widget-window",{ref:"widgetWrapper",style:{zIndex:e.isFullScreen?5:e.active?3:2},attrs:{"wrapper-size":e.wrapperSize,controls:e.controls,"view-model":e.$q.platform.is.desktop&&e.$q.screen.width>500?e.viewModel:e.fullScreenModel},on:{close:e.closeHandler,dragging:function(t){return e.$emit("active")},"change-view-model":e.changeViewModelHandler}},[i("q-tabs",{staticClass:"text-white",style:{width:e.isModified?"calc(100% - 66px)":e.$q.platform.is.mobile?"calc(100% - 33px)":"",height:e.isModified?"50px":""},attrs:{value:e.tabModel,dense:!e.isModified,"outside-arrows":""},on:{input:e.setTab}},[e._l(e.config,(function(e,t){return[i("q-tab",{key:"tab-"+t,attrs:{name:t,label:e.title,color:"grey-9",icon:e.titleIcon}})]}))],2),i("div",{staticClass:"bg-grey-8 scroll relative-position",style:{height:e.isModified?"calc(100% - 50px)":"calc(100% - 40px)",width:"calc(100% - 4px)"}},e._l(e.config,(function(t,s){return i("q-tab-panel",{directives:[{name:"show",rawName:"v-show",value:e.tabModel===s,expression:"tabModel === key"}],key:"tab-pane-"+s,attrs:{name:s}},[t.description?i("div",[i("div",{staticClass:"text-center text-bold q-mb-sm text-white",class:[t.data["x-flespi-color"]],staticStyle:{"font-size":"1rem",width:"calc(100% - 35px)"},domProps:{innerHTML:e._s(t.description)}}),i("q-btn",{staticClass:"absolute",staticStyle:{top:"5px",right:"5px"},attrs:{color:"grey-1",flat:"",dense:"",icon:"mdi-content-copy"},on:{click:function(i){return e.copyMessageHandler({content:t.data})}}},[i("q-tooltip",[e._v("Copy data")])],1),t.descriptionAction?i("q-btn",{staticClass:"absolute",staticStyle:{top:"38px",right:"5px"},attrs:{color:t.descriptionAction.color,flat:"",dense:"",icon:t.descriptionAction.icon},on:{click:function(e){return t.descriptionAction.handler({type:"to-error-traffic",data:t.data})}}},[i("q-tooltip",[e._v(e._s(t.descriptionAction.title))])],1):e._e()],1):e._e(),t.wrapper&&"object"===typeof t.wrapper?i(t.wrapper,{ref:s,refInFor:!0,tag:"component",attrs:{data:t.data,meta:t.meta,inverted:e.inverted},on:{action:function(e){t.action&&t.action(e)}}}):t.wrapper&&"string"===typeof t.wrapper?i(t.wrapper,{ref:s,refInFor:!0,tag:"component",class:{"text-white":void 0!==e.inverted}},[e._v(e._s(t.data))]):i("div",{ref:s,refInFor:!0,class:{"text-white":void 0!==e.inverted}},[e._v(e._s(t.data))])],1)})),1),i("div",{staticClass:"widget-window__actions"},e._l(e.actions,(function(t){return i("q-icon",{key:t.name,staticClass:"pull-right cursor-pointer",attrs:{name:t.icon,size:"30px",color:"white"},on:{click:function(i){return e.$emit(t.name)}}},[i("q-tooltip",[e._v(e._s(t.label))])],1)})),1)],1):e._e()},a=[],o=(i("e9c4"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("vue-draggable-resizable",{ref:"dragResize",staticClass:"widget__wrapper absolute-top-left absolute-bottom-right",class:[e.isMinimized||e.isMaximized?"widget--pinned":""],style:e.wrapperStyles,attrs:{"drag-cancel":".widget--drag-stop",parent:!0,active:!0,x:e.x,y:e.y,w:e.width,h:e.height,"min-width":100,"min-height":100},on:{resizing:e.resizeHandler,dragging:e.draggingHandler}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.isMinimized&&!e.isMaximized,expression:"!isMinimized && !isMaximized"}],staticClass:"widget__header",style:{height:e.headerHeight+"px"}},[i("q-icon",{staticClass:"float-right cursor-pointer",attrs:{name:"mdi-close",color:"white"},nativeOn:{mousedown:function(t){return t.stopPropagation(),t.preventDefault(),e.closeHandler.apply(null,arguments)}}}),i("q-icon",{staticClass:"float-right cursor-pointer",attrs:{name:e.isMaximized?"mdi-fullscreen-exit":"mdi-fullscreen",color:"white"},nativeOn:{mousedown:function(t){t.stopPropagation(),t.preventDefault(),e.maximizeHandler(),e.calculateViewModel()}}}),e.controls.minimizeLeft?i("q-icon",{staticClass:"float-right cursor-pointer",attrs:{name:"mdi-arrow-collapse-right",color:"white"},nativeOn:{mousedown:function(t){t.stopPropagation(),t.preventDefault(),e.minimizeHandler("left"),e.calculateViewModel()}}}):e._e(),e.controls.minimizeRight?i("q-icon",{staticClass:"float-right cursor-pointer",attrs:{name:"mdi-arrow-collapse-left",color:"white"},nativeOn:{mousedown:function(t){t.stopPropagation(),t.preventDefault(),e.minimizeHandler("right"),e.calculateViewModel()}}}):e._e()],1),i("div",{staticClass:"widget__content widget--drag-stop relative-position",style:e.styles},[e._t("default")],2),e.isMinimized||e.isMaximized?i("div",{staticClass:"widget__custom-controls widget--drag-stop",style:{top:e.isMaximized?"3px":""}},[(e.isMinimized||e.isMaximized)&&e.$q.platform.is.desktop&&e.$q.screen.width>500?i("q-icon",{staticClass:"pull-right cursor-pointer",attrs:{name:"mdi-window-restore",size:"25px",color:"white"},nativeOn:{mousedown:function(t){return t.stopPropagation(),t.preventDefault(),e.restoreHandler.apply(null,arguments)}}}):e._e(),i("q-icon",{staticClass:"pull-right cursor-pointer",attrs:{name:"mdi-close",size:"25px",color:"white"},nativeOn:{mousedown:function(t){return t.stopPropagation(),t.preventDefault(),e.closeHandler.apply(null,arguments)}}})],1):e._e()])}),n=[],r=i("fb19"),l=i.n(r),c=i("b047c"),d=i.n(c),h={name:"widget-float-window",props:["controls","wrapperSize","viewModel"],data(){return{height:520,width:500,prevWidth:0,prevHeight:0,prevX:0,prevY:0,headerHeight:20,x:50,y:50,isMinimized:!1,isMaximized:!1,minimizeTo:""}},computed:{styles(){return{width:`${this.width}px`,height:this.height-(this.isMinimized||this.isMaximized?0:this.headerHeight)+"px"}},wrapperStyles(){return{width:`${this.width}px`,height:`${this.height}px`,position:"absolute",backgroundColor:"#666"}}},methods:{closeHandler(){this.$emit("close"),this.isMinimized&&(this.minimizeTo="",this.isMinimized=!1),this.isMaximized&&(this.isMaximized=!1)},maximizeHandler(){this.prevWidth=this.width,this.prevHeight=this.height,this.prevX=this.x,this.prevY=this.y,this.maximize()},minimizeHandler(e){this.prevWidth=this.width,this.prevHeight=this.height,this.isMinimized=!0,this.minimizeTo=e,this.isMaximized&&(this.isMaximized=!1)},restoreHandler(){this.isMinimized=!1,this.isMaximized=!1,this.minimizeTo="",this.x=this.prevX||50,this.y=this.prevY||50,this.width=this.prevWidth||500,this.height=this.prevHeight||520,this.calculateViewModel()},minimize(e){const t=this.wrapperSize.width,i=this.wrapperSize.height;switch(this.width=300,this.height=i-50,e){case"left":this.$nextTick((()=>{this.x=t-300,this.y=i-this.height}));break;case"right":this.$nextTick((()=>{this.x=0,this.y=50}));break}},maximize(){const e=this.wrapperSize.width,t=this.wrapperSize.height;this.width=e,this.height=t,this.$nextTick((()=>{this.x=0,this.y=0})),this.isMinimized&&(this.minimizeTo="",this.isMinimized=!1),this.isMaximized=!0},resizeHandler(e,t,i,s){this.width=i,this.height=s,this.calculateViewModel()},onWindowResize(e){if(this.$refs.dragResize.checkParentSize(),this.isMinimized)this.minimize(this.minimizeTo);else if(this.isMaximized)this.maximize();else{if(this.wrapperSize.width>e.width){let t=this.x,i=this.wrapperSize.width-e.width;t+this.width>=this.wrapperSize.width-30&&(t&&(t-=i,t<0&&(i=-1*t,t=0),this.x=t),0===t&&(this.width-=i,this.width<100&&(this.width=100)))}if(this.wrapperSize.height>e.height){let t=this.y,i=this.wrapperSize.height-e.height;t+this.height>=this.wrapperSize.height-30&&(t&&(t-=i,t<0&&(i=-1*t,t=0),this.x=t),0===t&&(this.height-=i,this.height<100&&(this.height=100)))}}this.calculateViewModel()},draggingHandler(e,t){this.isMinimized&&(this.minimizeTo="",this.isMinimized=!1),this.isMaximized&&(this.isMaximized=!1),this.x=e,this.y=t,this.$emit("dragging"),this.calculateViewModel()},applyViewModel(e){if(!e)return!1;"minimized"!==e.type||this.isMinimized?"maximized"!==e.type||this.isMaximized?"windowed"===e.type&&(this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height):this.maximizeHandler():this.minimizeHandler(e.to)}},mounted(){this.$q.platform.is.mobile&&this.maximizeHandler(),this.applyViewModel(this.viewModel)},created(){this.calculateViewModel=d()((()=>{const e={};this.isMinimized?(e.type="minimized",e.to=this.minimizeTo):this.isMaximized?e.type="maximized":(e.type="windowed",e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height),this.$emit("change-view-model",e)}),150)},watch:{minimizeTo(e){e?this.minimize(e):(this.width=this.prevWidth,this.height=this.prevHeight)},wrapperSize(e){this.onWindowResize(e)},viewModel(e){this.applyViewModel(e)}},components:{VueDraggableResizable:l.a}},m=h,p=(i("8af3"),i("2877")),u=i("0016"),g=i("eebe"),f=i.n(g),v=Object(p["a"])(m,o,n,!1,null,null,null),b=v.exports;f()(v,"components",{QIcon:u["a"]});var y=i("cdde"),w=i("9b02"),x=i.n(w),_=i("6126"),$={props:["config","inverted","value","actions","active","controls","viewModel"],data(){return{prevTab:void 0,tabModel:null,visible:!1,isModified:!1,isFullScreen:!1,wrapperSize:{},fullScreenModel:{type:"maximized"}}},computed:{tabNames(){return Object.keys(this.config)}},methods:{ref(e){return x()(this.$refs[e],0,void 0)},show(){this.visible=!0},hide(){this.visible=!1},setTab(e){this.prevTab=void 0,this.tabModel=e,this.updateRoute({query:{widget_tab:e}})},minimizeHandler(e){this.isModified=!!e},maximizeHandler(e){this.isFullScreen=e},minimize(e){this.$refs.widgetWrapper&&this.$refs.widgetWrapper.minimizeHandler(e)},escHandler(e){27===e.keyCode&&this.active&&this.closeHandler()},closeHandler(){this.$emit("input",!1),this.$emit("close"),this.updateRoute({query:{widget_tab:void 0}})},resize(e){this.wrapperSize=e},changeViewModelHandler(e){switch(e.type){case"minimized":this.minimizeHandler({type:e.to});break;case"maximized":this.maximizeHandler(!0);break;case"windowed":this.minimizeHandler(),this.maximizeHandler(!1);break}this.$q.platform.is.desktop&&this.$q.screen.width>500&&this.$emit("change-view-model",e)},getDefaultTab(){let e=this.tabNames[0];return this.tabNames.forEach((t=>{this.config[t].default&&(e=t)})),e},copyMessageHandler({index:e,content:t}){Object(y["a"])(JSON.stringify(t)).then((e=>{this.$q.notify({type:"positive",icon:"content_copy",message:"Data copied",timeout:1e3})}),(e=>{this.$q.notify({type:"negative",icon:"content_copy",message:"Error coping data",timeout:1e3})}))}},components:{WidgetWindow:b},mixins:[_["a"]],watch:{value(e){this.visible=e},config(e){this.prevTab&&(this.setTab(this.prevTab),this.prevTab=void 0),e[this.tabModel]||(this.prevTab=this.tabModel,this.setTab(this.getDefaultTab()))},viewModel(e){this.changeViewModelHandler(e)}},created(){let e=this.$route.query.widget_tab||this.getDefaultTab();this.viewModel&&this.changeViewModelHandler(this.viewModel),window.addEventListener("keyup",this.escHandler),this.setTab(e)},destroyed(){window.removeEventListener("keyup",this.escHandler)}},k=$,C=(i("9df9"),i("429b")),M=i("7460"),S=i("823b"),q=i("9c40"),H=i("05c0"),N=Object(p["a"])(k,s,a,!1,null,null,null);t["a"]=N.exports;f()(N,"components",{QTabs:C["a"],QTab:M["a"],QTabPanel:S["a"],QBtn:q["a"],QTooltip:H["a"],QIcon:u["a"]})},"5de8":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-dialog",{ref:"modal",attrs:{maximized:e.$q.platform.is.mobile,"no-esc-dismiss":e.loadingFlag,"no-backdrop-dismiss":e.loadingFlag,"no-route-dismiss":""}},[i("q-card",{staticClass:"bg-grey-9",style:{minWidth:e.$q.platform.is.mobile?"100%":"310px",height:e.$q.platform.is.mobile?"100%":"auto"}},[i("q-card-section",{staticClass:"q-pa-sm",style:{height:"calc(100% - 54px)"}},[i("date-range-picker",{attrs:{theme:{color:"white",bgColor:"grey-9",contentInverted:!0,controlsInverted:!0}},model:{value:e.currentDateRange,callback:function(t){e.currentDateRange=t},expression:"currentDateRange"}}),i("q-select",{attrs:{options:e.selectOpts,multiple:"",dark:"",outlined:"",label:"Format","hide-bottom-space":"",dense:"",color:"white","bg-color":"grey-9"},model:{value:e.currentFormat,callback:function(t){e.currentFormat=t},expression:"currentFormat"}}),i("q-toggle",{attrs:{dark:""},model:{value:e.needTimeConvert,callback:function(t){e.needTimeConvert=t},expression:"needTimeConvert"}},[i("span",{staticClass:"text-white"},[e._v("Format timestamps")])]),e.needTimeConvert?[i("q-input",{staticClass:"q-mb-sm",attrs:{outlined:"",dense:"",label:"Date format",dark:"",color:"white"},model:{value:e.timeFormat,callback:function(t){e.timeFormat=t},expression:"timeFormat"}}),i("q-select",{attrs:{options:e.timezoneOptions,"emit-value":"","map-options":"",dark:"",outlined:"",label:"Timezone","hide-bottom-space":"",dense:"",color:"white","bg-color":"grey-9"},model:{value:e.timezoneOffset,callback:function(t){e.timezoneOffset=t},expression:"timezoneOffset"}})]:e._e()],2),i("q-separator",{attrs:{color:"grey-8"}}),i("q-card-actions",{staticClass:"bg-grey-9 text-white",attrs:{align:"right"}},[i("q-btn",{attrs:{flat:"",disable:e.loadingFlag},on:{click:e.hide}},[e._v("Close")]),i("q-btn",{attrs:{flat:"",disable:e.loadingFlag||e.currentFormat.length<1,loading:e.loadingFlag},on:{click:e.exportHandler}},[e._v("Export")])],1)],1)],1)},a=[],o=(i("e9c4"),i("ddb0"),i("2b3d"),i("9861"),i("a99f")),n=i("c423"),r=i("bd4c"),l={props:["format","dateRange","config","ident","itemId"],data(){return{currentFormat:[this.format],currentDateRange:this.dateRange.map((e=>new Date(e))),moduleName:this.config.vuexModuleName,loadingFlag:!1,selectOpts:["hex","text","base64"],needTimeConvert:!1,timeFormat:"YYYY/MM/DD HH:mm:ss.SSS",currentTimezoneOffset:-(new Date).getTimezoneOffset()/60,timezoneOffset:"local",timezoneOptions:[{value:"local",label:"Local time (computer`s timezone)"},{value:-12,label:"(GMT -12:00) Eniwetok, Kwajalein"},{value:-11,label:"(GMT -11:00) Midway Island, Samoa"},{value:-10,label:"(GMT -10:00) Hawaii"},{value:-9,label:"(GMT -9:00) Alaska"},{value:-8,label:"(GMT -8:00) Pacific Time (US &amp; Canada)"},{value:-7,label:"(GMT -7:00) Mountain Time (US &amp; Canada)"},{value:-6,label:"(GMT -6:00) Central Time (US &amp; Canada), Mexico City"},{value:-5,label:"(GMT -5:00) Eastern Time (US &amp; Canada), Bogota, Lima"},{value:-4,label:"(GMT -4:00) Atlantic Time (Canada), Caracas, La Paz"},{value:-3.5,label:"(GMT -3:30) Newfoundland"},{value:-3,label:"(GMT -3:00) Brazil, Buenos Aires, Georgetown"},{value:-2,label:"(GMT -2:00) Mid-Atlantic"},{value:-1,label:"(GMT -1:00 hour) Azores, Cape Verde Islands"},{value:0,label:"(GMT) Western Europe Time, London, Lisbon, Casablanca"},{value:1,label:"(GMT +1:00 hour) Brussels, Copenhagen, Madrid, Paris"},{value:2,label:"(GMT +2:00) Kaliningrad, South Africa"},{value:3,label:"(GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg"},{value:3.5,label:"(GMT +3:30) Tehran"},{value:4,label:"(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi"},{value:4.5,label:"(GMT +4:30) Kabul"},{value:5,label:"(GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent"},{value:5.5,label:"(GMT +5:30) Bombay, Calcutta, Madras, New Delhi"},{value:5.75,label:"(GMT +5:45) Kathmandu"},{value:6,label:"(GMT +6:00) Almaty, Dhaka, Colombo"},{value:7,label:"(GMT +7:00) Bangkok, Hanoi, Jakarta"},{value:8,label:"(GMT +8:00) Beijing, Perth, Singapore, Hong Kong"},{value:9,label:"(GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk"},{value:9.5,label:"(GMT +9:30) Adelaide, Darwin"},{value:10,label:"(GMT +10:00) Eastern Australia, Guam, Vladivostok"},{value:11,label:"(GMT +11:00) Magadan, Solomon Islands, New Caledonia"},{value:12,label:"(GMT +12:00) Auckland, Wellington, Fiji, Kamchatka"}]}},methods:{show(){this.$refs.modal.show()},hide(){this.$refs.modal.hide()},formatData(e,t){let i=null;return i="hex"===t?this.base64ToHex(e):"text"===t?this.base64ToTextWithMnemoReplacing(e):e,i},dateByTimezone(e,t){const i=new Date(e),s=i.getTime(),a=6e4*i.getTimezoneOffset(),o=s+a,n=36e5*t,r=o+n;return new Date(r)},async exportHandler(){this.loadingFlag=!0;const e={from:Math.floor(this.currentDateRange[0].valueOf()/1e3),to:Math.floor(this.currentDateRange[1].valueOf()/1e3)+.999999},t=await this.$store.dispatch(`${this.moduleName}/getExportData`,e);t.forEach(((e,i)=>{if(this.needTimeConvert){const e=this.timeFormat||"YYYY/MM/DD HH:mm:ss.SSS";"local"===this.timezoneOffset?t[i].timestamp=r["a"].formatDate(1e3*t[i].timestamp,e):t[i].timestamp=r["a"].formatDate(this.dateByTimezone(1e3*t[i].timestamp,this.timezoneOffset),e)}if(!t[i].data)return!1;this.currentFormat.forEach((s=>{t[i][s]=this.formatData(e.data,s)})),t[i].data=void 0}));const i="application/json",s=document.createElement("a"),a=JSON.stringify(t,void 0,2),o=new Blob([a],{type:i}),n=URL.createObjectURL(o),l=`[${r["a"].formatDate(this.currentDateRange[0],"DD.MM.YYYY HH-mm-ss")} - ${r["a"].formatDate(this.currentDateRange[1],"DD.MM.YYYY HH-mm-ss")}]`,c="local"===this.timezoneOffset?this.currentTimezoneOffset:this.timezoneOffset,d=`${this.itemId}_${this.ident?`_${this.ident}`:""}${l}_${c>=0?`GMT+${c}`:`GMT${c}`}.json`;s.setAttribute("href",n),s.setAttribute("download",d),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),this.loadingFlag=!1,this.hide()}},watch:{dateRange(e){this.currentDateRange=e.map((e=>new Date(e)))},format(e){this.currentFormat=[e]}},components:{DateRangePicker:o["a"]},mixins:[n["a"]]},c=l,d=i("2877"),h=i("24e8"),m=i("f09f"),p=i("a370"),u=i("ddd8"),g=i("9564"),f=i("27f9"),v=i("eb85"),b=i("4b7e"),y=i("9c40"),w=i("eebe"),x=i.n(w),_=Object(d["a"])(c,s,a,!1,null,null,null);t["a"]=_.exports;x()(_,"components",{QDialog:h["a"],QCard:m["a"],QCardSection:p["a"],QSelect:u["a"],QToggle:g["a"],QInput:f["a"],QSeparator:v["a"],QCardActions:b["a"],QBtn:y["a"]})},6126:function(e,t,i){"use strict";i("5319");t["a"]={methods:{updateRoute(e,t=!1){const i={name:e.name||this.$route.name,path:e.path||this.$route.path,meta:{...this.$route.meta,...e.meta},params:{...this.$route.params,...e.params},query:{...this.$route.query,...e.query}};return t?this.$router.replace(i).catch((e=>{})):this.$router.push(i).catch((e=>{}))},processRoute(e,t){const i=e=>t.params[e]||t.query[e];Array.isArray(e)?e.forEach((e=>{const t=i(e);this[e]!==t&&(this[e]=t)})):Object.keys(e).forEach((t=>{const s=e[t],a=i(t);s(a)}))}}}},6512:function(e,t,i){"use strict";i("e9c4"),i("5319");var s=i("bd4c"),a=i("9b02"),o=i.n(a),n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"image-view__image",style:{backgroundImage:"url("+e.data+")"}})},r=[],l={name:"image-view",props:{data:String,inverted:{type:Boolean,default(){return!0}}}},c=l,d=(i("8616"),i("2877")),h=Object(d["a"])(c,n,r,!1,null,null,null),m=h.exports,p=i("3a57"),u=i("b57c"),g=i("0860");t["a"]={data(){return{isWidgetsMessageActive:!1,widgetsViewedMessage:null}},computed:{fieldsDevicesMetaData(){const e=o()(this.$refs,"messages.cols",void 0);let t={};if(e){const i=Object.values(e.enum),s=o()(this.$refs,"messages.$refs.scrollList.activeCols",[]).reduce(((e,t)=>(e[t.name]={...t,display:!0},e)),{});i&&(t=i.reduce(((e,t)=>(e[t.name]={...t,display:!!s[t.name]},e)),{}),t={...s,...t})}return t},messageWidgetsViewConfig(){const e=this.widgetsViewedMessage,t={};if(e){const i=`${e.ident?`<div style="font-size: 1.1rem">${e.ident}</div>`:""}${e.timestamp?`<div style="font-size: .8rem">${s["a"].formatDate(1e3*e.timestamp,"DD/MM/YYYY HH:mm:ss")}</div>`:""}`;e["position.latitude"]&&e["position.longitude"]&&(t.position={titleIcon:"mdi-map-marker-radius",wrapper:g["a"]}),t.message={title:"JSON",description:i,wrapper:p["a"],data:e},t.object={title:"Fields",description:i,default:!0,wrapper:u["a"],meta:this.fieldsDevicesMetaData,action:this.messagesWidgetActionHandler,data:e},Object.keys(e).forEach((i=>{if(JSON.stringify(e[i]).match(/^data:image\/(?:gif|png|jpeg|bmp|webp)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/)||0===i.indexOf("image.bin.")){let s=e[i];0===i.indexOf("image.bin.")&&(s=`data:image/${i.split(".")[2]};base64,${e[i].replace(/^data:image\/\w*;base64,\s/,"")}`),t[`image{${i}}`]={title:`Image{${i}}`,wrapper:m,data:s}}}))}return t}},methods:{setWidgetsMessageView(e){this.widgetsViewedMessage={...e};const t={latlng:[e["position.latitude"],e["position.longitude"]],direction:e["position.direction"]};this.isWidgetsMessageActive||(this.beforeEnableWidgetByPane&&this.beforeEnableWidgetByPane("messages"),this.isWidgetsMessageActive=!0),this.$nextTick((()=>{const e=this.$refs.messagesView.ref("position");e&&(e.clear(),this.mapExtendConfig&&e.addConfig(this.mapExtendConfig),t&&e.autobounds(!0).addNamedMarkers([t]),e.send())})),this.activateWidgetWindow("messagesView")},messageWidgetsActions(e,t){if(Array.isArray(t.content)&&1!==t.content.length)return this.isWidgetsMessageActive=!1,!1;t.content=t.content[0];this.isWidgetsMessageActive;const i=this.$refs.messagesView;switch(e){case"position":this.setWidgetsMessageView(t.content),i.setTab(e);break;case"show":this.setWidgetsMessageView(t.content),i.setTab("message");break;case"object":this.setWidgetsMessageView(t.content);break;case"select":this.setWidgetsMessageView(t.content);break;case"image":{let e;this.setWidgetsMessageView(t.content),Object.keys(this.messageWidgetsViewConfig).some((t=>{const i=0===t.indexOf("image");return e=t,i})),e&&i.setTab(e);break}case"traffic":this.toTrafficHandler(t);break;case"hex":this.toHexHandler(t);break}},closeMessageWidgetsHandler(){this.$refs.messages&&this.$refs.messages.unselect(),this.trackWidgetMessageMarker&&this.addWidgetTrackMarker("track")},nextWidgetsMessage(){this.$refs.messages.nextSelect()},prevWidgetsMessage(){this.$refs.messages.prevSelect()},messagesWidgetActionHandler({type:e,data:t}){const i=o()(this.$refs.messages.$refs,"scrollList",void 0);if(i)switch(e){case"col-add":i.addCustomColumnHandler(t);break;case"col-remove":i.removeCustomColumnHandler(t);break}}},created(){this.$watch("mapExtendConfig",(e=>{const t=this.$refs.messagesView.ref("position");t&&(t.clear(["polygons","circles","corridors"]),t.addConfig(e),t.send())}))}}},"70a8":function(e,t,i){"use strict";i("aa02")},"739a":function(e,t,i){"use strict";i("e613")},"73bb":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.packets&&e.packets.length?i("div",{staticClass:"traffic-viewer__packets q-pa-sm"},e._l(e.batches,(function(t,s){return i("div",{key:s,staticStyle:{"min-width":"820px"}},[e.batches[s-1]?i("div",{staticClass:"packets__separator",style:{backgroundColor:e.bgDataColors[t.type]}}):e._e(),i("div",{staticClass:"packet__header text-center",style:{backgroundColor:e.bgDataColors[t.type]}},[i("span",{staticClass:"rounded-borders text-white full-height"},[i("q-icon",{staticStyle:{"vertical-align":"text-bottom"},attrs:{size:"1rem",color:e.eventsColors[t.type],name:e.eventIcons[t.type]}}),i("span",{staticClass:"text-uppercase text-white"},[e._v(e._s(e.eventsDesc[t.type]))]),e._v("\n        (\n        "),i("span",{staticClass:"text-white",class:{"q-mr-sm":t.size},staticStyle:{"font-size":".8rem"}},[e._v(e._s(e.date.formatDate(1e3*t.timestamp,"DD/MM/YYYY HH:mm:ss.SSS")))]),t.size?i("span",{staticClass:"q-mr-sm text-white",staticStyle:{"font-size":".8rem"}},[e._v("size: "+e._s(t.size)+"B")]):e._e(),t.transport?i("small",{staticClass:"rounded-borders q-px-xs text-white",class:{"bg-blue":"tcp"===t.transport,"bg-pink-4":"udp"===t.transport,"bg-green-9":"http"===t.transport,"bg-purple-9":"mqtt"===t.transport},staticStyle:{"vertical-align":"middle"}},[e._v("\n          "+e._s(t.transport)+"\n        ")]):e._e(),e._v("\n        )\n      ")],1)]),t.data?i("hex-viewer",{style:{backgroundColor:e.bgDataColors[t.type]},attrs:{hex:t.data,view:e.view}}):e._e(),e.batches[s+1]?i("div",{staticClass:"packets__separator",style:{backgroundColor:e.bgDataColors[t.type]}}):e._e(),e.getNeedMissing(s)?i("div",{staticClass:"packets__missing"},[i("div",{staticClass:"missing__up"}),i("div",{staticClass:"missing__down"})]):e._e()],1)})),0):i("div",{staticStyle:{"text-align":"center",color:"#9e9e9e","font-size":"3rem","padding-top":"40px"}},[e._v("Select packets")])},a=[],o=(i("ddb0"),i("d77f")),n=i("c423"),r=i("bd4c"),l={props:["packets","view"],data(){return{date:r["a"],transports:{2:"tcp",66:"http",67:"http",130:"udp",3:"tcp",131:"udp",32:"mqtt",33:"mqtt",34:"mqtt",35:"mqtt"},eventsColors:{0:"green",32:"green",1:"red",33:"red",2:"purple",130:"purple",66:"purple",34:"purple",3:"yellow",67:"yellow",131:"yellow",35:"yellow"},eventsDesc:{0:"Connect",32:"Connect",1:"Disconnect",33:"Disconnect",2:"Data received",130:"Data received",66:"Data received",34:"Data received",3:"Data sent",67:"Data sent",131:"Data sent",35:"Data sent"},eventIcons:{0:"mdi-lan-connect",32:"mdi-lan-connect",1:"mdi-lan-disconnect",33:"mdi-lan-disconnect",2:"mdi-arrow-right-thick",130:"mdi-arrow-right-thick",66:"mdi-arrow-right-thick",34:"mdi-arrow-right-thick",3:"mdi-arrow-left-thick",67:"mdi-arrow-left-thick",35:"mdi-arrow-left-thick",131:"mdi-arrow-left-thick"},bgDataColors:{0:"rgba(76, 175, 80, 0.4)",32:"rgba(76, 175, 80, 0.4)",1:"rgba(244, 67, 54, 0.4)",33:"rgba(244, 67, 54, 0.4)",2:"rgba(156, 39, 176, 0.4)",130:"rgba(156, 39, 176, 0.4)",34:"rgba(156, 39, 176, 0.4)",66:"rgba(156, 39, 176, 0.4)",3:"rgba(255, 235, 59, 0.4)",67:"rgba(255, 235, 59, 0.4)",35:"rgba(255, 235, 59, 0.4)",131:"rgba(255, 235, 59, 0.4)"}}},computed:{batches(){return this.packets&&this.packets.length?this.packets.reduce(((e,t,i)=>{const s={...t};s.data=this.base64ToHex(t.data),s.index=[s.index],s.transport=this.transports[s.type],s.data&&(s.size=Math.floor(s.data.length/2));const a=e[e.length-1];return a&&a.type===s.type&&2===s.type&&a.conn===s.conn&&a.index[a.index.length-1]+1===s.index[0]?(a.data+=s.data,a.size+=s.size,a.index=[...a.index,...s.index]):e.push(s),e}),[]):[]}},methods:{getNeedMissing(e){const t=this.batches[e],i=this.batches[e+1];return i&&t.index[t.index.length-1]+1<i.index[0]}},mixins:[n["a"]],components:{HexViewer:o["a"]}},c=l,d=(i("aff9"),i("2877")),h=i("0016"),m=i("eebe"),p=i.n(m),u=Object(d["a"])(c,s,a,!1,null,null,null);t["a"]=u.exports;p()(u,"components",{QIcon:h["a"]})},"798f":function(e,t,i){"use strict";i("ddb0"),i("2b3d"),i("9861");var s=i("c423"),a=i("bd4c"),o=i("cdde"),n=i("5a3a"),r=i.n(n),l=i("91c8"),c=i.n(l);t["a"]={mixins:[s["a"]],methods:{getBytesArray(e,t){let i;if("hex"===t){const t=e.match(/.{1,32}/g);i=t.map((e=>e.match(/.{1,2}/g)))}else"text"===t&&(i=e.match(/.{1,2}/g));return i},getAddresses(e){return r()(0,16*e.match(/.{1,32}/g).length,16)},getSelected(e,t){let i=[];return-1!==e&&-1!==t&&(i=e>t?r()(t,e+1):r()(e,t+1)),i},getHeader(e){const t={0:"Connect",1:"Disconnect",2:"Data received",130:"Data received",3:"Data sent",131:"Data sent"};let i="";if(i+=t[e.type],i+="(",i+=a["a"].formatDate(1e3*e.timestamp,"DD/MM/YYYY HH:mm:ss"),e.data){const t=this.base64ToHex(e.data),s=0===e.type||1===e.type?"":e.type>=128?"udp":"tcp";i+=` size: ${Math.floor(t.length/2)}B`,i+=` ${s}`}return i+=")",i},getContent(e,t,i,s=[]){let a="";switch(e){case"hex":if(s.length){const e=t.match(/.{1,2}/g);a=s.map((t=>e[t])).join("")}else a=t;break;case"text":{const e=t.match(/.{1,2}/g),i=s.length?s.map((t=>e[t])):e;a=i.map((e=>String.fromCharCode(parseInt(e,16)))).join("");break}case"view":{const e=this.getBytesArray(t,i);if("text"===i){const t=s.length?s.map((t=>e[t])):e;a=t.map((e=>{let t=this.replaceByteWithMnemo(e);return"0A"===e&&(t+="\n"),t})).join("")}else{const i=s.length,o=c()(Object.keys(t.match(/.{1,2}/g)),16),n=this.getAddresses(t),r=i?o.reduce(((e,t)=>{let i=!0;const a=t.reduce(((e,a,o)=>(a<s[0]||a>s[s.length-1]?e.push(null):(e.push(a),i=!1),o===t.length-1&&(e=i?null:e),e)),[]);return e.push(a),e}),[]):o;r.forEach(((t,i)=>{if(!t)return!1;a+=`${n[i].toString(16).padStart(7,0).toUpperCase()}   `;const s=e[i];let o="",r="";t.forEach(((e,t)=>{e?(o+=s[t],r+=this.replaceByteWithDot(s[t])):(o+="  ",r+=" "),o+=" "})),a+=o,a+="   ",a+="".padEnd(32-2*t.length," "),a+="".padEnd(16-t.length," "),a+=r,a+="\n"}))}break}}return a},copy(e,t="hex"){Object(o["a"])(e).then((e=>{this.$q.notify({type:"positive",icon:"content_copy",message:`${t} copied`,timeout:1e3})}),(e=>{this.$q.notify({type:"negative",icon:"content_copy",message:`Error coping ${t}`,timeout:1e3})}))},exportData(e,t=""){const i="hex"===t?"application/octet-stream":"text/plain",s=document.createElement("a"),a=new Blob([e],{type:i}),o=URL.createObjectURL(a);s.setAttribute("href",o),s.setAttribute("download","data.txt"),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}}}},"79d6":function(e,t,i){"use strict";i("ff12")},8616:function(e,t,i){"use strict";i("b26d")},"8af3":function(e,t,i){"use strict";i("5110")},"8ed9":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-dialog",{ref:"dialog",attrs:{"full-width":"","full-height":"","no-route-dismiss":""},on:{hide:e.onDialogHide}},[i("q-card",{staticClass:"bg-grey-9"},[i("q-card-section",{staticClass:"bg-grey-8 q-pa-sm text-white text-h5",staticStyle:{height:"50px"}},[i("span",[e._v("Error traffic")]),i("q-btn",{staticClass:"float-right",attrs:{color:"green",icon:"mdi-download-network-outline",label:"Open traffic viewer"},on:{click:e.onOKClick}}),i("q-btn",{staticClass:"float-right q-mr-xs",attrs:{color:"white",flat:"",label:"hex"===e.view?"View as text":"View as hex"},on:{click:e.changeMode}})],1),i("q-card-section",{staticClass:"q-pa-none scroll",staticStyle:{height:"calc(100% - 102px)"}},[e.hex?i("hex-viewer",{staticClass:"hex-error-viewer",attrs:{hex:e.hex,view:e.view,highlights:e.highlights}}):i("div",{staticClass:"text-white text-h3 text-center q-mt-lg"},[e._v("\n        There is no traffic or traffic has expired\n      ")])],1),i("q-card-actions",{staticClass:"bg-grey-8",attrs:{align:"right"}},[i("q-btn",{attrs:{flat:"",color:"white",label:"Cancel"},on:{click:e.onCancelClick}})],1)],1)],1)},a=[],o=i("d77f"),n=i("c423"),r={name:"TrafficErrorDialog",components:{HexViewer:o["a"]},props:{data:Array,error:{type:Object,default:()=>({})}},data(){const e=[];let t=this.data.reduce(((e,t)=>e+this.getHex(t)),"");if(this.error){const i=this.error;e.push({type:"error",start:i.field_start,end:i.field_boundary,text:i.text}),i.packet_start&&(t=t.slice(2*i.packet_start))}return{hex:t,view:"hex",highlights:e,errorText:this.error.text}},methods:{changeMode(){this.view="hex"===this.view?"text":"hex"},getHex(e){return n["a"].methods.base64ToHex(e)},show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onOKClick(){this.$emit("ok"),this.hide()},onCancelClick(){this.hide()}}},l=r,c=i("2877"),d=i("24e8"),h=i("f09f"),m=i("a370"),p=i("9c40"),u=i("4b7e"),g=i("eebe"),f=i.n(g),v=Object(c["a"])(l,s,a,!1,null,null,null);t["a"]=v.exports;f()(v,"components",{QDialog:d["a"],QCard:h["a"],QCardSection:m["a"],QBtn:p["a"],QCardActions:u["a"]})},9530:function(e,t,i){"use strict";i("39af")},"9df9":function(e,t,i){"use strict";i("b7d0")},a99a:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-toolbar",{staticClass:"justify-between bg-grey-9",staticStyle:{height:"50px"}},[i("q-resize-observer",{on:{resize:e.resizeHandler}}),e._t("selects"),e.item?i("div",[e.item.deleted||void 0===e.mode?e._e():i("q-btn",{staticClass:"on-right pull-right text-center rounded-borders q-px-xs q-py-none",staticStyle:{"min-width":"73px","max-width":"73px"},attrs:{flat:"",dense:"",color:"white"},on:{click:function(t){return e.$emit("change-mode",!e.mode)}}},[i("q-icon",{attrs:{size:"1.5rem",color:"white",name:e.mode?"playlist_play":"history"}}),i("div",{staticStyle:{"font-size":".7rem","line-height":".7rem"}},[e._v(e._s(e.mode?"Real-time":"History"))]),i("q-tooltip",[e._v("Mode (Real-time/History)")])],1),!e.item.deleted&&void 0!==e.ratio&&e.width>=900?i("q-btn-toggle",{staticClass:"q-ml-sm gt-xs",attrs:{dense:"",flat:"",color:"grey-4","toggle-color":"white","toggle-text-color":"white",size:"sm",value:e.ratio,options:[{label:"logs",value:100},{label:"both",value:50},{label:"messages",value:0}]},on:{input:function(t){return e.$emit("change-ratio",t)}}}):e._e()],1):e._e(),e.item&&e.$q.platform.is.desktop&&e.width>=900?i("div",{staticClass:"flex justify-end",style:{width:(e.actions&&e.actions.length?72*e.actions.length:"")+"px"}},[e._l(e.actions,(function(t,s){return[t.condition?i("transition",{key:s,attrs:{appear:"","enter-active-class":"animated bounceInDown","leave-active-class":"animated bounceOutUp"}},[i("q-btn",{staticClass:"on-left cursor-pointer pull-right text-center rounded-borders q-px-xs q-py-none text-white",staticStyle:{width:"60px"},attrs:{title:t.label,loading:t.async,flat:"",dense:""},on:{click:t.handler}},[i("div",{attrs:{slot:"loading"},slot:"loading"},[i("q-icon",{attrs:{size:"1.5rem",name:t.icon}}),i("div",{staticStyle:{"font-size":".7rem","line-height":".7rem"}},[e._v(e._s(t.label))]),t.tooltip?i("q-tooltip",[e._v(e._s(t.tooltip))]):e._e(),i("q-spinner",{staticClass:"absolute-bottom-right",attrs:{color:"white",size:".7rem"}})],1),i("q-icon",{attrs:{size:"1.5rem",name:t.icon}}),i("div",{staticStyle:{"font-size":".7rem","line-height":".7rem"}},[e._v(e._s(t.label))]),t.tooltip?i("q-tooltip",[e._v(e._s(t.tooltip))]):e._e()],1)],1):e._e()]}))],2):e.item&&(!e.$q.platform.is.desktop||e.width<900)?i("div",[e.hasActiveActions?i("q-btn",{attrs:{flat:"",icon:"mdi-dots-vertical",loading:e.hasAsync,color:"white",dense:""}},[i("template",{slot:"loading"},[i("q-icon",{attrs:{size:"1.5rem",name:"mdi-dots-vertical"}}),i("q-spinner",{staticClass:"absolute-bottom-right",attrs:{color:"white",size:".7rem"}})],1),i("q-menu",{attrs:{"no-route-dismiss":""}},[i("q-list",{staticClass:"bg-grey-7",attrs:{dark:""}},[e.item.deleted||void 0===e.ratio?e._e():i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}]},[i("q-btn-toggle",{attrs:{dense:"",dark:"",color:"grey-4","toggle-color":"grey-6","toggle-text-color":"white",size:"sm",flat:"",value:e.ratio,options:[{label:"logs",value:100},{label:"both",value:50},{label:"messages",value:0}]},on:{input:function(t){return e.$emit("change-ratio",t)}}})],1),e._l(e.actions,(function(t,s){return[t.condition?i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:s,attrs:{clickable:"",dense:""},on:{click:t.handler}},[i("q-item-section",{attrs:{side:""}},[i("q-icon",{attrs:{name:t.icon}})],1),i("q-item-section",[e._v(e._s(t.label))]),t.async?i("q-item-section",{attrs:{side:""}},[i("q-spinner",{attrs:{color:"white",size:"1rem"}})],1):e._e(),t.tooltip?i("q-tooltip",[e._v(e._s(t.tooltip))]):e._e()],1):e._e()]}))],2)],1)],2):e._e()],1):e._e()],2)},a=[],o={props:["item","ratio","mode","actions"],data(){return{width:0}},computed:{hasActiveActions(){return!this.item.deleted&&void 0!==this.ratio||this.actions&&this.actions.reduce(((e,t)=>e||t&&t.condition),!1)},hasAsync(){return!!this.actions.filter((e=>e.async)).length}},methods:{resizeHandler({width:e}){this.width=e}}},n=o,r=i("2877"),l=i("65c6"),c=i("3980"),d=i("9c40"),h=i("0016"),m=i("05c0"),p=i("6a67"),u=i("0d59"),g=i("4e73"),f=i("1c1c"),v=i("66e5"),b=i("4074"),y=i("7f67"),w=i("eebe"),x=i.n(w),_=Object(r["a"])(n,s,a,!1,null,null,null);t["a"]=_.exports;x()(_,"components",{QToolbar:l["a"],QResizeObserver:c["a"],QBtn:d["a"],QIcon:h["a"],QTooltip:m["a"],QBtnToggle:p["a"],QSpinner:u["a"],QMenu:g["a"],QList:f["a"],QItem:v["a"],QItemSection:b["a"]}),x()(_,"directives",{ClosePopup:y["a"]})},aa02:function(e,t,i){},aff9:function(e,t,i){"use strict";i("076c")},b11b:function(e,t,i){},b26d:function(e,t,i){},b57c:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{height:"100%"}},[i("q-item",{staticClass:"q-pa-none",staticStyle:{position:"sticky",top:"0px","z-index":"1"}},[i("q-item-section",{staticClass:"q-px-sm"},[i("q-input",{staticClass:"q-py-none bg-grey-8",attrs:{type:"text",color:"white",dark:"",label:"Search",outlined:"",dense:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),i("q-list",{attrs:{separator:"",dark:""}},[Object.keys(e.data).length&&Object.keys(e.filteredObject).length?e._e():i("q-item",[i("q-item-section",[i("q-item-label",{staticClass:"ellipsis text-bold text-center text-white",attrs:{header:""}},[e._v("No parameters")]),Object.keys(e.data).length?e._e():i("q-item-label",{staticClass:"ellipsis text-center text-white",attrs:{caption:""}},[e._v("Message has not fields")]),!Object.keys(e.filteredObject).length&&this.search?i("q-item-label",{staticClass:"ellipsis text-center text-white",attrs:{caption:""}},[e._v("Nothing found on your search")]):e._e()],1)],1),Object.keys(e.filteredObject).length?e._l(Object.keys(e.filteredObject),(function(t){return i("q-item",{key:t},[i("q-item-section",[i("q-item-label",{staticClass:"ellipsis text-bold q-pa-none text-white",attrs:{header:""}},[i("span",[e._v(e._s(t))]),e.meta[t]&&e.meta[t].unit?i("span",{staticClass:"object-viewier__units"},[e._v(", "+e._s(e.meta[t].unit))]):e._e(),i("q-tooltip",[i("span",[e._v(e._s(t))]),e.meta[t]&&e.meta[t].unit?i("span",[e._v(", "+e._s(e.meta[t].unit))]):e._e()])],1),e.filteredObject[t]&&e.filteredObject[t].toString().match(/^data:image\/(?:gif|png|jpeg|bmp|webp)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/)?i("q-item-label",{attrs:{caption:""}},[i("img",{staticClass:"image-bin",attrs:{src:e.filteredObject[t],alt:t}})]):-1===t.indexOf("image.bin.")?i("q-item-label",{staticClass:"ellipsis text-white",attrs:{caption:""}},[e._v(e._s(JSON.stringify(e.filteredObject[t]))),i("q-tooltip",[e._v(e._s(JSON.stringify(e.filteredObject[t])))])],1):0===t.indexOf("image.bin.")?i("q-item-label",{attrs:{caption:""}},[i("img",{staticClass:"image-bin",attrs:{src:"data:image/"+t.split(".")[2]+";base64, "+e.filteredObject[t].replace(/^data\:image\/\w*\;base64\,\s/,""),alt:t}})]):e._e()],1),i("q-item-section",{attrs:{side:""}},[e.meta[t]&&e.meta[t].display?i("q-btn",{attrs:{flat:"",dense:"",icon:"mdi-table-column-remove",color:"red-3"},on:{click:function(i){return e.action("col-remove",t)}}}):i("q-btn",{attrs:{flat:"",dense:"",icon:"mdi-table-column-plus-after",color:"green-3"},on:{click:function(i){return e.action("col-add",t)}}})],1)],1)})):e._e()],2)],1)},a=[];const o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});var n={props:["data","meta"],data(){return{search:""}},computed:{filteredObject(){return Object.keys(this.data).sort(o.compare).reduce(((e,t)=>(-1!==t.indexOf(this.search)&&(e[t]=this.data[t]),e)),{})}},methods:{action(e,t){this.$emit("action",{type:e,data:t})}}},r=n,l=(i("9530"),i("2877")),c=i("66e5"),d=i("4074"),h=i("27f9"),m=i("1c1c"),p=i("0170"),u=i("05c0"),g=i("9c40"),f=i("eebe"),v=i.n(f),b=Object(l["a"])(r,s,a,!1,null,null,null);t["a"]=b.exports;v()(b,"components",{QItem:c["a"],QItemSection:d["a"],QInput:h["a"],QList:m["a"],QItemLabel:p["a"],QTooltip:u["a"],QBtn:g["a"]})},b609:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-dialog",{ref:"dialog",attrs:{"full-width":"","full-height":"","no-route-dismiss":""},on:{hide:e.onDialogHide}},[i("q-card",{staticClass:"q-dialog-plugin bg-grey-9"},[i("q-card-section",{staticClass:"q-pa-none",staticStyle:{height:"calc(100% - 52px)"}},[i("expressions-test-viewer",{attrs:{theme:e.theme,columns:e.columns,token:e.token,data:e.data,expression:e.expression}})],1),i("q-card-actions",{attrs:{align:"right"}},[i("q-btn",{attrs:{flat:"",dark:"",color:"white",label:"Close"},on:{click:e.onCancelClick}})],1)],1)],1)},a=[],o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("iframe",{ref:"iframe",staticStyle:{width:"100%",height:"100%"},attrs:{id:e.postkey,name:e.postkey,src:e.link,frameborder:"0"}})},n=[],r=(i("e9c4"),{name:"ExpressionsTestViewer",props:{theme:{type:String,default(){return"dark"}},token:{type:String,required:!0},data:{type:Array,required:!0},columns:{type:Array},expression:{type:String}},data(){return{postkey:"expression-test",path:`${this.$authHost}/exprtool/#/expr`,eventsHandlers:{ready:this.ready}}},computed:{link(){return`${this.path}?theme=${this.theme}&token=${this.token}`}},methods:{setData(){const e=`FlespiTools|${this.postkey}|ExpressionsSetData=>${JSON.stringify(this.data)}`;this.$refs.iframe.contentWindow.postMessage(e,"*")},setCols(){const e=`FlespiTools|${this.postkey}|ExpressionsSetColumns=>${JSON.stringify(this.columns)}`;this.$refs.iframe.contentWindow.postMessage(e,"*")},setExpression(){const e=`FlespiTools|${this.postkey}|ExpressionsSetExpression=>${this.expression}`;this.$refs.iframe.contentWindow.postMessage(e,"*")},ready(){this.columns&&this.setCols(),this.data&&this.setData(),this.expression&&this.setExpression()},eventHandle(e){let t,i;if("string"===typeof e.data&&0===e.data.indexOf("FlespiTools|")){let a=e.data.split("|");if(this.postkey&&this.postkey===a[1]){a=a[2].split("=>"),t=a[0];try{i=JSON.parse(a[1])}catch(s){i=a[1]}t&&this.eventsHandlers[t](i)}}}},mounted(){window.addEventListener("message",this.eventHandle)},watch:{data(){this.setData()},expression(){this.setExpression()},columns(){this.setCols()}}}),l=r,c=i("2877"),d=Object(c["a"])(l,o,n,!1,null,null,null),h=d.exports,m={props:{theme:{type:String,default(){return"dark"}},token:{type:String,required:!0},data:{type:Array,required:!0},columns:{type:Array},expression:{type:String}},components:{ExpressionsTestViewer:h},methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onOKClick(){this.$emit("ok"),this.hide()},onCancelClick(){this.hide()}}},p=m,u=i("24e8"),g=i("f09f"),f=i("a370"),v=i("4b7e"),b=i("9c40"),y=i("eebe"),w=i.n(y),x=Object(c["a"])(p,s,a,!1,null,null,null),_=x.exports;w()(x,"components",{QDialog:u["a"],QCard:g["a"],QCardSection:f["a"],QCardActions:v["a"],QBtn:b["a"]});t["a"]={methods:{showExprTest(e,t,i){const s=t.reduce(((e,t)=>(t.__dest||e.push(t.name),e)),[]);this.$q.dialog({component:_,parent:this,data:i,columns:s,token:e,noRouteDismiss:!0})}}}},b7d0:function(e,t,i){},bed7:function(e,t,i){},c423:function(e,t,i){"use strict";i("ddb0"),i("b7ef");t["a"]={methods:{base64ToHex(e){return"string"!==typeof e?"":[...atob(e)].map((e=>e.charCodeAt(0).toString(16).padStart(2,0))).join("").toUpperCase()},base64ToText(e){return"string"!==typeof e?"":atob(e)},base64ToTextWithMnemoReplacing(e){if("string"!==typeof e)return"";const t=this.base64ToHex(e),i=t.match(/.{1,2}/g);return i.map((e=>this.replaceByteWithMnemo(e))).join("")},isEmptySymbol(e){const t=parseInt(e,16);return t<32||t>=127},replaceByteWithDot(e){const t=parseInt(e,16),i=String.fromCharCode(t);return t<32||t>=127?".":i},replaceByteWithMnemo(e){const t=parseInt(e,16),i=String.fromCharCode(t);let s;return s=t<32||t>=127||i.match(/\s/g)&&" "!==i?"\r"===i?"\\r":"\t"===i?"\\t":"\n"===i?"\\n":`\\x${e}`:i,s}}}},c853:function(e,t,i){"use strict";t["a"]={data(){return{activeConnectionId:null}},methods:{highlightConn(e){if(e===this.activeConnectionId)return;this.activeConnectionId=e;const t=document.head||document.getElementsByTagName("head")[0];if(e){const i=document.createElement("style");i.type="text/css";const s=`.traffic-viewer__item--connection-${e} { background-color: #546e7a!important; }`;i.styleSheet?i.styleSheet.cssText=s:i.innerText=s,t.appendChild(i),this.highlightClass=i}else t.removeChild(this.highlightClass)}}}},c9ad:function(e,t,i){"use strict";i("ddb0");var s=i("5a3a"),a=i.n(s);t["a"]={data(){return{selectionMode:!1}},methods:{enableSelectionMode(e){(e.shiftKey||e.ctrlKey||e.metaKey)&&(this.selectionMode=!0)},disableSelectionMode(e){e.shiftKey||e.ctrlKey||e.metaKey||(this.selectionMode=!1)},multiselectProcess({selected:e,index:t,event:i={}}){return e=[...e],i.shiftKey?e=e[0]?e[0]>t?a()(t,e[0]+1):a()(e[0],t+1):[t]:i.ctrlKey||i.metaKey?e.includes(t)?e.splice(e.indexOf(t),1):e=[...e,t]:e=[t],e}},created(){window.addEventListener("keydown",this.enableSelectionMode),window.addEventListener("keyup",this.disableSelectionMode)},beforeDestroy(){window.removeEventListener("keydown",this.enableSelectionMode),window.removeEventListener("keyup",this.disableSelectionMode)}}},cc73:function(e,t,i){"use strict";i("bed7")},ce46:function(e,t,i){},d77f:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"wrapper",on:{click:e.clearSelectedHandler}},[i("q-menu",{attrs:{"context-menu":"","no-route-dismiss":""}},[i("q-list",{staticClass:"bg-grey-8 text-white",staticStyle:{"min-width":"100px"}},[i("div",{staticClass:"q-pa-sm"},[i("div",{staticStyle:{"font-size":".8rem"}},[e._v("Copy as")]),i("div",[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",label:"shown"},on:{click:function(t){e.copy(e.getContent("view",e.hex,e.view,e.selected),"view")}}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",label:"hex"},on:{click:function(t){e.copy(e.getContent("hex",e.hex,e.view,e.selected),"hex")}}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",label:"raw"},on:{click:function(t){e.copy(e.getContent("text",e.hex,e.view,e.selected),"text")}}})],1)]),i("q-separator"),i("div",{staticClass:"q-pa-sm"},[i("div",{staticStyle:{"font-size":".8rem"}},[e._v("Export as")]),i("div",[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",label:"shown"},on:{click:function(t){e.exportData(e.getContent("view",e.hex,e.view,e.selected),"view")}}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",label:"hex"},on:{click:function(t){e.exportData(e.getContent("hex",e.hex,e.view,e.selected),"hex")}}}),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",label:"raw"},on:{click:function(t){e.exportData(e.getContent("text",e.hex,e.view,e.selected),"text")}}})],1)])],1)],1),e.hex?i("div",{staticClass:"text-white hex-viewer",style:{wordBreak:"text"===e.view?"break-all":""},on:{click:e.selectAllHandler,mouseover:e.wrapperMouseOverHandler}},[e.highlightIndex>-1?i("q-menu",{attrs:{target:".highlighted.byte-"+e.highlightIndex,value:!0,"no-parent-event":"","no-route-dismiss":""}},[i("div",{staticClass:"bg-grey-8 q-pa-xs text-caption"},e._l(e.highlightTexts,(function(t){return i("pre",{key:t.text,staticClass:"q-ma-none text-white text-pre"},[e._v(e._s(t.text))])})),0)]):e._e(),"hex"===e.view?[i("div",{staticClass:"hex-viewer__addresses"},e._l(e.addresses,(function(t){return i("div",{key:t},[e._v(e._s(t.toString(16).padStart(7,0).toUpperCase()))])})),0),i("div",{staticClass:"hex-viewer__value",on:{mouseleave:e.mouseLeaveHandler}},e._l(e.bytesArray,(function(t,s){return i("div",{key:s+t},e._l(t,(function(t,a){return i("span",{key:""+s+a+t,staticClass:"q-pr-xs q-pl-xs q-mt-sm q-mb-sm",class:e.getClassesByByteIndex(16*s+a),on:{mouseover:function(t){return e.setActiveHandler(s,a)},mousedown:function(t){return e.startSelectionHandler(t,s,a)},mouseup:function(t){return e.endSelectionHandler(t,s,a)}}},[e._v(e._s(t))])})),0)})),0),i("div",{staticClass:"hex-viewer__text",on:{mouseleave:e.mouseLeaveHandler}},e._l(e.bytesArray,(function(t,s){return i("div",{key:s+t},e._l(t,(function(t,a){return i("span",{key:""+s+a+t,staticClass:"q-pr-xs q-pl-xs q-mt-sm q-mb-sm hex-char",class:e.getClassesByByteIndex(16*s+a),on:{mouseover:function(t){return e.setActiveHandler(s,a)},mousedown:function(t){return e.startSelectionHandler(t,s,a)},mouseup:function(t){return e.endSelectionHandler(t,s,a)}}},[e._v(e._s(e.replaceByteWithDot(t)))])})),0)})),0)]:"text"===e.view?e._l(e.bytesArray,(function(t,s){return i("span",{key:""+s+t,staticClass:"q-mt-sm q-mb-sm text-char",class:Object.assign({},e.getClassesByByteIndex(s),{"raw-hex-data":e.isEmptySymbol(t)}),on:{mouseover:function(t){return e.setActiveHandler(null,s)},mousedown:function(t){return e.startSelectionHandler(t,null,s)},mouseup:function(t){return e.endSelectionHandler(t,null,s)}}},[e._v(e._s(e.replaceByteWithMnemo(t))),"0A"===t?i("br"):e._e()])})):e._e()],2):i("div",{staticStyle:{"text-align":"center",color:"#9e9e9e","font-size":"3rem","padding-top":"40px"}},[e._v("No HEX data")])],1)},a=[],o=i("9b02"),n=i.n(o),r=i("798f"),l={name:"HexViewer",props:{hex:String,view:String,highlights:{type:Array,default:()=>[]}},data(){const e=n()(this.highlights[0],"start",-1);return{hovered:-1,start:-1,end:-1,selectionMode:!1,timer:0,clicks:0,highlightIndex:e}},computed:{bytesArray(){return this.getBytesArray(this.hex,this.view)},addresses(){return this.getAddresses(this.hex)},selected(){return this.getSelected(this.start,this.end)},highlighted(){return this.highlights.reduce(((e,t)=>{const i=this.getSelected(t.start,t.end),s=e[t.type];return i.forEach((e=>{s[e]||(s[e]=[]),s[e].push(t.text)})),e}),{error:{},warning:{},basic:{}})},highlightTexts(){const e=[];if(this.highlights.length){const t=this.highlightIndex,i=["error","warning","basic"];i.forEach((i=>{this.highlighted[i][t]&&this.highlighted[i][t].forEach((t=>{e.push({text:t,type:i})}))}))}return e}},watch:{hex(){this.start=-1,this.end=-1}},mixins:[r["a"]],methods:{getClassesByByteIndex(e){const t={"selected--basic":this.selected.includes(e),highlighted:this.highlighted.error[e]||this.highlighted.warning[e],"selected--error":this.highlighted.error[e],"selected--hovered":this.hovered===e||this.start===this.end===e,[`byte-${e}`]:!0};return t},clearSelectedHandler(e){e.target.isEqualNode(this.$refs.wrapper)&&!this.selectionMode&&(this.start=-1,this.end=-1),this.selectionMode&&(this.selectionMode=!1)},startSelectionHandler(e,t,i){if(3===e.which)return!1;-1!==this.end&&(this.end=-1),this.selectionMode=!0,this.start=t?16*t+i:i},endSelectionHandler(e,t,i){if(3===e.which)return!1;this.end=t?16*t+i:i,this.selectionMode=!1},setActiveHandler(e,t){this.selectionMode?this.end=e?16*e+t:t:(this.hovered=e?16*e+t:t,this.setHighlightIndex(this.hovered))},setHighlightIndex(e){this.highlighted.error[e]||this.highlighted.warning[e]||this.highlighted.basic[e]?this.highlightIndex=e:this.highlightIndex=-1},selectAllHandler(){this.clicks++,1===this.clicks?this.timer=setTimeout((()=>{this.clicks=0}),700):(clearTimeout(this.timer),this.clicks=0,this.start=0,this.end=this.hex.match(/.{1,2}/g).length-1)},mouseLeaveHandler(){this.hovered=-1,this.highlightIndex=-1,this.selectionMode&&this.$q.platform.is.desktop&&(this.end=this.hex.match(/.{1,2}/g).length-1)},scrollingTo(e){if(this.scrollingId)return!1;this.scrollingId=setInterval((()=>{this.selectionMode||this.clearSCrolling(),"top"===e?this.$refs.wrapper.scrollTop-=5:"bottom"===e&&(this.$refs.wrapper.scrollTop+=5)}),100)},clearSCrolling(){clearInterval(this.scrollingId),this.scrollingId=void 0},wrapperMouseOverHandler(e){if(this.selectionMode){const t=this.$refs.wrapper.offsetHeight,i=t/20,s=t-i,a=e.layerY;a<i?this.scrollingTo("top"):a>s?this.scrollingTo("bottom"):this.clearSCrolling()}}}},c=l,d=(i("79d6"),i("2877")),h=i("4e73"),m=i("1c1c"),p=i("9c40"),u=i("eb85"),g=i("7f67"),f=i("eebe"),v=i.n(f),b=Object(d["a"])(c,s,a,!1,null,null,null);t["a"]=b.exports;v()(b,"components",{QMenu:h["a"],QList:m["a"],QBtn:p["a"],QSeparator:u["a"]}),v()(b,"directives",{ClosePopup:g["a"]})},df1d:function(e,t,i){"use strict";var s=i("9b02"),a=i.n(s);t["a"]={data(){return{widgetsHandleActions:[{name:"prev",label:"Previous message",icon:"mdi-arrow-left-thick"},{name:"next",label:"Next message",icon:"mdi-arrow-right-thick"}],activeWidgetWindow:void 0}},computed:{widgetStyle(){const e={},t=this.widgetsViewModel;for(const i in t){const s=t[i]||{};s.to&&(e[s.to]=i)}return e},widgetWindowControls(){return{minimizeRight:!this.widgetStyle.right,minimizeLeft:!this.widgetStyle.left}},widgetsViewModel(){return a()(this.settings.viewSettings,`${this.entityName}.widgetView`,{})}},methods:{widgetsChangeViewModelHandler(e,t,i){this.$emit("update:settings",{type:"ENTITY_VIEW_SETTINGS_CHANGE",opt:{entity:e},value:{widgetView:{...this.widgetsViewModel,[t]:i}}})},activateWidgetWindow(e){this.activeWidgetWindow=e},ratioWidgetsModify(e){const t=100===e,i=0===e;t?(this.isWidgetsMessageActive=!1,this.isWidgetsTrackActive=!1):i&&(this.isWidgetsLogsActive=!1)}}}},e613:function(e,t,i){},e812:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-item",{class:[e.selected?"bg-grey-8":"","traffic-viewer__item--connection-"+e.item.conn],staticStyle:{"user-select":"none"},attrs:{clickable:""},on:{click:function(t){e.itemClickHandler(e.index,e.item,t)}}},[i("q-tooltip",[e._v(e._s(e.eventsDesc[e.item.type]))]),e.actions?i("q-item-section",{staticClass:"q-pr-none",attrs:{side:""}},e._l(e.actions,(function(t,s){return i("q-icon",{key:s,staticClass:"cursor-pointer on-left",class:t.classes,attrs:{name:t.icon,color:e.selected?"grey-5":""},nativeOn:{click:function(i){return i.stopPropagation(),e.clickHandler(e.index,t.type,e.item)}}},[i("q-tooltip",[e._v(e._s(t.label))])],1)})),1):e._e(),i("q-item-section",[i("q-item-label",{staticClass:"ellipsis overflow-hidden q-pa-none",class:["text-"+e.eventsColors[e.item.type]+"-"+(e.selected?3:4)],attrs:{header:""}},[e._v(e._s(e.date.formatDate(1e3*e.item.timestamp,"DD/MM/YYYY HH:mm:ss.SSS")))]),e.size?i("q-item-label",{staticClass:"ellipsis overflow-hidden text-grey-5",attrs:{caption:""}},[e._v(e._s(e.size+" B : ")),i("small",[e._v(e._s(e.dataPreview))])]):e._e()],1),i("q-item-section",{attrs:{side:""}},[i("small",{class:["text-grey-"+(e.selected?5:7)]},[e._v(e._s(e.eventsDesc[e.item.type]))]),i("div",[i("small",{staticClass:"rounded-borders q-px-xs text-white bg-amber-8"},[e._v("\n        "+e._s(e.item.conn.toString().slice(0,2))+"\n        "),i("q-tooltip",[e._v(e._s(e.item.conn))])],1),i("small",{staticClass:"rounded-borders q-mx-xs q-px-xs text-white",class:{"bg-blue":"tcp"===e.transport,"bg-pink-4":"udp"===e.transport,"bg-green-9":"http"===e.transport,"bg-purple-9":"mqtt"===e.transport}},[e._v(e._s(e.transport))]),i("q-icon",{staticClass:"q-ml-xs",attrs:{size:"1.2rem",color:e.eventsColors[e.item.type],name:e.eventIcons[e.item.type]}})],1)])],1)},a=[],o=i("bd4c"),n=i("c423"),r={props:["item","index","actions","itemHeight","selected","view"],data(){const e={2:"tcp",66:"http",67:"http",130:"udp",3:"tcp",131:"udp",32:"mqtt",33:"mqtt",34:"mqtt",35:"mqtt"};return{date:o["a"],transport:e[this.item.type],hex:this.base64ToHex(this.item.data),eventsColors:{0:"green",32:"green",1:"red",33:"red",2:"purple",130:"purple",66:"purple",34:"purple",3:"yellow",67:"yellow",131:"yellow",35:"yellow"},eventsDesc:{0:"Connect",32:"Connect",1:"Disconnect",33:"Disconnect",2:"Data received",130:"Data received",66:"Data received",34:"Data received",3:"Data sent",67:"Data sent",131:"Data sent",35:"Data sent"},eventIcons:{0:"mdi-lan-connect",32:"mdi-lan-connect",1:"mdi-lan-disconnect",33:"mdi-lan-disconnect",2:"mdi-arrow-right-thick",130:"mdi-arrow-right-thick",66:"mdi-arrow-right-thick",34:"mdi-arrow-right-thick",3:"mdi-arrow-left-thick",67:"mdi-arrow-left-thick",35:"mdi-arrow-left-thick",131:"mdi-arrow-left-thick"}}},computed:{dataPreview(){if(!this.item.data)return"";let e=this.hex;if("text"===this.view){const t=e.match(/.{1,2}/g);e=t.map((e=>this.replaceByteWithMnemo(e))).join("")}return e},size(){return this.item.data?Math.floor(this.hex.length/2):null}},methods:{clickHandler(e,t,i){const s={...i};s.data=this.dataPreview,this.$emit("action",{index:e,type:t,content:s})},itemClickHandler(e,t,i){this.$emit("item-click",{index:e,content:t,event:i})}},mixins:[n["a"]]},l=r,c=i("2877"),d=i("66e5"),h=i("05c0"),m=i("4074"),p=i("0016"),u=i("0170"),g=i("eebe"),f=i.n(g),v=Object(c["a"])(l,s,a,!1,null,null,null);t["a"]=v.exports;f()(v,"components",{QItem:d["a"],QTooltip:h["a"],QItemSection:m["a"],QIcon:p["a"],QItemLabel:u["a"]})},ee59:function(e,t,i){"use strict";i("b11b")},ff12:function(e,t,i){}}]);